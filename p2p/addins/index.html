<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="David Betteridge">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Addins - Technical Documentation</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">Technical Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../..">PROACTIS</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">P2P <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Configuration</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../applicationConfigurationSettings/">Application Configuration</a>
</li>
            
<li >
    <a href="../help/">On Line Help</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../sso/">Single Sign On (SSO)</a>
</li>
                            
<li >
    <a href="../punchout/">PunchOut / Marketplaces</a>
</li>
                            
<li >
    <a href="../nominalvalidation/">Nominal Validation</a>
</li>
                            
<li >
    <a href="../budgetchecking/">Budget Checking</a>
</li>
                            
<li >
    <a href="../customtab/">Custom Tabs</a>
</li>
                            
<li class="active">
    <a href="./">Addins</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Imaging Integration</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../genericimaging/">Generic Imaging</a>
</li>
            
<li >
    <a href="../customimaging/">Custom Imaging</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../commitments/">Commitment Posting</a>
</li>
                            
<li >
    <a href="../invoicePosting/">Invoice Posting</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Import APIs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../acceptanceGateway/">Acceptances</a>
</li>
            
<li >
    <a href="../cancelPurhaseOrderGateway/">Cancel Purchase Order</a>
</li>
            
<li >
    <a href="../expensesGateway/">Expenses</a>
</li>
            
<li >
    <a href="../internalInvoiceGateway/">Internal Invoices</a>
</li>
            
<li >
    <a href="../purchaseCreditNoteGateway/">Purchase Credit Notes</a>
</li>
            
<li >
    <a href="../purchaseInvoiceGateway/">Purchase Invoices</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../troubleshooting/">Troubleshooting</a>
</li>
                        </ul>
                    </li>
                    <li >
                        <a href="../../placeholder/">Spend Analytics</a>
                    </li>
                    <li >
                        <a href="../../placeholder/">APF</a>
                    </li>
                    <li >
                        <a href="../../placeholder/">S2C</a>
                    </li>
                    <li >
                        <a href="../../placeholder/">DueNorth</a>
                    </li>
                    <li >
                        <a href="../../placeholder/">System4</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../customtab/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../genericimaging/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/proactis-documentation/ExampleApplications">CodeExamples
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#add-ins">Add-ins</a></li>
        <li class="main "><a href="#setup">Setup</a></li>
        <li class="main "><a href="#css">CSS</a></li>
        <li class="main "><a href="#javascript">Javascript</a></li>
            <li><a href="#includes">Includes</a></li>
            <li><a href="#addinclient">addInClient</a></li>
            <li><a href="#xmlservices">XMLServices</a></li>
        <li class="main "><a href="#sample-add-in">Sample Add-In</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="add-ins">Add-ins</h1>
<p>P2P supports the concept of 'Add-ins' which are additional custom links which can be added to any page within the core website.</p>
<hr />
<h1 id="setup">Setup</h1>
<ol>
<li>
<p>Ensure that a sub-folder called <strong>Addins</strong> exists within the Customer virtual directory in the root of the web site. </p>
</li>
<li>
<p>If the folder doesn't already contain a file called <strong>Addins.xml</strong> then create the following file.  If the file does already exist then add your new page to it.</p>
</li>
</ol>
<pre><code class="xml">&lt;AddIns&gt;
    &lt;Page Name=&quot;Purchasing/Orders/Plus/MultiLineEntry.asp&quot;&gt;
        &lt;Link AddInURL=&quot;SampleOrderAddIn.aspx&quot; WindowWidth=&quot;900&quot; WindowHeight=&quot;600&quot; WindowName=&quot;OrderTaxReset&quot;&gt;Sample Order AddIn&lt;/Link&gt;
    &lt;/Page&gt;
&lt;/AddIns&gt;
</code></pre>

<p>In the example above,  a link captioned <strong>Sample Order Addin</strong> will be added to the <strong>MultiLineEntry.asp</strong> page.  When this link is clicked a new window will open (900x600) which will display the URL <strong>SampleOrderAddIn.aspx</strong></p>
<ol>
<li>
<p>In the same folder create your add-in page.   (<em>For example SampleOrderAddIn.aspx</em>)</p>
</li>
<li>
<p>If you wish your add-in to interact with the main site,  then please read the following <em>Javascript</em> section.</p>
</li>
</ol>
<hr />
<h1 id="css">CSS</h1>
<p>In order to pick up some of the styling from the main site (such as the default font-family and font size for the page) the <strong>CustomSupport/Site.css</strong> style-sheet should be referenced.</p>
<pre><code class="html">&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;../../CustomSupport/Site.css&quot; /&gt;
</code></pre>

<hr />
<h1 id="javascript">Javascript</h1>
<p>An add-in page can communicate with the parent P2P application via javaScript calls exposed by the addInClient library.</p>
<h2 id="includes">Includes</h2>
<p>The main web site has a <strong>CustomSupport</strong> folder that contains the files that need to be included (some optionally) in each add-in page.</p>
<p><strong>AddInClient.js</strong>:  mandatory for communication between the add-in page and the owning main P2P page in the client’s browser (which can in turn communicate with the server)</p>
<p><strong>jquery-xxx.im.js</strong>: mandatory  </p>
<p><strong>jquery.filerNode.js</strong>: mandatory if you wish to use the xml services exposed by the AddInClient class, for manipulating order/invoice xml. Otherwise can be left out. </p>
<p><strong>kendo.xxx.min.js</strong>, Notifications.inc, Site.css: mandatory if you wish to use the same notification services and styling as the main web site for info, alert and error messages. Otherwise can be left out. </p>
<pre><code class="html">    &lt;script src=&quot;../../CustomSupport/jquery-2.2.4.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;../../CustomSupport/jquery.filerNode.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;../../CustomSupport/AddInClient.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;../../CustomSupport/kendo.core.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;../../CustomSupport/kendo.notification.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;../../CustomSupport/kendo.popup.min.js&quot;&gt;&lt;/script&gt;
</code></pre>

<hr />
<h2 id="addinclient"><strong>addInClient</strong></h2>
<p>A core deliverable for any javaScript add-in solution, is the recognition that any single add-in page may need to make numerous AJAX calls in order to retrieve all the data it requires in order to function. Since those AJAX calls are asynchronous, the challenge is how to co-ordinate and handle their callbacks.</p>
<p>The addInClient javaScript class solves the callback challenge. Through the use of jQuery Deferred/Promise functionality, it can accept any number of AJAX calls as input, will manage their respective callbacks, combine the data retrieved and make that data available to the caller. </p>
<p>The <strong>addInClient</strong> class exposes the following AJAX methods. Understand that these calls are asynchronous. The return values described below are not returned directly but rather indirectly via the <strong>MonitorAjaxCalls</strong> method. The methods below directly return a jQuery Promise object. 
 </p>
<h3 id="getsessionid">GetSessionID()</h3>
<ul>
<li>Returns the current session-id.</li>
</ul>
<h3 id="getsessionparmkeyname">GetSessionParm(keyName)</h3>
<ul>
<li>Returns the session value (as a string) stored against the specified key-name. </li>
<li>Returns null if the session value is not present.</li>
</ul>
<h3 id="getsessionparmskeynames">GetSessionParms(keyNames)</h3>
<p>Accepts an array of key-names and returns the corresponding session values (or null values if the session value does not exist) Return value is a JSON array of key/value pairs First entry in return array is always the session-id. </p>
<h3 id="getorderinedit">GetOrderInEdit()</h3>
<ul>
<li>Returns the full order xml (including all lines) for the order currently in edit in the current session. </li>
<li>Returns an error if no order is currently in edit.</li>
</ul>
<h3 id="getorderineditwithoutlines">GetOrderInEditWithoutLines()</h3>
<ul>
<li>Returns the order xml with an empty LineSet xml node (i.e. order header and footer only). </li>
<li>Returns an error if no order is currently in edit </li>
</ul>
<h3 id="getinvoiceinedit">GetInvoiceInEdit()</h3>
<ul>
<li>Returns the full invoice xml (including all lines) for the invoice currently in edit in the current session. </li>
</ul>
<h3 id="getinvoiceineditheader">GetInvoiceInEditHeader()</h3>
<ul>
<li>Returns the invoice header xml for the invoice currently in edit in the current session. </li>
</ul>
<h3 id="getinvoiceineditfooter">GetInvoiceInEditFooter()</h3>
<ul>
<li>Returns the invoice footer xml for the invoice currently in edit in the current session. </li>
</ul>
<h3 id="monitorajaxcallsajaxcalls">MonitorAjaxCalls(ajaxCalls)</h3>
<ul>
<li>Accepts an array of any combination of the above AJAX “Get…” methods. Since each of the above “Get…” methods actually returns a jQuery Promise object, the input to this method is actually an array of those Promise objects to be monitored.  </li>
<li>Returns a single jQuery Promise object to which resolve/fail events can be attached </li>
<li>If all input “Get…” methods succeed then  <ul>
<li>All “resolve” events attached to the returned Promise, are triggered (in the order in which they were attached) </li>
<li>Each “resolve” event is passed the following parameters </li>
<li><strong>Results</strong>: an array of return values, matching the AJAX calls that were input. The array entries will be simple strings, JSON key/value arrays or xml strings, as per the return types from the above “Get…” methods.  </li>
<li><strong>AlertMessages</strong>: an array of all alert messages output by the AJAX “Get…” messages</li>
<li><strong>InfoMessages</strong>: an array of all info messages output by the AJAX “Get…” messages</li>
</ul>
</li>
<li>If any of input AJAX “Get…” methods fail then <ul>
<li>All “fail” events attached to the returned Promise, are triggered (in the order in which they were attached) </li>
<li>Each “fail” event is passed an array of error messages. </li>
<li>Even if some of the input AJAX “Get…” events succeed, no “resolve” events are triggered. </li>
</ul>
</li>
</ul>
<h3 id="handleerrorerrormessages">HandleError(errorMessages)</h3>
<p>Will test for the presence of notification services and output formal error notifications if possible. Otherwise will issue alerts for each error message. </p>
<hr />
<h2 id="xmlservices">XMLServices</h2>
<p>Exposes a set of helper methods for working with document xml (i.e. xml with the “grs” namespace). The following methods are available </p>
<h3 id="loaddomxml">loadDOM(xml)</h3>
<ul>
<li>Accepts an xml string and returns a jQuery DOM object </li>
</ul>
<h3 id="getnodeparentnode-nodename">getNode(parentNode, nodeName)</h3>
<ul>
<li>Accepts a parent node (or the DOM) and the name of an immediate child element. </li>
<li>Returns the child element </li>
<li>nodeName can be an array of element names. Where each name corresponds to an element that is a child of the previous name (element).  </li>
</ul>
<h3 id="attrnode-attributename">attr(node, attributeName)</h3>
<ul>
<li>Returns the given attribute of the given element. </li>
</ul>
<h3 id="getnodeattrparentnode-nodename-attributename">getNodeAttr(parentNode, nodeName, attributeName)</h3>
<ul>
<li>Finds the specified immediate child element of the parent node and returns the specified attribute value. </li>
</ul>
<h3 id="filternodeattrparentnode-nodename-attributename-attributename">filterNodeAttr(parentNode, nodeName, attributeName, attributeName)</h3>
<ul>
<li>Finds the specified immediate child element of the parent node, which also has an attribute with the specified name and value. </li>
<li>Returns the text value of that child element. 
 </li>
</ul>
<hr />
<h1 id="sample-add-in">Sample Add-In</h1>
<p>There is a sample add-in and xml file available <a href="https://github.com/proactis-documentation/ExampleApplications/tree/master/P2P/Addins">here</a>.</p>
<p>The sample is available from the multi-line orders page and shows how order information can be retrieved and displayed. </p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>(C) PROACTIS Group Ltd - All Rights Reserved</p>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

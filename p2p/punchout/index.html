<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="David Betteridge">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Punchout - Technical Documentation</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">Technical Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../..">PROACTIS</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">P2P <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../Placeholder/">Overview</a>
</li>
                            
<li >
    <a href="../sso/">Single Sign On (SSO)</a>
</li>
                            
<li class="active">
    <a href="./">Punchout</a>
</li>
                            
<li >
    <a href="../../placeholder/">Invoice Posting</a>
</li>
                            
<li >
    <a href="../../placeholder/">Budget Checking</a>
</li>
                            
<li >
    <a href="../../placeholder/">Nominal Validation</a>
</li>
                            
<li >
    <a href="../../placeholder/">Imaging Integration</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Import APIs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../placeholder/">Invoices</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li >
                        <a href="../../placeholder/">Spend Analytics</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">APF <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../apf/overview/">overview</a>
</li>
                            
<li >
    <a href="../../apf/overview/">p2p to apf</a>
</li>
                            
<li >
    <a href="../../apf/financesystem_to_paymentserver/">Finance System to Payments Server</a>
</li>
                        </ul>
                    </li>
                    <li >
                        <a href="../../s2c/placeholder/">S2C</a>
                    </li>
                    <li >
                        <a href="../../dueNorth/Placeholder/">DueNorth</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../sso/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../placeholder/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/proactis-documentation/ExampleApplications">CodeExamples
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#punch-out-and-marketplaces-in-proactis">Punch-out and Marketplaces in PROACTIS</a></li>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#punch-out">Punch-out</a></li>
            <li><a href="#punch-out-customisations">Punch-out customisations</a></li>
            <li><a href="#market-place">Market Place</a></li>
        <li class="main "><a href="#egs-marketplaces">EGS Marketplaces</a></li>
        <li class="main "><a href="#proxy-server">Proxy Server</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="punch-out-and-marketplaces-in-proactis">Punch-out and Marketplaces in PROACTIS</h1>
<h2 id="overview">Overview</h2>
<p>This document details the changes needed to configure connections to supplier punch-out sites and marketplaces in the new release of PROACTIS P2P.
Unlike the previous versions it is now possible to configure the connections directly within the product.  Previously the setup action was carried out by a technical consultant which required the coding of bespoke webpages and sometimes DLLs for installation on the P2P server.</p>
<h2 id="punch-out">Punch-out</h2>
<p>Punch-out allows a user to jump from the PROACTIS website into a supplier’s shopping site.  Where they can browse a catalogue and add items to a shopping basket as per a normal ecommerce site.  Once they have finished browsing they click checkout and the items are then returned to PROACTIS as new lines on their current purchase order (or requisition).
For the purposes of this document, the term punch-out does not include the ability to electronically export purchase orders to suppliers in cXML format.</p>
<p>There are three methods of configuring punch-out:
1.  Punch-thro. <br />
The buyer punches out to the supplier site via the PROACTIS s2c portal.  The details of the supplier site are configured within the s2c portal rather than within p2p.  This continues to work the same as on previous releases.</p>
<ol>
<li>Standard cxml punch-out 
The majority of punch-outs follow the cXML standard.  This is can now be configured directly within the product without the need to create additional bespoke pages.
Against each supplier; punch-out can be configured by completing the following fields.</li>
</ol>
<p>The values for these 5 fields should be agreed with the supplier.  DUNs numbers are often used for the three identities.
The fields can also be edited using the new WebPMC.</p>
<ol>
<li>Standard OCI punch-out
Less commonly used in the UK, but PROACTIS also supports the OCI punch-out standard.  Again this can be configured directly within the product by completing the following three fields.</li>
</ol>
<h2 id="punch-out-customisations">Punch-out customisations</h2>
<p>It is possible to customise punch-out at various points within the process:</p>
<p>The format of the cXML sent in the initial connection to the supplier’s site. (cXML only)</p>
<p>By default PROACTIS uses an XSLT embedded within the product for generating the xml which is sent to the supplier.  It is possible to use your own xslt by creating a file within the plugins folder called PunchoutConnection_{supplierCode}.xslt.  Where {supplierCode} is the code of your supplier.
The fields which are available to the XSLT are listed below.
-   Context
-   SessionID
-   SupplierCode
-   DepartmentCode
-   CompanyCode
-   TemplateLabel
-   LogonName
-   ActualName
-   FirstName
-   Surname
-   Email
-   ReturnURL
-   URL
-   BuyerCookie
-   PayloadID
-   Timestamp
-   PunchoutFromIdentity
-   PunchoutToIdentity
-   PunchoutSenderIdentity
-   PunchoutSenderSharedSecret
-   DeliveryAddressGUID
-   DeliveryAddressName
-   DeliveryAddressLine1
-   DeliveryAddressLine2
-   DeliveryAddressLine3
-   DeliveryAddressLine4
-   DeliveryCountry
-   DeliveryCounty
-   DeliveryPostcode
-   DeliveryPostTown
 </p>
<p>The processing of the basket returned from the supplier’s site (cxml and oci)
When the basket is returned from the supplier by default it is transformed into the correct P2P format by using an XSLT embedded within the product.  This can be replaced by your own transform by creating a file in the plugins folder called <strong>ReturnedPunchoutBasket_{supplierCode}.xslt</strong> Where {supplierCode} is the code of your supplier.
The XSLT should generate XML in the following format:</p>
<pre><code class="xml">&lt;PurchaseOrder&gt;
  &lt;PurchaseOrderHeader&gt;
    &lt;SessionID&gt;&lt;/SessionID&gt;
    &lt;Currency&gt;&lt;/Currency&gt;
    &lt;TotalValue&gt;&lt;/TotalValue&gt;
  &lt;/PurchaseOrderHeader&gt;
  &lt;PunchOutDetail&gt;
    &lt;Item&gt;
      &lt;Product&gt;&lt;/Product&gt;
      &lt;Quantity&gt;&lt;/Quantity&gt;
      &lt;Description&gt;&lt;/Description&gt;
      &lt;UnitOfMeasure&gt;&lt;/UnitOfMeasure&gt;
      &lt;UnitValue&gt;&lt;/UnitValue&gt;
      &lt;Currency&gt;&lt;/Currency&gt;
      &lt;UNSPSCCode&gt;&lt;/UNSPSCCode&gt;
      &lt;Supplier&gt;&lt;/Supplier&gt;
      &lt;References&gt;
        &lt;Reference name=&quot;&quot;&gt;&lt;/Reference&gt;
      &lt;/References&gt;
    &lt;/Item&gt;
  &lt;/PunchOutDetail&gt;
&lt;/PurchaseOrder&gt;
``` 

The method in which the items are returned from the supplier’s site.
By default the supplier posts their basket back to either PunchoutReturned.aspx (for cxml) or PunchoutReturnedOCI.aspx (for oci).  It is however possible for you to provide your own page for processing the returned basket.  This is configured by completing the following field against the supplier record.



This page should be placed in the Customer folder within the website.


The default PunchoutReturned.aspx page looks for the basket xml in the following form fields:
1.  XML
2.  cxml-urlencode
3.  cxml-urlencoded
4.  cXML-base64
5.  oracleCart
6.  the first form field
The default PunchoutReturnedOCI.aspx page looks for the basket xml in the form fields as follows.
-   The items are returned in arrays of fields.  Indexed from 1 onwards
-   First it checks there is a field called NEW_ITEM-DESCRIPTION[1].  If there isn’t then it assumes that no basket items were returned.
-   It then loops through all fields which are named in the format NEW_xxxxx[n] where xxxxx is the name of a property and n is the item number.
-   Each of these form fields are then added into the xml.  The result xml will have the following format:
```xml
&lt;PurchaseOrder&gt;
    &lt;line number=1 item-description=’red pen’ etc etc /&gt;
&lt;/PurchaseOrder&gt;
</code></pre>

<h2 id="market-place">Market Place</h2>
<p>PROACTIS P2P allows users to connect to a “market place” where they can then browse catalogues of one or more suppliers.  When they have finished browsing and click check-out then their returned basket is used to create one or more draft purchase orders (or requisitions) within PROACTIS.
Unlike previous versions of PROACTIS it is now possible to configure marketplace connections directly within the product.</p>
<h3 id="configuration">Configuration</h3>
<p>Using the “System Control” application choose the Marketplaces option from the Supplier Maintenance menu.  Add a New market place and complete both the Details and Punch-out sections.</p>
<p>The following marketplace types (standards) are currently supported
-   CXML
-   PROACTIS EGS
-   Procserve
-   Science warehouse</p>
<p>The Supplier Code Mapped From field specifies how the supplier code in the returned basket is mapped back to the suppliers within PROACTIS.</p>
<h3 id="customisation">Customisation</h3>
<p>The xml used for the initial connection is generated using an xslt embedded within the product.  It is possible to provide your own xslt by creating a file in the plugins folder called MarketPlaceConnection_{marketPlaceName}.xslt.  Where {marketPlaceName} is the name of the configured marketplace.
The fields passed into the xml are listed below:
-   DepartmentCode
-   CompanyCode
-   LogonName
-   Email
-   ReturnURL
-   URL
-   BuyerCookie
-   PayloadID
-   Timestamp
-   PunchoutFromIdentity
-   PunchoutToIdentity
-   PunchoutSenderIdentity
-   PunchoutSenderSharedSecret</p>
<p>When the basket is returned from the market place by default it is transformed into the correct format by using an XSLT embedded within the product.  It is possible to provide your own xslt by creating a file in the plugins folder called MarketPlaceResult_{marketPlaceName}.xslt.  Where {marketPlaceName} is the name of the configured marketplace.
The xslt needs to generate xml in the following format</p>
<pre><code class="xml">&lt;PurchaseOrder&gt;
  &lt;PurchaseOrderHeader&gt;
    &lt;SessionID&gt;&lt;/SessionID&gt;
    &lt;Currency&gt;&lt;/Currency&gt;
    &lt;TotalValue&gt;&lt;/TotalValue&gt;
  &lt;/PurchaseOrderHeader&gt;
  &lt;PunchOutDetail&gt;
    &lt;Item&gt;
      &lt;Product&gt;&lt;/Product&gt;
      &lt;Quantity&gt;&lt;/Quantity&gt;
      &lt;Description&gt;&lt;/Description&gt;
      &lt;UnitOfMeasure&gt;&lt;/UnitOfMeasure&gt;
      &lt;UnitValue&gt;&lt;/UnitValue&gt;
      &lt;Currency&gt;&lt;/Currency&gt;
      &lt;UNSPSCCode&gt;&lt;/UNSPSCCode&gt;
      &lt;Supplier&gt;&lt;/Supplier&gt;
      &lt;References&gt;
        &lt;Reference name=&quot;&quot;&gt;&lt;/Reference&gt;
      &lt;/References&gt;
    &lt;/Item&gt;
  &lt;/PunchOutDetail&gt;
&lt;/PurchaseOrder&gt;
</code></pre>

<h1 id="egs-marketplaces">EGS Marketplaces</h1>
<p>The EGS settings within the PROACTIS Connectivity snapin, do not refer to marketplace punch-out.  This are used to configure different functionality not covered by this document.</p>
<h1 id="proxy-server">Proxy Server</h1>
<p>Connections to both supplier punch-out, and marketplaces honour the proxy server settings held in the dsdba.ProxySettings table.
This can be configured using the System Control application.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>(C) PROACTIS Group Ltd - All Rights Reserved</p>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="David Betteridge">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>PunchOut / Marketplaces - Technical Documentation</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">Technical Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../..">PROACTIS</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">P2P <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../Placeholder/">Overview</a>
</li>
                            
<li >
    <a href="../sso/">Single Sign On (SSO)</a>
</li>
                            
<li class="active">
    <a href="./">PunchOut / Marketplaces</a>
</li>
                            
<li >
    <a href="../nominalvalidation/">Nominal Validation</a>
</li>
                            
<li >
    <a href="../budgetchecking/">Budget Checking</a>
</li>
                            
<li >
    <a href="../../placeholder/">Custom Tabs</a>
</li>
                            
<li >
    <a href="../../placeholder/">Addins</a>
</li>
                            
<li >
    <a href="../../placeholder/">Invoice Posting</a>
</li>
                            
<li >
    <a href="../../placeholder/">Imaging Integration</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Import APIs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../placeholder/">Invoices</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li >
                        <a href="../../placeholder/">Spend Analytics</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">APF <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../apf/overview/">overview</a>
</li>
                            
<li >
    <a href="../../apf/overview/">p2p to apf</a>
</li>
                            
<li >
    <a href="../../apf/financesystem_to_paymentserver/">Finance System to Payments Server</a>
</li>
                        </ul>
                    </li>
                    <li >
                        <a href="../../s2c/placeholder/">S2C</a>
                    </li>
                    <li >
                        <a href="../../dueNorth/Placeholder/">DueNorth</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../sso/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../nominalvalidation/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/proactis-documentation/ExampleApplications">CodeExamples
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#punchout">PunchOut</a></li>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#punchthro">PunchThro.</a></li>
            <li><a href="#cxml-punchout">cXML PunchOut</a></li>
            <li><a href="#oci-punchout">OCI PunchOut</a></li>
            <li><a href="#punchout-customisations">PunchOut customisations</a></li>
        <li class="main "><a href="#market-place">Market Place</a></li>
            <li><a href="#configuration">Configuration</a></li>
            <li><a href="#customisation">Customisation</a></li>
            <li><a href="#egs-marketplaces">EGS Marketplaces</a></li>
        <li class="main "><a href="#proxy-server">Proxy Server</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="punchout">PunchOut</h1>
<h2 id="overview">Overview</h2>
<p>PunchOut allows a user to jump from the PROACTIS P2P website into a supplier’s shopping site.  Where they can browse a catalogue and add items to a shopping basket as per a normal e-commerce site.  Once they have finished browsing they click checkout and the items are then returned to PROACTIS as new lines on their current purchase order (or requisition).
For the purposes of this document, the term PunchOut does not include the ability to electronically export purchase orders to suppliers in cXML format.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This document details how to configure connections to supplier PunchOut sites and marketplaces in the latest release of PROACTIS P2P `17.
Unlike the previous versions it is now possible to configure the connections directly within the product.  Previously the setup action was carried out by a technical consultant which required the coding of bespoke webpages and sometimes DLLs for installation on the P2P server.</p>
</div>
<hr />
<h2 id="punchthro">PunchThro.</h2>
<p>There are three different methods of configuring PunchOut within the PROACTIS P2P product.   This first is referred to as punch-thro.  This is where the buyer connects to the suppliers PunchOut site via the PROACTIS S2C portal. </p>
<p>As the details of the suppliers site are configured in the PROACTIS S2C Portal the only P2P settings required are as shown below</p>
<ul>
<li>Configure the connection to your PROACTIS S2C portal.  (<strong>Application</strong> -&gt; <strong>PROACTIS Connectivity</strong>)</li>
</ul>
<p><img alt="alt text" src="../../img/p2p/punchout/s2c.bmp" title="cxml" /></p>
<ul>
<li>Enable the PunchOut via portal setting against the supplier.</li>
</ul>
<p><img alt="alt text" src="../../img/p2p/punchout/thru-settings.bmp" title="cxml" /></p>
<hr />
<h2 id="cxml-punchout">cXML PunchOut</h2>
<p>The majority of PunchOuts follow the <a href="http://cxml.org/">cXML</a> standard.  This can be configured directly within the P2P product by completing the following fields against a supplier.</p>
<p><img alt="alt text" src="../../img/p2p/punchout/cxml-settings.bmp" title="cxml" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li>The values for these 5 fields should be agreed with the supplier however DUNs numbers are often used for the three identities.</li>
<li>The fields can also be edited using the new WebPMC.</li>
</ul>
</div>
<hr />
<h2 id="oci-punchout">OCI PunchOut</h2>
<p>Less commonly used in the UK, but PROACTIS also supports the <a href="https://en.wikipedia.org/wiki/Open_Catalog_Interface">Open Catalog Interface</a> (OCI) PunchOut standard.  Again this can be configured directly within the product by completing the following three fields.</p>
<p><img alt="alt text" src="../../img/p2p/punchout/oci-settings.bmp" title="oci" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The supplier will normally provide you with their URL and your sender identity and secret.</p>
</div>
<hr />
<h2 id="punchout-customisations">PunchOut customisations</h2>
<p>It is possible to customise PunchOut at various points within the process:</p>
<h3 id="cxml-handshake">cXML Handshake</h3>
<p>The format of the cXML sent in the initial connection to the supplier’s site is generated from an XML using an XSLT transformation.  By default PROACTIS uses an XSLT embedded within the product however it is possible to use your own xslt by creating a file within the plugins folder called <strong>PunchoutConnection_{supplierCode}.xslt</strong>.  Where <em>{supplierCode}</em> is the code of your supplier.</p>
<p>The fields which are available to the XSLT are listed below.</p>
<ul>
<li>Context</li>
<li>SessionID</li>
<li>SupplierCode</li>
<li>DepartmentCode</li>
<li>CompanyCode</li>
<li>TemplateLabel</li>
<li>LogonName</li>
<li>ActualName</li>
<li>FirstName</li>
<li>Surname</li>
<li>Email</li>
<li>ReturnURL</li>
<li>URL</li>
<li>BuyerCookie</li>
<li>PayloadID</li>
<li>Timestamp</li>
<li>PunchoutFromIdentity</li>
<li>PunchoutToIdentity</li>
<li>PunchoutSenderIdentity</li>
<li>PunchoutSenderSharedSecret</li>
<li>DeliveryAddressGUID</li>
<li>DeliveryAddressName</li>
<li>DeliveryAddressLine1</li>
<li>DeliveryAddressLine2</li>
<li>DeliveryAddressLine3</li>
<li>DeliveryAddressLine4</li>
<li>DeliveryCountry</li>
<li>DeliveryCounty</li>
<li>DeliveryPostcode</li>
<li>DeliveryPostTown</li>
</ul>
<p>An example XSLT document is available <a href="https://github.com/proactis-documentation/ExampleApplications/tree/master/P2P/Punchout/Connections">here</a>.</p>
<h3 id="cxml-oci-returned-basket">cXML &amp; OCI Returned Basket</h3>
<p>When the basket is returned from the supplier by default it is transformed into the correct P2P format by using an XSLT embedded within the product.  This can be replaced by your own transform by creating a file in the plugins folder called <strong>ReturnedPunchoutBasket_{supplierCode}.xslt</strong> Where <em>{supplierCode}</em> is the code of your supplier.
The XSLT must generate XML in the following format:</p>
<pre><code class="xml">&lt;PurchaseOrder&gt;
  &lt;PurchaseOrderHeader&gt;
    &lt;SessionID&gt;&lt;/SessionID&gt;
    &lt;Currency&gt;&lt;/Currency&gt;
    &lt;TotalValue&gt;&lt;/TotalValue&gt;
  &lt;/PurchaseOrderHeader&gt;
  &lt;PunchOutDetail&gt;
    &lt;Item&gt;
      &lt;Product&gt;&lt;/Product&gt;
      &lt;Quantity&gt;&lt;/Quantity&gt;
      &lt;Description&gt;&lt;/Description&gt;
      &lt;UnitOfMeasure&gt;&lt;/UnitOfMeasure&gt;
      &lt;UnitValue&gt;&lt;/UnitValue&gt;
      &lt;Currency&gt;&lt;/Currency&gt;
      &lt;UNSPSCCode&gt;&lt;/UNSPSCCode&gt;
      &lt;Supplier&gt;&lt;/Supplier&gt;
      &lt;References&gt;
        &lt;Reference name=&quot;&quot;&gt;&lt;/Reference&gt;
      &lt;/References&gt;
    &lt;/Item&gt;
  &lt;/PunchOutDetail&gt;
&lt;/PurchaseOrder&gt;
</code></pre>

<p>An example XSLT document is available <a href="https://github.com/proactis-documentation/ExampleApplications/tree/master/P2P/Punchout/BasketResponses">here</a>.</p>
<h3 id="custom-return-page">Custom Return Page</h3>
<p>By default the supplier posts their basket back to either <strong>PunchoutReturned.aspx</strong> (for cxml) or <strong>PunchoutReturnedOCI.aspx</strong> (for oci).  It is however possible for you to provide your own page for processing the returned basket.  This is configured by completing the following field against the supplier record.</p>
<p><img alt="alt text" src="../../img/p2p/punchout/custom-return.bmp" title="return" /></p>
<p>This page should be placed in the Customer folder within the website.</p>
<p>The default <strong>PunchoutReturned.aspx</strong> page looks for the basket xml in the following form fields:</p>
<ol>
<li>XML</li>
<li>cxml-urlencode</li>
<li>cxml-urlencoded</li>
<li>cXML-base64</li>
<li>oracleCart</li>
<li>the first form field</li>
</ol>
<p>The default <strong>PunchoutReturnedOCI.aspx</strong> page looks for the basket xml in the form fields as follows:</p>
<ol>
<li>The items are returned in arrays of fields.  Indexed from 1 onwards</li>
<li>First it checks there is a field called NEW_ITEM+DESCRIPTION[1].  If there isn’t then it assumes that no basket items were returned.</li>
<li>It then loops through all fields which are named in the format NEW_xxxxx[n] where xxxxx is the name of a property and n is the item number.</li>
<li>Each of these form fields are then added into the xml.  The result xml will have the following format:</li>
</ol>
<pre><code class="xml">&lt;PurchaseOrder&gt;
    &lt;line number=1 item+description=’red pen’ etc etc /&gt;
&lt;/PurchaseOrder&gt;
</code></pre>

<h1 id="market-place">Market Place</h1>
<p>PROACTIS P2P allows users to connect to a “market place” where they can then browse catalogues of one or more suppliers.  When they have finished browsing and click check-out then their returned basket is used to create one or more draft purchase orders (or requisitions) within PROACTIS.
Unlike previous versions of PROACTIS it is now possible to configure marketplace connections directly within the product.</p>
<h2 id="configuration">Configuration</h2>
<p>Using the “System Control” application choose the Marketplaces option from the Supplier Maintenance menu.  Add a New market place and complete both the Details and PunchOut sections.</p>
<p>The following marketplace types (standards) are currently supported:</p>
<ul>
<li>CXML</li>
<li>PROACTIS EGS</li>
<li>Procserve</li>
<li>Science warehouse</li>
</ul>
<p>The Supplier Code Mapped From field specifies how the supplier code in the returned basket is mapped back to the suppliers within PROACTIS.</p>
<h2 id="customisation">Customisation</h2>
<p>The xml used for the initial connection is generated using an xslt embedded within the product.  It is possible to provide your own xslt by creating a file in the plugins folder called <strong>MarketPlaceConnection_{marketPlaceName}.xslt</strong>.  Where <em>{marketPlaceName}</em> is the name of the configured marketplace.
The fields passed into the xml are listed below:</p>
<ul>
<li>DepartmentCode</li>
<li>CompanyCode</li>
<li>LogonName</li>
<li>Email</li>
<li>ReturnURL</li>
<li>URL</li>
<li>BuyerCookie</li>
<li>PayloadID</li>
<li>Timestamp</li>
<li>PunchoutFromIdentity</li>
<li>PunchoutToIdentity</li>
<li>PunchoutSenderIdentity</li>
<li>PunchoutSenderSharedSecret</li>
</ul>
<p>When the basket is returned from the market place by default it is transformed into the correct format by using an XSLT embedded within the product.  It is possible to provide your own xslt by creating a file in the plugins folder called <strong>MarketPlaceResult_{marketPlaceName}.xslt</strong>.  Where <em>{marketPlaceName}</em> is the name of the configured marketplace.
The xslt needs to generate xml in the following format</p>
<pre><code class="xml">&lt;PurchaseOrder&gt;
  &lt;PurchaseOrderHeader&gt;
    &lt;SessionID&gt;&lt;/SessionID&gt;
    &lt;Currency&gt;&lt;/Currency&gt;
    &lt;TotalValue&gt;&lt;/TotalValue&gt;
  &lt;/PurchaseOrderHeader&gt;
  &lt;PunchOutDetail&gt;
    &lt;Item&gt;
      &lt;Product&gt;&lt;/Product&gt;
      &lt;Quantity&gt;&lt;/Quantity&gt;
      &lt;Description&gt;&lt;/Description&gt;
      &lt;UnitOfMeasure&gt;&lt;/UnitOfMeasure&gt;
      &lt;UnitValue&gt;&lt;/UnitValue&gt;
      &lt;Currency&gt;&lt;/Currency&gt;
      &lt;UNSPSCCode&gt;&lt;/UNSPSCCode&gt;
      &lt;Supplier&gt;&lt;/Supplier&gt;
      &lt;References&gt;
        &lt;Reference name=&quot;&quot;&gt;&lt;/Reference&gt;
      &lt;/References&gt;
    &lt;/Item&gt;
  &lt;/PunchOutDetail&gt;
&lt;/PurchaseOrder&gt;
</code></pre>

<h2 id="egs-marketplaces">EGS Marketplaces</h2>
<p>The EGS settings within the PROACTIS Connectivity snapin, do not refer to marketplace PunchOut.  This are used to configure different functionality not covered by this document.</p>
<h1 id="proxy-server">Proxy Server</h1>
<p>Connections to both supplier PunchOut, and marketplaces honour the proxy server settings held in the <strong>dsdba.ProxySettings</strong> table.
This can be configured using the System Control application.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>(C) PROACTIS Group Ltd - All Rights Reserved</p>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

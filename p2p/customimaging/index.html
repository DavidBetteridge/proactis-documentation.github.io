<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="David Betteridge">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Custom Imaging - Technical Documentation</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">Technical Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../..">PROACTIS</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">P2P <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../sso/">Single Sign On (SSO)</a>
</li>
                            
<li >
    <a href="../punchout/">PunchOut / Marketplaces</a>
</li>
                            
<li >
    <a href="../nominalvalidation/">Nominal Validation</a>
</li>
                            
<li >
    <a href="../budgetchecking/">Budget Checking</a>
</li>
                            
<li >
    <a href="../customtab/">Custom Tabs</a>
</li>
                            
<li >
    <a href="../addins/">Addins</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Imaging Integration</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../genericimaging/">Generic Imaging</a>
</li>
            
<li class="active">
    <a href="./">Custom Imaging</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li >
                        <a href="../../placeholder/">Spend Analytics</a>
                    </li>
                    <li >
                        <a href="../../placeholder/">APF</a>
                    </li>
                    <li >
                        <a href="../../placeholder/">S2C</a>
                    </li>
                    <li >
                        <a href="../../placeholder/">DueNorth</a>
                    </li>
                    <li >
                        <a href="../../placeholder/">System4</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../genericimaging/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../../placeholder/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/proactis-documentation/ExampleApplications">CodeExamples
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#custom-imaging-dlls">Custom Imaging DLLs</a></li>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#viewing-images">Viewing Images</a></li>
            <li><a href="#processing-images">Processing Images</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="custom-imaging-dlls">Custom Imaging DLLs</h1>
<h2 id="overview">Overview</h2>
<p>The PROACTIS P2P product has been designed so that it can be easily integrated with a number of different Document Management Systems (DMS).</p>
<p>A typical PROACTIS imaging solution requires the following integration points:-</p>
<ol>
<li>The scanned image needs to be associated with an invoice within PROACTIS.</li>
<li>Users need to be able to see the original scanned image by clicking a link within the PROACTIS web site.</li>
</ol>
<p>Although there are many different possible methods available (as different DMS and customers have different requirements) a generic imaging DLL has been written which meets the majority of customerâ€™s requirements.</p>
<p>For the cases where neither the built-in PROACTIS imaging solution or the Generic Imaging DLLs meet your requirements a completely custom DLL can be written.</p>
<hr />
<h2 id="viewing-images">Viewing Images</h2>
<ul>
<li>
<p>Create a new C# Class Library project called xyzImaging. ( <em>xyz</em> can be anything)</p>
</li>
<li>
<p>Add a reference to <strong>Purchasing Server\bin\PROACTIS.P2P.grsImagingIface.dll</strong></p>
</li>
<li>
<p>Add a public class called <strong>Imaging</strong> which implements the <strong>grsImageIface.IImaging</strong> interface.</p>
</li>
<li>
<p>Write an implementation of the following methods.</p>
<ul>
<li>GetImage</li>
<li>GetImageInfo</li>
<li>HasImage</li>
</ul>
</li>
</ul>
<hr />
<h3 id="hasimage">HasImage</h3>
<p>Controls if the View Image link is available when looking at a transaction within P2P</p>
<pre><code class="C#">bool IImaging.HasImage(string DocumentDetailsXML)
</code></pre>

<h4 id="arguments">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DocumentDetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
</tbody>
</table>
<h4 id="return-value">Return Value</h4>
<p>The function should return True if an image is available.</p>
<hr />
<h3 id="getimageinfo">GetImageInfo</h3>
<p>Returns basic information (MimeType and NumberOfPages) for an image held against a document.</p>
<pre><code class="C#">int IImaging.GetImageInfo(string DocumentDetailsXML, ref string MIMEType)
</code></pre>

<h4 id="arguments_1">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DocumentDetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>MIMEType</td>
<td>Out</td>
<td>Mime type of the document</td>
</tr>
</tbody>
</table>
<h4 id="mimetype">MIMEType</h4>
<p>This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.</p>
<h4 id="return-value_1">Return Value</h4>
<p>The function should return the name of pages within the document.  Normally 1</p>
<hr />
<h3 id="getimage">GetImage</h3>
<p>Used to return either the bytes which make up the image of the URL for the image if it's in a DMS.</p>
<pre><code class="c#">bool IImaging.GetImage(string DocumentDetailsXML, ref string MIMEType, ref byte[] Image, ref string URL)
</code></pre>

<h4 id="arguments_2">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DocumentDetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>MIMEType</td>
<td>Out</td>
<td>The type of image</td>
</tr>
<tr>
<td>Image</td>
<td>Out</td>
<td>Byte[] containing the image</td>
</tr>
<tr>
<td>URL</td>
<td>Out</td>
<td>URL to the image</td>
</tr>
</tbody>
</table>
<h4 id="mimetype_1">MIMEType</h4>
<p>This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.</p>
<h4 id="image">Image</h4>
<p>The image file as an array of bytes.  This will be steamed to the client's browser</p>
<h4 id="url">URL</h4>
<p>The URL of image in a DMS.</p>
<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>Either the Image <em>or</em> URL argument should be used.</p>
</div>
<hr />
<h3 id="documentdetailsxml">DocumentDetailsXML</h3>
<p>The xml in the DocumentDetailsXML argument is made up from some context specific details based on the document being display and the settings you have defined in the imaging settings table.</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;grs:ImagingSettings xmlns:grs=&quot;http://www.getrealsystems.com/xml/xml-ns&quot;&gt;
&lt;grs:SessionID&gt;eb89c444-0270-4f06-b8b6-ec0303b00117#dbserver2008r2\qa#DavidB_94#en-gb&lt;/grs:SessionID&gt;
&lt;grs:DocumentType&gt;I&lt;/grs:DocumentType&gt;
&lt;grs:DocumentGUID&gt;{D79D1EE8-4B87-414B-8512-92590DFBE2E8&lt;/grs:DocumentGUID&gt;
&lt;grs:ImageNumber&gt;0&lt;/grs:ImageNumber&gt;
&lt;grs:CompanyGUID&gt;{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B&lt;/grs:CompanyGUID&gt;

&lt;grs:InvoiceImageIdentifier&gt;DisplayNumber&lt;/grs:InvoiceImageIdentifier&gt;
&lt;grs:DefaultImageSource&gt;URL&lt;/grs:DefaultImageSource&gt;
&lt;grs:DefaultURL&gt;https://sp-db01/imaging/{{ImageID}}.bmp&lt;/grs:DefaultURL&gt;&lt;/grs:ImagingSettings&gt;
</code></pre>

<p>The standard fields which are always supplied as:-
<em> SessionID - in the format {uniqueID} # {database server} # {database name} # {user's language}
</em> DocumentType - 'I' for Invoice,  'C' for Credit note',  'E' for Expense Claim and 'A' For Acceptance 
<em> DocumentGUID - GUID to identify the document being displayed
</em> ImageNumber
* CompanyGUID - GUID of the company in which the document belongs</p>
<p>In the above example the remain fields (below) are from the <strong>DSDBA.ImagingSettings</strong> table.</p>
<ul>
<li>InvoiceImageIdentifier</li>
<li>DefaultImageSource</li>
<li>DefaultURL</li>
</ul>
<hr />
<h2 id="processing-images">Processing Images</h2>
<ul>
<li>
<p>Create a new C# Class Library project called xyzImaging. ( <em>xyz</em> can be anything)</p>
</li>
<li>
<p>Add a reference to <strong>Purchasing Server\bin\PROACTIS.P2P.grsImagingIface.dll</strong></p>
</li>
<li>
<p>Add a public class called <strong>Process</strong> which implements the <strong>P2P.grsImageIface.IProcess</strong> interface.</p>
</li>
<li>
<p>Write an implementation of the following methods.</p>
<ul>
<li>GetImage</li>
<li>GetImageInfo</li>
<li>GetListOfUnprocessedImages</li>
<li>HasUnprocessedImages</li>
<li>ProcessImage</li>
</ul>
</li>
</ul>
<hr />
<h3 id="hasunprocessedimages">HasUnprocessedImages</h3>
<p>Controls if the "Process An Image" link is available from Invoicing home page.</p>
<pre><code class="C#">bool IProcess.HasUnprocessedImages(string DetailsXML)
</code></pre>

<h4 id="arguments_3">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document type, database and company</td>
</tr>
</tbody>
</table>
<h4 id="return-value_2">Return Value</h4>
<p>The function should return True if one or more images are available for linking to invoices.</p>
<hr />
<h3 id="getlistofunprocessedimages">GetListOfUnprocessedImages</h3>
<p>Returns an XML table showing the list of invoices available for linking</p>
<pre><code class="C#">string IProcess.GetListOfUnprocessedImages(string DetailsXML)
</code></pre>

<h4 id="arguments_4">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document type, database and company</td>
</tr>
</tbody>
</table>
<h4 id="return-value_3">Return Value</h4>
<p>The function should return XML in the following format</p>
<pre><code class="xml">&lt;?xml version='1.0'?&gt;
&lt;grs:Images xmlns:grs='http://www.getrealsystems.com/xml/xml-ns'&gt;
    &lt;grs:Image grs:Identifier='PINV123.xml'&gt;
        &lt;grs:Fields&gt;
            &lt;grs:Field grs:Name='Column1' grs:Value='Value in column 1' /&gt;
            &lt;grs:Field grs:Name='Column2' grs:Value='Value in column 2' /&gt;
        &lt;/grs:Fields&gt;
    &lt;/grs:Image&gt;
&lt;/grs:Images&gt;
</code></pre>

<p>The above table would generate the following table:</p>
<p><img alt="alt text" src="../../img/p2p/imaging/unprocessed.JPG" title="Unprocessed" /></p>
<ul>
<li>There should be 1 grs:Image per scanned image.</li>
<li>The grs:Identifier attribute uniquely identities the image</li>
<li>Each column required in the table should be added as a grs:Field element</li>
<li>grs:Name provides the caption for the column and grs:Value it's contents.</li>
</ul>
<hr />
<h3 id="getimageinfo_1">GetImageInfo</h3>
<p>Returns basic information (MimeType and NumberOfPages) for an image held against a document.</p>
<pre><code class="C#">int IProcess.GetImageInfo(string DetailsXML, ref string MIMEType)
</code></pre>

<h4 id="arguments_5">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>MIMEType</td>
<td>Out</td>
<td>Mime type of the document</td>
</tr>
</tbody>
</table>
<h4 id="mimetype_2">MIMEType</h4>
<p>This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.</p>
<h4 id="return-value_4">Return Value</h4>
<p>The function should return the name of pages within the document.  Normally 1</p>
<hr />
<h3 id="getimage_1">GetImage</h3>
<p>Used to return either the bytes which make up the image of the URL for the image if it's in a DMS.</p>
<pre><code class="c#">bool IProcess.GetImage(string DetailsXML, ref string MIMEType, ref byte[] Image, ref string URL)
</code></pre>

<h4 id="arguments_6">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>MIMEType</td>
<td>Out</td>
<td>The type of image</td>
</tr>
<tr>
<td>Image</td>
<td>Out</td>
<td>Byte[] containing the image</td>
</tr>
<tr>
<td>URL</td>
<td>Out</td>
<td>URL to the image</td>
</tr>
</tbody>
</table>
<h4 id="mimetype_3">MIMEType</h4>
<p>This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.</p>
<h4 id="image_1">Image</h4>
<p>The image file as an array of bytes.  This will be steamed to the client's browser</p>
<h4 id="url_1">URL</h4>
<p>The URL of image in a DMS.</p>
<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>Either the Image <em>or</em> URL argument should be used.</p>
</div>
<hr />
<h3 id="processimage">ProcessImage</h3>
<p>Used to associate the image with a document.</p>
<pre><code class="c#">bool IProcess.ProcessImage(string DetailsXML, string DocumentXML, ref string UserMessages)
</code></pre>

<h4 id="arguments_7">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>DocumentXML</td>
<td>In</td>
<td></td>
</tr>
<tr>
<td>UserMessages</td>
<td>Out</td>
<td>.</td>
</tr>
</tbody>
</table>
<h4 id="documentxml">DocumentXML</h4>
<h4 id="usermessages">UserMessages</h4>
<hr />
<h3 id="detailsxml">DetailsXML</h3>
<p>The xml in the DetailsXML argument is made up from some context specific details based on the document being display and the settings you have defined in the imaging settings table.</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;grs:ImagingSettings xmlns:grs=&quot;http://www.getrealsystems.com/xml/xml-ns&quot;&gt;
&lt;grs:SessionID&gt;789e432f-6515-435c-8748-d88665d57119#dbserver2008r2\qa#DavidB_94#en-gb&lt;/grs:SessionID&gt;
&lt;grs:DocumentType&gt;C&lt;/grs:DocumentType&gt;
&lt;grs:DocumentGUID&gt;&lt;/grs:DocumentGUID&gt;
&lt;grs:ImageNumber&gt;0&lt;/grs:ImageNumber&gt;
&lt;grs:CompanyGUID&gt;{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B&lt;/grs:CompanyGUID&gt;

&lt;grs:InvoiceImageIdentifier&gt;DisplayNumber&lt;/grs:InvoiceImageIdentifier&gt;
&lt;grs:DefaultImageSource&gt;URL&lt;/grs:DefaultImageSource&gt;
&lt;grs:DefaultURL&gt;https://sp-db01/imaging/{{ImageID}}.bmp&lt;/grs:DefaultURL&gt;
&lt;/grs:ImagingSettings&gt;
</code></pre>

<p>The standard fields which are always supplied as:-</p>
<ul>
<li>SessionID - in the format {uniqueID} # {database server} # {database name} # {user's language}</li>
<li>DocumentType - 'I' for Invoice,  'C' for Credit note',  'E' for Expense Claim and 'A' For Acceptance </li>
<li>DocumentGUID - GUID to identify the document being displayed</li>
<li>ImageNumber</li>
<li>CompanyGUID - GUID of the company in which the document belongs</li>
</ul>
<p>In the above example the remain fields (below) are from the <strong>DSDBA.ImagingSettings</strong> table.</p>
<ul>
<li>InvoiceImageIdentifier</li>
<li>DefaultImageSource</li>
<li>DefaultURL</li>
</ul>
<hr /></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>(C) PROACTIS Group Ltd - All Rights Reserved</p>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

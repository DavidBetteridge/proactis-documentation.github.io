<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="David Betteridge">
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Custom Imaging - Technical Documentation</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/extra.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="../..">Technical Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../..">PROACTIS</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">P2P <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../sso/">Single Sign On (SSO)</a>
</li>
                            
<li >
    <a href="../punchout/">PunchOut / Marketplaces</a>
</li>
                            
<li >
    <a href="../nominalvalidation/">Nominal Validation</a>
</li>
                            
<li >
    <a href="../budgetchecking/">Budget Checking</a>
</li>
                            
<li >
    <a href="../customtab/">Custom Tabs</a>
</li>
                            
<li >
    <a href="../addins/">Addins</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Imaging Integration</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../genericimaging/">Generic Imaging</a>
</li>
            
<li class="active">
    <a href="./">Custom Imaging</a>
</li>
    </ul>
  </li>
                            
<li >
    <a href="../commitments/">Commitment Posting</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Import APIs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../acceptanceGateway/">Acceptances</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li >
                        <a href="../../placeholder/">Spend Analytics</a>
                    </li>
                    <li >
                        <a href="../../placeholder/">APF</a>
                    </li>
                    <li >
                        <a href="../../placeholder/">S2C</a>
                    </li>
                    <li >
                        <a href="../../placeholder/">DueNorth</a>
                    </li>
                    <li >
                        <a href="../../placeholder/">System4</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../genericimaging/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../commitments/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/proactis-documentation/ExampleApplications">CodeExamples
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#custom-imaging-dlls">Custom Imaging DLLs</a></li>
            <li><a href="#overview">Overview</a></li>
            <li><a href="#viewing-images">Viewing Images</a></li>
            <li><a href="#processing-images">Processing Images</a></li>
            <li><a href="#searching-for-unprocessed-images">Searching for unprocessed images</a></li>
            <li><a href="#uploading-images">Uploading Images</a></li>
            <li><a href="#example">Example</a></li>
            <li><a href="#deployment">Deployment</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="custom-imaging-dlls">Custom Imaging DLLs</h1>
<h2 id="overview">Overview</h2>
<p>The PROACTIS P2P product has been designed so that it can be easily integrated with a number of different Document Management Systems (DMS).</p>
<p>A typical PROACTIS imaging solution requires the following integration points:-</p>
<ol>
<li>The scanned image needs to be associated with an invoice within PROACTIS.</li>
<li>Users need to be able to see the original scanned image by clicking a link within the PROACTIS web site.</li>
</ol>
<p>Although there are many different possible methods available (as different DMS and customers have different requirements) a generic imaging DLL has been written which meets the majority of customerâ€™s requirements.</p>
<p>For the cases where neither the built-in PROACTIS imaging solution or the Generic Imaging DLLs meet your requirements a completely custom DLL can be written.</p>
<hr />
<h2 id="viewing-images">Viewing Images</h2>
<ul>
<li>
<p>Create a new C# Class Library project called xyzImaging. ( <em>xyz</em> can be anything)</p>
</li>
<li>
<p>Add a reference to <strong>Purchasing Server\bin\PROACTIS.P2P.grsImagingIface.dll</strong></p>
</li>
<li>
<p>Add a public class called <strong>Imaging</strong> which implements the <strong>grsImageIface.IImaging</strong> interface.</p>
</li>
<li>
<p>Write an implementation of the following methods.</p>
<ul>
<li>GetImage</li>
<li>GetImageInfo</li>
<li>HasImage</li>
</ul>
</li>
</ul>
<hr />
<h3 id="hasimage">HasImage</h3>
<p>Controls if the View Image link is available when looking at a transaction within P2P</p>
<pre><code class="C#">bool IImaging.HasImage(string DocumentDetailsXML)
</code></pre>

<h4 id="arguments">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DocumentDetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
</tbody>
</table>
<h4 id="return-value">Return Value</h4>
<p>The function should return True if an image is available.</p>
<hr />
<h3 id="getimageinfo">GetImageInfo</h3>
<p>Returns basic information (MimeType and NumberOfPages) for an image held against a document.</p>
<pre><code class="C#">int IImaging.GetImageInfo(string DocumentDetailsXML, out string MIMEType)
</code></pre>

<h4 id="arguments_1">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DocumentDetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>MIMEType</td>
<td>Out</td>
<td>Mime type of the document</td>
</tr>
</tbody>
</table>
<h4 id="mimetype">MIMEType</h4>
<p>This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.</p>
<h4 id="return-value_1">Return Value</h4>
<p>The function should return the name of pages within the document.  Normally 1</p>
<hr />
<h3 id="getimage">GetImage</h3>
<p>Used to return either the bytes which make up the image of the URL for the image if it's in a DMS.</p>
<pre><code class="c#">bool IImaging.GetImage(string DocumentDetailsXML, out string MIMEType, out byte[] Image, out string URL)
</code></pre>

<h4 id="arguments_2">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DocumentDetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>MIMEType</td>
<td>Out</td>
<td>The type of image</td>
</tr>
<tr>
<td>Image</td>
<td>Out</td>
<td>Byte[] containing the image</td>
</tr>
<tr>
<td>URL</td>
<td>Out</td>
<td>URL to the image</td>
</tr>
</tbody>
</table>
<h4 id="mimetype_1">MIMEType</h4>
<p>This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.</p>
<h4 id="image">Image</h4>
<p>The image file as an array of bytes.  This will be steamed to the client's browser</p>
<h4 id="url">URL</h4>
<p>The URL of image in a DMS.</p>
<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>Either the Image <em>or</em> URL argument should be used.</p>
</div>
<hr />
<h3 id="documentdetailsxml">DocumentDetailsXML</h3>
<p>The xml in the DocumentDetailsXML argument is made up from some context specific details based on the document being display and the settings you have defined in the imaging settings table.</p>
<pre><code class="xml">&lt;?xml version='1.0'?&gt;&lt;grs:ImagingSettings xmlns:grs='http://www.getrealsystems.com/xml/xml-ns'&gt;
&lt;grs:SessionID&gt;eb89c444-0270-4f06-b8b6-ec0303b00117#dbserver2008r2\qa#DavidB_94#en-gb&lt;/grs:SessionID&gt;
&lt;grs:DocumentType&gt;I&lt;/grs:DocumentType&gt;
&lt;grs:DocumentGUID&gt;{D79D1EE8-4B87-414B-8512-92590DFBE2E8}&lt;/grs:DocumentGUID&gt;
&lt;grs:ImageNumber&gt;0&lt;/grs:ImageNumber&gt;
&lt;grs:CompanyGUID&gt;{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}&lt;/grs:CompanyGUID&gt;

&lt;grs:InvoiceImageIdentifier&gt;DisplayNumber&lt;/grs:InvoiceImageIdentifier&gt;
&lt;grs:DefaultImageSource&gt;URL&lt;/grs:DefaultImageSource&gt;
&lt;grs:DefaultURL&gt;https://sp-db01/imaging/{{ImageID}}.bmp&lt;/grs:DefaultURL&gt;&lt;/grs:ImagingSettings&gt;
</code></pre>

<p>The standard fields which are always supplied as:-</p>
<ul>
<li>SessionID - in the format {uniqueID} # {database server} # {database name} # {user's language}</li>
<li>DocumentType - 'I' for Invoice,  'C' for Credit note',  'E' for Expense Claim and 'A' For Acceptance </li>
<li>DocumentGUID - GUID to identify the document being displayed</li>
<li>ImageNumber</li>
<li>CompanyGUID - GUID of the company in which the document belongs</li>
</ul>
<p>In the above example the remaining fields (below) are from the <strong>DSDBA.ImagingSettings</strong> table.</p>
<ul>
<li>InvoiceImageIdentifier</li>
<li>DefaultImageSource</li>
<li>DefaultURL</li>
</ul>
<hr />
<h2 id="processing-images">Processing Images</h2>
<ul>
<li>
<p>Create a new C# Class Library project called xyzImaging. ( <em>xyz</em> can be anything)</p>
</li>
<li>
<p>Add a reference to <strong>Purchasing Server\bin\PROACTIS.P2P.grsImagingIface.dll</strong></p>
</li>
<li>
<p>Add a public class called <strong>Process</strong> which implements the <strong>P2P.grsImageIface.IProcess</strong> interface.</p>
</li>
<li>
<p>Write an implementation of the following methods.</p>
<ul>
<li>GetImage</li>
<li>GetImageInfo</li>
<li>GetListOfUnprocessedImages</li>
<li>HasUnprocessedImages</li>
<li>ProcessImage</li>
</ul>
</li>
</ul>
<hr />
<h3 id="hasunprocessedimages">HasUnprocessedImages</h3>
<p>Controls if the "Process An Image" link is available from Invoicing home page.</p>
<pre><code class="C#">bool IProcess.HasUnprocessedImages(string DetailsXML)
</code></pre>

<h4 id="arguments_3">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document type, database and company</td>
</tr>
</tbody>
</table>
<h4 id="return-value_2">Return Value</h4>
<p>The function should return True if one or more images are available for linking to invoices.</p>
<hr />
<h3 id="getlistofunprocessedimages">GetListOfUnprocessedImages</h3>
<p>Returns an XML table showing the list of invoices available for linking</p>
<pre><code class="C#">string IProcess.GetListOfUnprocessedImages(string DetailsXML)
</code></pre>

<h4 id="arguments_4">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document type, database and company</td>
</tr>
</tbody>
</table>
<h4 id="return-value_3">Return Value</h4>
<p>The function should return XML in the following format</p>
<pre><code class="xml">&lt;?xml version='1.0'?&gt;
&lt;grs:Images xmlns:grs='http://www.getrealsystems.com/xml/xml-ns'&gt;
    &lt;grs:Image grs:Identifier='PINV123.xml'&gt;
        &lt;grs:Fields&gt;
            &lt;grs:Field grs:Name='Column1' grs:Value='Value in column 1' /&gt;
            &lt;grs:Field grs:Name='Column2' grs:Value='Value in column 2' /&gt;
        &lt;/grs:Fields&gt;
    &lt;/grs:Image&gt;
&lt;/grs:Images&gt;
</code></pre>

<p>The above table would generate the following table:</p>
<p><img alt="alt text" src="../../img/p2p/imaging/unprocessed.JPG" title="Unprocessed" /></p>
<ul>
<li>There should be one grs:Image element for each scanned image.</li>
<li>The grs:Identifier attribute uniquely identifies the image</li>
<li>Each column required in the table should be added as a grs:Field element</li>
<li>grs:Name provides the caption for the column and grs:Value it's contents.</li>
</ul>
<hr />
<h3 id="getimageinfo_1">GetImageInfo</h3>
<p>Returns basic information (MimeType and NumberOfPages) for an image held against a document.</p>
<pre><code class="C#">int IProcess.GetImageInfo(string DetailsXML, out string MIMEType)
</code></pre>

<h4 id="arguments_5">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>MIMEType</td>
<td>Out</td>
<td>Mime type of the document</td>
</tr>
</tbody>
</table>
<h4 id="mimetype_2">MIMEType</h4>
<p>This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.</p>
<h4 id="return-value_4">Return Value</h4>
<p>The function should return the name of pages within the document.  Normally 1</p>
<hr />
<h3 id="getimage_1">GetImage</h3>
<p>Used to return either the bytes which make up the image of the URL for the image if it's in a DMS.</p>
<pre><code class="c#">bool IProcess.GetImage(string DetailsXML, out string MIMEType, out byte[] Image, out string URL)
</code></pre>

<h4 id="arguments_6">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>MIMEType</td>
<td>Out</td>
<td>The type of image</td>
</tr>
<tr>
<td>Image</td>
<td>Out</td>
<td>Byte[] containing the image</td>
</tr>
<tr>
<td>URL</td>
<td>Out</td>
<td>URL to the image</td>
</tr>
</tbody>
</table>
<h4 id="mimetype_3">MIMEType</h4>
<p>This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.</p>
<h4 id="image_1">Image</h4>
<p>The image file as an array of bytes.  This will be steamed to the client's browser</p>
<h4 id="url_1">URL</h4>
<p>The URL of image in a DMS.</p>
<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>Either the Image <em>or</em> URL argument should be used.</p>
</div>
<hr />
<h3 id="processimage">ProcessImage</h3>
<p>Used to associate the image with a document.</p>
<pre><code class="c#">bool IProcess.ProcessImage(string DetailsXML, string DocumentXML, out string UserMessages)
</code></pre>

<h4 id="arguments_7">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the details of the document currently being displayed.</td>
</tr>
<tr>
<td>DocumentXML</td>
<td>In</td>
<td>The full P2P document which is being linked to the image</td>
</tr>
<tr>
<td>UserMessages</td>
<td>Out</td>
<td>Messages to feed back to the user</td>
</tr>
</tbody>
</table>
<h4 id="detailsxml">DetailsXML</h4>
<p>The DocumentGUID will contain the unique identifier for the selected image.</p>
<h4 id="documentxml">DocumentXML</h4>
<p>The full internal XML for the document this image is being linked with.  The format varies depending on the type of document.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>As the internal xml format us undocumented and subject to change it is recommended that you extract as little information as possible and program defensively.</p>
</div>
<h4 id="usermessages">UserMessages</h4>
<p>Allows user message to be returned to the PROACTIS website.  Not normally required.</p>
<div class="admonition notes">
<p class="admonition-title">Notes</p>
<p>This method is responsible for storing the link between the scanned image and the P2P document.  For example the unique ID might be written to the <strong>ImageReference</strong> column in the <strong>dsdba.Invoices</strong> table.</p>
</div>
<hr />
<h3 id="detailsxml_1">DetailsXML</h3>
<p>The xml in the DetailsXML argument is made up from some context specific details based on the document being display and the settings you have defined in the imaging settings table.</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;grs:ImagingSettings xmlns:grs=&quot;http://www.getrealsystems.com/xml/xml-ns&quot;&gt;
&lt;grs:SessionID&gt;789e432f-6515-435c-8748-d88665d57119#dbserver2008r2\qa#DavidB_94#en-gb&lt;/grs:SessionID&gt;
&lt;grs:DocumentType&gt;C&lt;/grs:DocumentType&gt;
&lt;grs:DocumentGUID&gt;&lt;/grs:DocumentGUID&gt;
&lt;grs:ImageNumber&gt;0&lt;/grs:ImageNumber&gt;
&lt;grs:CompanyGUID&gt;{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}&lt;/grs:CompanyGUID&gt;

&lt;grs:InvoiceImageIdentifier&gt;DisplayNumber&lt;/grs:InvoiceImageIdentifier&gt;
&lt;grs:DefaultImageSource&gt;URL&lt;/grs:DefaultImageSource&gt;
&lt;grs:DefaultURL&gt;https://sp-db01/imaging/{{ImageID}}.bmp&lt;/grs:DefaultURL&gt;
&lt;/grs:ImagingSettings&gt;
</code></pre>

<p>The standard fields which are always supplied as:-</p>
<ul>
<li>SessionID - in the format {uniqueID} # {database server} # {database name} # {user's language}</li>
<li>DocumentType - 'I' for Invoice,  'C' for Credit note',  'E' for Expense Claim and 'A' For Acceptance </li>
<li>DocumentGUID - GUID to identify the document being displayed</li>
<li>ImageNumber</li>
<li>CompanyGUID - GUID of the company in which the document belongs</li>
</ul>
<p>In the above example the remaining fields (below) are from the <strong>DSDBA.ImagingSettings</strong> table.</p>
<ul>
<li>InvoiceImageIdentifier</li>
<li>DefaultImageSource</li>
<li>DefaultURL</li>
</ul>
<hr />
<h2 id="searching-for-unprocessed-images">Searching for unprocessed images</h2>
<ul>
<li>
<p>Create a new C# Class Library project called xyzImaging. ( <em>xyz</em> can be anything)</p>
</li>
<li>
<p>Add a reference to <strong>Purchasing Server\bin\PROACTIS.P2P.grsImagingIface.dll</strong></p>
</li>
<li>
<p>Add a public class called <strong>Search</strong> which implements the <strong>grsImageIface.ISearch</strong> interface.</p>
</li>
<li>
<p>Write an implementation of the following methods.</p>
<ul>
<li>SearchForUnprocessedImages</li>
</ul>
</li>
</ul>
<hr />
<h3 id="searchforunprocessedimages">SearchForUnprocessedImages</h3>
<p>Returns a list of unprocessed images based on the search criteria entered by the user.</p>
<p><img alt="alt text" src="../../img/p2p/imaging/search.JPG" title="Search" /></p>
<h4 id="signature">Signature</h4>
<pre><code class="C#">string ISearch.SearchForUnprocessedImages(string DetailsXML)
</code></pre>

<h4 id="arguments_8">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the search criteria .</td>
</tr>
</tbody>
</table>
<h4 id="detailsxml_2">DetailsXML</h4>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;grs:ImagingSettings xmlns:grs=&quot;http://www.getrealsystems.com/xml/xml-ns&quot;&gt;
    &lt;grs:SessionID&gt;fd2ae334-dd29-42d3-9706-ea4883b7bedc#dbserver2008r2\qa#DavidB_94#en-gb&lt;/grs:SessionID&gt;
    &lt;grs:DocumentType&gt;I&lt;/grs:DocumentType&gt;
    &lt;grs:DocumentGUID&gt;&lt;/grs:DocumentGUID&gt;
    &lt;grs:ImageNumber&gt;0&lt;/grs:ImageNumber&gt;
    &lt;grs:CompanyGUID&gt;{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}&lt;/grs:CompanyGUID&gt;
    &lt;grs:MaxReturnRows&gt;100&lt;/grs:MaxReturnRows&gt;
    &lt;grs:PrimarySortColumn&gt;DocumentDate&lt;/grs:PrimarySortColumn&gt;
    &lt;grs:PrimarySortAscending&gt;False&lt;/grs:PrimarySortAscending&gt;
    &lt;grs:SupplierReference&gt;&lt;/grs:SupplierReference&gt;
    &lt;grs:DateFrom&gt;&lt;/grs:DateFrom&gt;
    &lt;grs:DateTo&gt;&lt;/grs:DateTo&gt;
    &lt;grs:FromAddress&gt;&lt;/grs:FromAddress&gt;
    &lt;grs:ToAddress&gt;&lt;/grs:ToAddress&gt;
    &lt;grs:Subject&gt;&lt;/grs:Subject&gt;
    &lt;grs:RuleName&gt;&lt;/grs:RuleName&gt;
    &lt;grs:DateEmailedFrom&gt;&lt;/grs:DateEmailedFrom&gt;
    &lt;grs:DateEmailedTo&gt;&lt;/grs:DateEmailedTo&gt;

    &lt;grs:DefaultImageSource&gt;URL&lt;/grs:DefaultImageSource&gt;
    &lt;grs:DefaultURL&gt;https://sp-db01/imaging/{{ImageID}}.bmp&lt;/grs:DefaultURL&gt;
&lt;/grs:ImagingSettings&gt;
</code></pre>

<p>The following fields can be ignored as they aren't applicable to this function</p>
<ul>
<li>DocumentGUID</li>
<li>ImageNumber</li>
</ul>
<p>In the above example the following fields come from the <strong>dsdba.ImagingSettings</strong> table</p>
<ul>
<li>InvoiceImageIdentifier</li>
<li>DefaultImageSource</li>
<li>DefaultURL</li>
</ul>
<h4 id="return-value_5">Return Value</h4>
<p>The function should return xml table in the following format containing the list of available (unprocessed) images.</p>
<pre><code class="xml">&lt;SearchResults&gt;
    &lt;Row GUID='...' 
        SupplierReference='sup' 
        DocumentDate='2016-1-1' 
        DocumentImportRule = ''
        EmailDate='2016-1-1'
        FromAddress='david@proactis.com'
        FromName='David Betteridge'
        Subject='An Email'
        ToAddress='david@proactis.com' /&gt;
&lt;/SearchResults&gt;
</code></pre>

<ul>
<li>One row should be added for each unprocessed image</li>
<li>All the attributes listed above must be supplied</li>
</ul>
<p><img alt="alt text" src="../../img/p2p/imaging/search_results.JPG" title="Results" /></p>
<hr />
<h2 id="uploading-images">Uploading Images</h2>
<ul>
<li>
<p>Create a new C# Class Library project called xyzImaging. ( <em>xyz</em> can be anything)</p>
</li>
<li>
<p>Add a reference to <strong>Purchasing Server\bin\PROACTIS.P2P.grsImagingIface.dll</strong></p>
</li>
<li>
<p>Add a public class called <strong>Upload</strong> which implements the __grsImageIface.IUpload interface.</p>
</li>
<li>
<p>Write an implementation of the following methods.</p>
<ul>
<li>StoreNewImage</li>
</ul>
</li>
</ul>
<hr />
<h3 id="storenewimage">StoreNewImage</h3>
<p>Stores an image uploaded by the user on the server</p>
<p><img alt="alt text" src="../../img/p2p/imaging/upload.JPG" title="Upload" /></p>
<h4 id="signature_1">Signature</h4>
<pre><code class="C#">bool IUpload.StoreNewImage(string DetailsXML, byte[] FileContents)
</code></pre>

<h4 id="arguments_9">Arguments</h4>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Direction</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>DetailsXML</td>
<td>In</td>
<td>An xml document containing the image metadata.</td>
</tr>
<tr>
<td>FileContents</td>
<td>In</td>
<td>Contents of the image</td>
</tr>
</tbody>
</table>
<h5 id="detailsxml_3">DetailsXML</h5>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;grs:ImagingSettings xmlns:grs=&quot;http://www.getrealsystems.com/xml/xml-ns&quot;&gt;
    &lt;grs:DocumentGUID&gt;{7451C54A-52F0-4794-87FB-A6093AAD65AF}&lt;/grs:DocumentGUID&gt;
    &lt;grs:ImageNumber&gt;1&lt;/grs:ImageNumber&gt;

    &lt;grs:SessionID&gt;bd860b98-c82b-47fa-9522-a4f27f154cd6#dbserver2008r2\qa#DavidB_94#en-gb&lt;/grs:SessionID&gt;
    &lt;grs:DocumentType&gt;I&lt;/grs:DocumentType&gt;
    &lt;grs:CompanyGUID&gt;{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}&lt;/grs:CompanyGUID&gt;
    &lt;grs:Reference&gt;heading.JPG&lt;/grs:Reference&gt;
    &lt;grs:FileType&gt;JPG&lt;/grs:FileType&gt;

    &lt;grs:InvoiceImageIdentifier&gt;DisplayNumber&lt;/grs:InvoiceImageIdentifier&gt;
    &lt;grs:DefaultImageSource&gt;URL&lt;/grs:DefaultImageSource&gt;
    &lt;grs:DefaultURL&gt;https://sp-db01/imaging/{{ImageID}}.bmp&lt;/grs:DefaultURL&gt;
&lt;/grs:ImagingSettings&gt;
</code></pre>

<ul>
<li>The DocumentGUID is a unique ID generated for this file</li>
<li>ImageNumber will always be 1</li>
<li>Reference is the name of the uploaded file</li>
<li>DocumentType is I for Invoice and C for Credit Note</li>
</ul>
<p>In the above example the following fields come from the <strong>dsdba.ImagingSettings</strong> table</p>
<ul>
<li>InvoiceImageIdentifier</li>
<li>DefaultImageSource</li>
<li>DefaultURL</li>
</ul>
<h4 id="return-value_6">Return Value</h4>
<p>Return TRUE for success</p>
<hr />
<h2 id="example">Example</h2>
<p>See the <a href="https://github.com/proactis-documentation/ExampleApplications/tree/master/P2P/Imaging">example application</a> for a complete implementation.</p>
<hr />
<h2 id="deployment">Deployment</h2>
<p>Your dll should be complied (and named xyzImaging.dll) and then copied into your <strong>PROACTIS P2P/Plugins</strong>  (or <strong>Plugins/[database-title]</strong>) folder.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>(C) PROACTIS Group Ltd - All Rights Reserved</p>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>

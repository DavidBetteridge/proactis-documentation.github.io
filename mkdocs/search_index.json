{
    "docs": [
        {
            "location": "/",
            "text": "Welcome\n\n\nThis site provides technical documentation for the PROACTIS suite of applications.\n\n\nIntellectual Property\n\n\nThis document contains information related to certain products and services which is proprietary to PROACTIS Group Limited. Notably, all Intellectual property related to the deployment of the PROACTIS Suite of applications is to the benefit of and remains the property of PROACTIS Group Limited.",
            "title": "PROACTIS"
        },
        {
            "location": "/#welcome",
            "text": "This site provides technical documentation for the PROACTIS suite of applications.",
            "title": "Welcome"
        },
        {
            "location": "/#intellectual-property",
            "text": "This document contains information related to certain products and services which is proprietary to PROACTIS Group Limited. Notably, all Intellectual property related to the deployment of the PROACTIS Suite of applications is to the benefit of and remains the property of PROACTIS Group Limited.",
            "title": "Intellectual Property"
        },
        {
            "location": "/p2p/sso/",
            "text": "P2P Single-Sign-On (SSO)\n\n\nBy default PROACTIS expects the users to enter their username and password in order to login into PROACTIS P2P.   This document lists the possible ways in which PROACTIS P2P can be configured to allow users to authenticate using Single-Sign-On.\n\n\n\n\nNote\n\n\nIf you wish your users to use a combination of PROACTIS and SSO logins then add the following setting to the \nApplicationConfiguration.xml\n file.\n\n\n\n\n<Setting Name=\"AllowPROACTISLogins\">True</Setting>\n\n\n\n\n\n\nWindows Authentication\n\n\nIf your PROACTIS P2P server is on the same domain as your users then the system can be configured so that they are automatically signed on without the need for them to re-enter their username and password.\n\n\n\n\nEnsure that Windows Authentication is enabled in IIS for your PROACTIS website\n\n\n\n\nIt must first be installed as part of the \nWeb Server\n role. \n\n\n\n\nAnd then enabled in the authentication section of your website\n\n\n\n\n\n\nNote\n\n\nIf some of your users aren't on your domain,  then leave anonymous authentication enabled for them.\n\n\n\n\n\n\nAdd the following setting to the \nApplicationConfiguration.xml\n file.\n\n\n\n\n<Setting Name=\"AuthenticationMethod\">WINDOWS</Setting>\n\n\n\n\n\n\nSet the \nNTLogon\n flag to True against the users,  and ensure that their usernames are in the format DOMAIN\\Username.  \nFor example PROACTIS\\DavidBetteridge\n\n\n\n\n\n\nSAML2\n\n\nPROACTIS P2P has built in support for SSO using the industry standard \nSAML2\n protocol.\n\n\n\n\nFirst generate (or obtain) a local certificate and provide the public part of this to your identity provider.\n\n\n\n\nmakecert -r -pe -n \"CN=your_cert_name\" -sky exchange -sv mycert.pvk mycert.cer\n\nEnter yourPassword for the subject key (3 times!)\n\npvk2pfx.exe -pvk mycert.pvk -spc mycert.cer  -pi yourPassword -pfx mycert.pfx -po yourPassword\n\n\n\n\nYou will need to supply the identity provider with the public part of the generated certificate along with the path to the AssertionConsumerService which will be \nhttps://{server}/SystemLogon/AssertionConsumerService\n.\n\n\n\n\nWarning\n\n\nIn order to use the SAML protocol your P2P website must be accessed using HTTPS not HTTP.\n\n\n\n\n\n\nWith in your website's customer folder create a file called \nsaml.config\n.   This should be based on the following template.\n\n\n\n\n<?xml version=\"1.0\"?>\n<SAMLConfiguration xmlns=\"urn:componentspace:SAML:2.0:configuration\">\n\u00a0\u00a0 <ServiceProvider Name=\"service-provider-name\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 AssertionConsumerServiceUrl=\"~/SystemLogon/AssertionConsumerService\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 LocalCertificateFile=\"path-to-local-certificate-file\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 LocalCertificatePassword=\"local-certificate-password\"/>\n\u00a0\n\u00a0\n\u00a0\u00a0 <!-- ADFS -->\n\u00a0\u00a0 <PartnerIdentityProviders>\n\u00a0\u00a0\u00a0\u00a0\u00a0 <PartnerIdentityProvider Name=\"partner-identity-provider-name\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Description=\"PROACTIS AD\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 SignAuthnRequest=\"false\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 WantSAMLResponseSigned=\"false\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0WantAssertionSigned=\"true\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 WantAssertionEncrypted=\"true\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 PartnerCertificateFile=\"path-to-partner-certificate-file\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ClockSkew=\"00:03:00\"\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0SingleSignOnServiceUrl=\"single-sign-on-service-url\"/>\n\u00a0\u00a0 </PartnerIdentityProviders>\n\u00a0\n</SAMLConfiguration>\n\n\n\n\n\n\nAdd the following settings to your application.configuration file\n\n\n\n\n<Setting Name=\"SSOAttributeName\">NameID</Setting>\n\n\n\n\nThe name of the attribute containing the user identifier in the attributes list returned from the ADFS server.\nIf not specified then no attribute lookup is made and user identification is based on the \u201cusername\u201d returned from the ADFS server.\n\u00a0\n\n\n<Setting Name=\"SSOAttributeNameMask\"></Setting>\n\n\n\n\nAn optional mask to be applied to the above user identifier value.\n\u00a0\n\n\n<Setting Name=\"SSOMatchP2PUserOnEmailAddress\">False</Setting>\n\n\n\n\nBy default, P2P searches the database Users table to find a user whose \u201cLoginID\u201d matches the identifier value returned from the ADFS server.\nThis optional setting will cause the lookup to be made on \u201cEmailAddress\u201d rather than \u201cLoginID\u201d\n\u00a0\n\n\n<Setting Name=\"SSODatabaseTitle\"></Setting>\n\n\n\n\nAn optional setting that only applies when a user who is already logged into a 3rd party system, initiates a logon to P2P via SSO. In this scenario, the user is not \npresented with a logon page. If the user has access to multiple databases, then this setting specifies the database title (in the database xml file) to log into.\nIf this setting is not present, P2P will select the default database in the databases xml file (or the first database if no default).\nObviously if only one database is available, then this setting is unnecessary.\n\n\n\n\nExternal\n\n\nBy default PROACTIS P2P validates the username and password entered by the user against the record in the \ndsdba.Users\n table.   It is however possible to customise PROACTIS so that users are validated against an external userstore such as LDAP.\n\n\nThe following steps should be followed in order to create an external validation DLL.\n\n\n\n\n\n\nCreate a new C# class library with a class called \nServices\n which implements the \nILogin\n interface.  This interface can be found in \nPROACTIS.P2P.grsCustInterfaces.DLL\n\n\n\n\n\n\nDecide if your login process will be called asynchronously or not and implement the UseAsynchronousImplementation as required.\n\n\n\n\n\n\n    public bool UseAsynchronousImplementation => false;\n\n\n\n\n\n\n\n\nImplement the \nLogin\n (or \nLoginAsync\n) method with your custom validation code.  This method should return True for a successful login and False for a failure.  (For security reasons it is not possible to return messages informing the user why the login failed.  For example \nthe username does not exist\n)\n\n\n\n\n\n\nCompile your code,  and ensure that the resulting DLL is named xyzLogin.DLL.   (xyz can be anything)\n\n\n\n\n\n\nCopy the DLL into your \nPROACTIS P2P/Plugins\n  (or \nPlugins/[database-title]\n) folder.\n\n\n\n\n\n\nAdd the following setting into your \napplicationconfiguration.xml\n file.\n\n\n\n\n\n\n<Setting Name=\"AuthenticationMethod\">EXTERNAL</Setting>\n\n\n\n\nSee the \nPROACTIS.ExampleApplications.ExternalLogin\n example application for a complete sample implementation.\n\n\n\n\nNote\n\n\n\n\nIn order to login using the external DLL,  the user must have their NTLogon property set to True\n\n\nFailed login attempts aren't recorded\n\n\n\n\n\n\n\n\nBespoke\n\n\nIt is also possible to provide your users with a completely custom login process,  including replacing the login screen and adding the ability to automatically create users the first time they connect.\n\n\nThe process is to :\n\n\n\n\n\n\nCreate a custom page in your website's customer folder called \nCustomLogin\n\n\n\n\n\n\nWithin that page collect any required details from the user and validate their credentials.\n\n\n\n\n\n\nIf the user entered valid details then log them on by:\n\n\n\n\nFirst generating a unique token for them\n\n\nThen writing the token to the \nDSDBA.CustomLoginTokens\n table.\n\n\nFinally redirecting the user's browser to CustomLoginAsync within the main site.\n\n\n\n\n\n\n\n\nTo enable your new page to be used,  the following settings should be added to the \nApplicationConfiguration\n file.\n\n\n\n\n\n\n<Setting Name=\"AuthenticationMethod\">CUSTOM</Setting>\n<Setting Name=\"CustomLoginURL\">https://server/custom/CustomLogin.aspx</Setting>\n\n\n\n\nWhere \nserver\n is the address of your core P2P website.\n\n\nSee these \nexample pages\n for a complete sample.\n\n\n\n\nNote\n\n\nUpon exit from P2P, the browser will be redirected back to the custom login page with the following in the querystring \naction=logout\n. If the custom logon page uses automated logins then it must take notice of this parameter to not automatically log the user back in again\n\n\n\n\nReturn Messages\n\n\nMessages are return to the custom login page using the following query string format\n\nInfoMessages=XXX&AlertMessages=YYY&ErrorMessages=ZZZ\n\n\nWhere XXX, YYY and ZZZ are base64 encoded UNICODE strings. Each encoded string contains the messages concatenate with a \u201c|\u201d separator. (see sample app)\nThese entries will only be in the querystring if there are messages to return.",
            "title": "Single Sign On (SSO)"
        },
        {
            "location": "/p2p/sso/#p2p-single-sign-on-sso",
            "text": "By default PROACTIS expects the users to enter their username and password in order to login into PROACTIS P2P.   This document lists the possible ways in which PROACTIS P2P can be configured to allow users to authenticate using Single-Sign-On.   Note  If you wish your users to use a combination of PROACTIS and SSO logins then add the following setting to the  ApplicationConfiguration.xml  file.   <Setting Name=\"AllowPROACTISLogins\">True</Setting>",
            "title": "P2P Single-Sign-On (SSO)"
        },
        {
            "location": "/p2p/sso/#windows-authentication",
            "text": "If your PROACTIS P2P server is on the same domain as your users then the system can be configured so that they are automatically signed on without the need for them to re-enter their username and password.   Ensure that Windows Authentication is enabled in IIS for your PROACTIS website   It must first be installed as part of the  Web Server  role.    And then enabled in the authentication section of your website    Note  If some of your users aren't on your domain,  then leave anonymous authentication enabled for them.    Add the following setting to the  ApplicationConfiguration.xml  file.   <Setting Name=\"AuthenticationMethod\">WINDOWS</Setting>   Set the  NTLogon  flag to True against the users,  and ensure that their usernames are in the format DOMAIN\\Username.   For example PROACTIS\\DavidBetteridge",
            "title": "Windows Authentication"
        },
        {
            "location": "/p2p/sso/#saml2",
            "text": "PROACTIS P2P has built in support for SSO using the industry standard  SAML2  protocol.   First generate (or obtain) a local certificate and provide the public part of this to your identity provider.   makecert -r -pe -n \"CN=your_cert_name\" -sky exchange -sv mycert.pvk mycert.cer\n\nEnter yourPassword for the subject key (3 times!)\n\npvk2pfx.exe -pvk mycert.pvk -spc mycert.cer  -pi yourPassword -pfx mycert.pfx -po yourPassword  You will need to supply the identity provider with the public part of the generated certificate along with the path to the AssertionConsumerService which will be  https://{server}/SystemLogon/AssertionConsumerService .   Warning  In order to use the SAML protocol your P2P website must be accessed using HTTPS not HTTP.    With in your website's customer folder create a file called  saml.config .   This should be based on the following template.   <?xml version=\"1.0\"?>\n<SAMLConfiguration xmlns=\"urn:componentspace:SAML:2.0:configuration\">\n\u00a0\u00a0 <ServiceProvider Name=\"service-provider-name\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 AssertionConsumerServiceUrl=\"~/SystemLogon/AssertionConsumerService\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 LocalCertificateFile=\"path-to-local-certificate-file\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 LocalCertificatePassword=\"local-certificate-password\"/>\n\u00a0\n\u00a0\n\u00a0\u00a0 <!-- ADFS -->\n\u00a0\u00a0 <PartnerIdentityProviders>\n\u00a0\u00a0\u00a0\u00a0\u00a0 <PartnerIdentityProvider Name=\"partner-identity-provider-name\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Description=\"PROACTIS AD\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 SignAuthnRequest=\"false\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 WantSAMLResponseSigned=\"false\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0WantAssertionSigned=\"true\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 WantAssertionEncrypted=\"true\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 PartnerCertificateFile=\"path-to-partner-certificate-file\"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ClockSkew=\"00:03:00\"\n\u00a0\u00a0\u00a0 \u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0SingleSignOnServiceUrl=\"single-sign-on-service-url\"/>\n\u00a0\u00a0 </PartnerIdentityProviders>\n\u00a0\n</SAMLConfiguration>   Add the following settings to your application.configuration file   <Setting Name=\"SSOAttributeName\">NameID</Setting>  The name of the attribute containing the user identifier in the attributes list returned from the ADFS server.\nIf not specified then no attribute lookup is made and user identification is based on the \u201cusername\u201d returned from the ADFS server.\n\u00a0  <Setting Name=\"SSOAttributeNameMask\"></Setting>  An optional mask to be applied to the above user identifier value.\n\u00a0  <Setting Name=\"SSOMatchP2PUserOnEmailAddress\">False</Setting>  By default, P2P searches the database Users table to find a user whose \u201cLoginID\u201d matches the identifier value returned from the ADFS server.\nThis optional setting will cause the lookup to be made on \u201cEmailAddress\u201d rather than \u201cLoginID\u201d\n\u00a0  <Setting Name=\"SSODatabaseTitle\"></Setting>  An optional setting that only applies when a user who is already logged into a 3rd party system, initiates a logon to P2P via SSO. In this scenario, the user is not \npresented with a logon page. If the user has access to multiple databases, then this setting specifies the database title (in the database xml file) to log into.\nIf this setting is not present, P2P will select the default database in the databases xml file (or the first database if no default).\nObviously if only one database is available, then this setting is unnecessary.",
            "title": "SAML2"
        },
        {
            "location": "/p2p/sso/#external",
            "text": "By default PROACTIS P2P validates the username and password entered by the user against the record in the  dsdba.Users  table.   It is however possible to customise PROACTIS so that users are validated against an external userstore such as LDAP.  The following steps should be followed in order to create an external validation DLL.    Create a new C# class library with a class called  Services  which implements the  ILogin  interface.  This interface can be found in  PROACTIS.P2P.grsCustInterfaces.DLL    Decide if your login process will be called asynchronously or not and implement the UseAsynchronousImplementation as required.        public bool UseAsynchronousImplementation => false;    Implement the  Login  (or  LoginAsync ) method with your custom validation code.  This method should return True for a successful login and False for a failure.  (For security reasons it is not possible to return messages informing the user why the login failed.  For example  the username does not exist )    Compile your code,  and ensure that the resulting DLL is named xyzLogin.DLL.   (xyz can be anything)    Copy the DLL into your  PROACTIS P2P/Plugins   (or  Plugins/[database-title] ) folder.    Add the following setting into your  applicationconfiguration.xml  file.    <Setting Name=\"AuthenticationMethod\">EXTERNAL</Setting>  See the  PROACTIS.ExampleApplications.ExternalLogin  example application for a complete sample implementation.   Note   In order to login using the external DLL,  the user must have their NTLogon property set to True  Failed login attempts aren't recorded",
            "title": "External"
        },
        {
            "location": "/p2p/sso/#bespoke",
            "text": "It is also possible to provide your users with a completely custom login process,  including replacing the login screen and adding the ability to automatically create users the first time they connect.  The process is to :    Create a custom page in your website's customer folder called  CustomLogin    Within that page collect any required details from the user and validate their credentials.    If the user entered valid details then log them on by:   First generating a unique token for them  Then writing the token to the  DSDBA.CustomLoginTokens  table.  Finally redirecting the user's browser to CustomLoginAsync within the main site.     To enable your new page to be used,  the following settings should be added to the  ApplicationConfiguration  file.    <Setting Name=\"AuthenticationMethod\">CUSTOM</Setting>\n<Setting Name=\"CustomLoginURL\">https://server/custom/CustomLogin.aspx</Setting>  Where  server  is the address of your core P2P website.  See these  example pages  for a complete sample.   Note  Upon exit from P2P, the browser will be redirected back to the custom login page with the following in the querystring  action=logout . If the custom logon page uses automated logins then it must take notice of this parameter to not automatically log the user back in again",
            "title": "Bespoke"
        },
        {
            "location": "/p2p/sso/#return-messages",
            "text": "Messages are return to the custom login page using the following query string format InfoMessages=XXX&AlertMessages=YYY&ErrorMessages=ZZZ  Where XXX, YYY and ZZZ are base64 encoded UNICODE strings. Each encoded string contains the messages concatenate with a \u201c|\u201d separator. (see sample app)\nThese entries will only be in the querystring if there are messages to return.",
            "title": "Return Messages"
        },
        {
            "location": "/p2p/punchout/",
            "text": "PunchOut\n\n\nOverview\n\n\nPunchOut allows a user to jump from the PROACTIS P2P website into a supplier\u2019s shopping site.  Where they can browse a catalogue and add items to a shopping basket as per a normal e-commerce site.  Once they have finished browsing they click checkout and the items are then returned to PROACTIS as new lines on their current purchase order (or requisition).\nFor the purposes of this document, the term PunchOut does not include the ability to electronically export purchase orders to suppliers in cXML format.\n\n\n\n\nNote\n\n\nThis document details how to configure connections to supplier PunchOut sites and marketplaces in the latest release of PROACTIS P2P `17.\nUnlike the previous versions it is now possible to configure the connections directly within the product.  Previously the setup action was carried out by a technical consultant which required the coding of bespoke webpages and sometimes DLLs for installation on the P2P server.\n\n\n\n\n\n\nPunchThro.\n\n\nThere are three different methods of configuring PunchOut within the PROACTIS P2P product.   This first is referred to as punch-thro.  This is where the buyer connects to the suppliers PunchOut site via the PROACTIS S2C portal. \n\n\nAs the details of the suppliers site are configured in the PROACTIS S2C Portal the only P2P settings required are as shown below\n\n\n\n\nConfigure the connection to your PROACTIS S2C portal.  (\nApplication\n -> \nPROACTIS Connectivity\n)\n\n\n\n\n\n\n\n\nEnable the PunchOut via portal setting against the supplier.\n\n\n\n\n\n\n\n\ncXML PunchOut\n\n\nThe majority of PunchOuts follow the \ncXML\n standard.  This can be configured directly within the P2P product by completing the following fields against a supplier.\n\n\n\n\n\n\nNote\n\n\n\n\nThe values for these 5 fields should be agreed with the supplier however DUNs numbers are often used for the three identities.\n\n\nThe fields can also be edited using the new WebPMC.\n\n\n\n\n\n\n\n\nOCI PunchOut\n\n\nLess commonly used in the UK, but PROACTIS also supports the \nOpen Catalog Interface\n (OCI) PunchOut standard.  Again this can be configured directly within the product by completing the following three fields.\n\n\n\n\n\n\nNote\n\n\nThe supplier will normally provide you with their URL and your sender identity and secret.\n\n\n\n\n\n\nPunchOut customisations\n\n\nIt is possible to customise PunchOut at various points within the process:\n\n\ncXML Handshake\n\n\nThe format of the cXML sent in the initial connection to the supplier\u2019s site is generated from an XML using an XSLT transformation.  By default PROACTIS uses an XSLT embedded within the product however it is possible to use your own xslt by creating a file within the plugins folder called \nPunchoutConnection_{supplierCode}.xslt\n.  Where \n{supplierCode}\n is the code of your supplier.\n\n\nThe fields which are available to the XSLT are listed below.\n\n\n\n\nContext\n\n\nSessionID\n\n\nSupplierCode\n\n\nDepartmentCode\n\n\nCompanyCode\n\n\nTemplateLabel\n\n\nLogonName\n\n\nActualName\n\n\nFirstName\n\n\nSurname\n\n\nEmail\n\n\nReturnURL\n\n\nURL\n\n\nBuyerCookie\n\n\nPayloadID\n\n\nTimestamp\n\n\nPunchoutFromIdentity\n\n\nPunchoutToIdentity\n\n\nPunchoutSenderIdentity\n\n\nPunchoutSenderSharedSecret\n\n\nDeliveryAddressGUID\n\n\nDeliveryAddressName\n\n\nDeliveryAddressLine1\n\n\nDeliveryAddressLine2\n\n\nDeliveryAddressLine3\n\n\nDeliveryAddressLine4\n\n\nDeliveryCountry\n\n\nDeliveryCounty\n\n\nDeliveryPostcode\n\n\nDeliveryPostTown\n\n\n\n\nAn example XSLT document is available \nhere\n.\n\n\ncXML & OCI Returned Basket\n\n\nWhen the basket is returned from the supplier by default it is transformed into the correct P2P format by using an XSLT embedded within the product.  This can be replaced by your own transform by creating a file in the plugins folder called \nReturnedPunchoutBasket_{supplierCode}.xslt\n Where \n{supplierCode}\n is the code of your supplier.\nThe XSLT must generate XML in the following format:\n\n\n<PurchaseOrder>\n  <PurchaseOrderHeader>\n    <SessionID></SessionID>\n    <Currency></Currency>\n    <TotalValue></TotalValue>\n  </PurchaseOrderHeader>\n  <PunchOutDetail>\n    <Item>\n      <Product></Product>\n      <Quantity></Quantity>\n      <Description></Description>\n      <UnitOfMeasure></UnitOfMeasure>\n      <UnitValue></UnitValue>\n      <Currency></Currency>\n      <UNSPSCCode></UNSPSCCode>\n      <Supplier></Supplier>\n      <References>\n        <Reference name=\"\"></Reference>\n      </References>\n    </Item>\n  </PunchOutDetail>\n</PurchaseOrder>\n\n\n\n\nAn example XSLT document is available \nhere\n.\n\n\nCustom Return Page\n\n\nBy default the supplier posts their basket back to either \nPunchoutReturned.aspx\n (for cxml) or \nPunchoutReturnedOCI.aspx\n (for oci).  It is however possible for you to provide your own page for processing the returned basket.  This is configured by completing the following field against the supplier record.\n\n\n\n\nThis page should be placed in the Customer folder within the website.\n\n\nThe default \nPunchoutReturned.aspx\n page looks for the basket xml in the following form fields:\n\n\n\n\nXML\n\n\ncxml-urlencode\n\n\ncxml-urlencoded\n\n\ncXML-base64\n\n\noracleCart\n\n\nthe first form field\n\n\n\n\nThe default \nPunchoutReturnedOCI.aspx\n page looks for the basket xml in the form fields as follows:\n\n\n\n\nThe items are returned in arrays of fields.  Indexed from 1 onwards\n\n\nFirst it checks there is a field called NEW_ITEM+DESCRIPTION[1].  If there isn\u2019t then it assumes that no basket items were returned.\n\n\nIt then loops through all fields which are named in the format NEW_xxxxx[n] where xxxxx is the name of a property and n is the item number.\n\n\nEach of these form fields are then added into the xml.  The result xml will have the following format:\n\n\n\n\n<PurchaseOrder>\n    <line number=1 item+description=\u2019red pen\u2019 etc etc />\n</PurchaseOrder>\n\n\n\n\nMarket Place\n\n\nPROACTIS P2P allows users to connect to a \u201cmarket place\u201d where they can then browse catalogues of one or more suppliers.  When they have finished browsing and click check-out then their returned basket is used to create one or more draft purchase orders (or requisitions) within PROACTIS.\nUnlike previous versions of PROACTIS it is now possible to configure marketplace connections directly within the product.\n\n\nConfiguration\n\n\nUsing the \u201cSystem Control\u201d application choose the Marketplaces option from the Supplier Maintenance menu.  Add a New market place and complete both the Details and PunchOut sections.\n\n\nThe following marketplace types (standards) are currently supported:\n\n\n\n\nCXML\n\n\nPROACTIS EGS\n\n\nProcserve\n\n\nScience warehouse\n\n\n\n\nThe Supplier Code Mapped From field specifies how the supplier code in the returned basket is mapped back to the suppliers within PROACTIS.\n\n\nCustomisation\n\n\nThe xml used for the initial connection is generated using an xslt embedded within the product.  It is possible to provide your own xslt by creating a file in the plugins folder called \nMarketPlaceConnection_{marketPlaceName}.xslt\n.  Where \n{marketPlaceName}\n is the name of the configured marketplace.\nThe fields passed into the xml are listed below:\n\n\n\n\nDepartmentCode\n\n\nCompanyCode\n\n\nLogonName\n\n\nEmail\n\n\nReturnURL\n\n\nURL\n\n\nBuyerCookie\n\n\nPayloadID\n\n\nTimestamp\n\n\nPunchoutFromIdentity\n\n\nPunchoutToIdentity\n\n\nPunchoutSenderIdentity\n\n\nPunchoutSenderSharedSecret\n\n\n\n\nWhen the basket is returned from the market place by default it is transformed into the correct format by using an XSLT embedded within the product.  It is possible to provide your own xslt by creating a file in the plugins folder called \nMarketPlaceResult_{marketPlaceName}.xslt\n.  Where \n{marketPlaceName}\n is the name of the configured marketplace.\nThe xslt needs to generate xml in the following format\n\n\n<PurchaseOrder>\n  <PurchaseOrderHeader>\n    <SessionID></SessionID>\n    <Currency></Currency>\n    <TotalValue></TotalValue>\n  </PurchaseOrderHeader>\n  <PunchOutDetail>\n    <Item>\n      <Product></Product>\n      <Quantity></Quantity>\n      <Description></Description>\n      <UnitOfMeasure></UnitOfMeasure>\n      <UnitValue></UnitValue>\n      <Currency></Currency>\n      <UNSPSCCode></UNSPSCCode>\n      <Supplier></Supplier>\n      <References>\n        <Reference name=\"\"></Reference>\n      </References>\n    </Item>\n  </PunchOutDetail>\n</PurchaseOrder>\n\n\n\n\nEGS Marketplaces\n\n\nThe EGS settings within the PROACTIS Connectivity snapin, do not refer to marketplace PunchOut.  This are used to configure different functionality not covered by this document.\n\n\nProxy Server\n\n\nConnections to both supplier PunchOut, and marketplaces honour the proxy server settings held in the \ndsdba.ProxySettings\n table.\nThis can be configured using the System Control application.",
            "title": "PunchOut / Marketplaces"
        },
        {
            "location": "/p2p/punchout/#punchout",
            "text": "",
            "title": "PunchOut"
        },
        {
            "location": "/p2p/punchout/#overview",
            "text": "PunchOut allows a user to jump from the PROACTIS P2P website into a supplier\u2019s shopping site.  Where they can browse a catalogue and add items to a shopping basket as per a normal e-commerce site.  Once they have finished browsing they click checkout and the items are then returned to PROACTIS as new lines on their current purchase order (or requisition).\nFor the purposes of this document, the term PunchOut does not include the ability to electronically export purchase orders to suppliers in cXML format.   Note  This document details how to configure connections to supplier PunchOut sites and marketplaces in the latest release of PROACTIS P2P `17.\nUnlike the previous versions it is now possible to configure the connections directly within the product.  Previously the setup action was carried out by a technical consultant which required the coding of bespoke webpages and sometimes DLLs for installation on the P2P server.",
            "title": "Overview"
        },
        {
            "location": "/p2p/punchout/#punchthro",
            "text": "There are three different methods of configuring PunchOut within the PROACTIS P2P product.   This first is referred to as punch-thro.  This is where the buyer connects to the suppliers PunchOut site via the PROACTIS S2C portal.   As the details of the suppliers site are configured in the PROACTIS S2C Portal the only P2P settings required are as shown below   Configure the connection to your PROACTIS S2C portal.  ( Application  ->  PROACTIS Connectivity )     Enable the PunchOut via portal setting against the supplier.",
            "title": "PunchThro."
        },
        {
            "location": "/p2p/punchout/#cxml-punchout",
            "text": "The majority of PunchOuts follow the  cXML  standard.  This can be configured directly within the P2P product by completing the following fields against a supplier.    Note   The values for these 5 fields should be agreed with the supplier however DUNs numbers are often used for the three identities.  The fields can also be edited using the new WebPMC.",
            "title": "cXML PunchOut"
        },
        {
            "location": "/p2p/punchout/#oci-punchout",
            "text": "Less commonly used in the UK, but PROACTIS also supports the  Open Catalog Interface  (OCI) PunchOut standard.  Again this can be configured directly within the product by completing the following three fields.    Note  The supplier will normally provide you with their URL and your sender identity and secret.",
            "title": "OCI PunchOut"
        },
        {
            "location": "/p2p/punchout/#punchout-customisations",
            "text": "It is possible to customise PunchOut at various points within the process:",
            "title": "PunchOut customisations"
        },
        {
            "location": "/p2p/punchout/#cxml-handshake",
            "text": "The format of the cXML sent in the initial connection to the supplier\u2019s site is generated from an XML using an XSLT transformation.  By default PROACTIS uses an XSLT embedded within the product however it is possible to use your own xslt by creating a file within the plugins folder called  PunchoutConnection_{supplierCode}.xslt .  Where  {supplierCode}  is the code of your supplier.  The fields which are available to the XSLT are listed below.   Context  SessionID  SupplierCode  DepartmentCode  CompanyCode  TemplateLabel  LogonName  ActualName  FirstName  Surname  Email  ReturnURL  URL  BuyerCookie  PayloadID  Timestamp  PunchoutFromIdentity  PunchoutToIdentity  PunchoutSenderIdentity  PunchoutSenderSharedSecret  DeliveryAddressGUID  DeliveryAddressName  DeliveryAddressLine1  DeliveryAddressLine2  DeliveryAddressLine3  DeliveryAddressLine4  DeliveryCountry  DeliveryCounty  DeliveryPostcode  DeliveryPostTown   An example XSLT document is available  here .",
            "title": "cXML Handshake"
        },
        {
            "location": "/p2p/punchout/#cxml-oci-returned-basket",
            "text": "When the basket is returned from the supplier by default it is transformed into the correct P2P format by using an XSLT embedded within the product.  This can be replaced by your own transform by creating a file in the plugins folder called  ReturnedPunchoutBasket_{supplierCode}.xslt  Where  {supplierCode}  is the code of your supplier.\nThe XSLT must generate XML in the following format:  <PurchaseOrder>\n  <PurchaseOrderHeader>\n    <SessionID></SessionID>\n    <Currency></Currency>\n    <TotalValue></TotalValue>\n  </PurchaseOrderHeader>\n  <PunchOutDetail>\n    <Item>\n      <Product></Product>\n      <Quantity></Quantity>\n      <Description></Description>\n      <UnitOfMeasure></UnitOfMeasure>\n      <UnitValue></UnitValue>\n      <Currency></Currency>\n      <UNSPSCCode></UNSPSCCode>\n      <Supplier></Supplier>\n      <References>\n        <Reference name=\"\"></Reference>\n      </References>\n    </Item>\n  </PunchOutDetail>\n</PurchaseOrder>  An example XSLT document is available  here .",
            "title": "cXML &amp; OCI Returned Basket"
        },
        {
            "location": "/p2p/punchout/#custom-return-page",
            "text": "By default the supplier posts their basket back to either  PunchoutReturned.aspx  (for cxml) or  PunchoutReturnedOCI.aspx  (for oci).  It is however possible for you to provide your own page for processing the returned basket.  This is configured by completing the following field against the supplier record.   This page should be placed in the Customer folder within the website.  The default  PunchoutReturned.aspx  page looks for the basket xml in the following form fields:   XML  cxml-urlencode  cxml-urlencoded  cXML-base64  oracleCart  the first form field   The default  PunchoutReturnedOCI.aspx  page looks for the basket xml in the form fields as follows:   The items are returned in arrays of fields.  Indexed from 1 onwards  First it checks there is a field called NEW_ITEM+DESCRIPTION[1].  If there isn\u2019t then it assumes that no basket items were returned.  It then loops through all fields which are named in the format NEW_xxxxx[n] where xxxxx is the name of a property and n is the item number.  Each of these form fields are then added into the xml.  The result xml will have the following format:   <PurchaseOrder>\n    <line number=1 item+description=\u2019red pen\u2019 etc etc />\n</PurchaseOrder>",
            "title": "Custom Return Page"
        },
        {
            "location": "/p2p/punchout/#market-place",
            "text": "PROACTIS P2P allows users to connect to a \u201cmarket place\u201d where they can then browse catalogues of one or more suppliers.  When they have finished browsing and click check-out then their returned basket is used to create one or more draft purchase orders (or requisitions) within PROACTIS.\nUnlike previous versions of PROACTIS it is now possible to configure marketplace connections directly within the product.",
            "title": "Market Place"
        },
        {
            "location": "/p2p/punchout/#configuration",
            "text": "Using the \u201cSystem Control\u201d application choose the Marketplaces option from the Supplier Maintenance menu.  Add a New market place and complete both the Details and PunchOut sections.  The following marketplace types (standards) are currently supported:   CXML  PROACTIS EGS  Procserve  Science warehouse   The Supplier Code Mapped From field specifies how the supplier code in the returned basket is mapped back to the suppliers within PROACTIS.",
            "title": "Configuration"
        },
        {
            "location": "/p2p/punchout/#customisation",
            "text": "The xml used for the initial connection is generated using an xslt embedded within the product.  It is possible to provide your own xslt by creating a file in the plugins folder called  MarketPlaceConnection_{marketPlaceName}.xslt .  Where  {marketPlaceName}  is the name of the configured marketplace.\nThe fields passed into the xml are listed below:   DepartmentCode  CompanyCode  LogonName  Email  ReturnURL  URL  BuyerCookie  PayloadID  Timestamp  PunchoutFromIdentity  PunchoutToIdentity  PunchoutSenderIdentity  PunchoutSenderSharedSecret   When the basket is returned from the market place by default it is transformed into the correct format by using an XSLT embedded within the product.  It is possible to provide your own xslt by creating a file in the plugins folder called  MarketPlaceResult_{marketPlaceName}.xslt .  Where  {marketPlaceName}  is the name of the configured marketplace.\nThe xslt needs to generate xml in the following format  <PurchaseOrder>\n  <PurchaseOrderHeader>\n    <SessionID></SessionID>\n    <Currency></Currency>\n    <TotalValue></TotalValue>\n  </PurchaseOrderHeader>\n  <PunchOutDetail>\n    <Item>\n      <Product></Product>\n      <Quantity></Quantity>\n      <Description></Description>\n      <UnitOfMeasure></UnitOfMeasure>\n      <UnitValue></UnitValue>\n      <Currency></Currency>\n      <UNSPSCCode></UNSPSCCode>\n      <Supplier></Supplier>\n      <References>\n        <Reference name=\"\"></Reference>\n      </References>\n    </Item>\n  </PunchOutDetail>\n</PurchaseOrder>",
            "title": "Customisation"
        },
        {
            "location": "/p2p/punchout/#egs-marketplaces",
            "text": "The EGS settings within the PROACTIS Connectivity snapin, do not refer to marketplace PunchOut.  This are used to configure different functionality not covered by this document.",
            "title": "EGS Marketplaces"
        },
        {
            "location": "/p2p/punchout/#proxy-server",
            "text": "Connections to both supplier PunchOut, and marketplaces honour the proxy server settings held in the  dsdba.ProxySettings  table.\nThis can be configured using the System Control application.",
            "title": "Proxy Server"
        },
        {
            "location": "/p2p/nominalvalidation/",
            "text": "Nominal Validation\n\n\nOverview\n\n\nThe core PROACTIS P2P product includes the functionality for complex nominal rules to be defined using the concept of nominal groups.\n\n\nIn some situations there might be a requirement to also validate the nominal coding entered against a purchase order line against an external source,  such as a finance system.\n\n\nIn a lot of cases this can be configured using the \nGeneric Nominal Validation\n snapin directly within the product.  This is the preferred approach as all the configuration is held within the database and the generic nominal validation module automatically provides extra features such as caching.\n\n\nIf \nGeneric Nominal Validation\n is not suitable for your needs then a custom DLL can be implemented providing you with complete control of the process.\n\n\n\n\nImplementation Steps\n\n\n\n\n\n\nCreate a new C# Class Library project called xyzNominalValidation. ( \nxyz\n can be anything)\n\n\n\n\n\n\nAdd a reference to \nPurchasing Server\\bin\\PROACTIS.P2P.grsCustInterfaces.dll\n\n\n\n\n\n\nAdd a class called \nServices\n which implements the \ngrsCustInterfaces.INominals\n interface.\n\n\n\n\n\n\nWrite an implementation of the \ngrsCustInterfaces.INominals.NominalCheck\n method.\n\n\n\n\n\n\nbool grsCustInterfaces.INominals.NominalCheck(string NominalsXML, string POXML, ref string ErrorNominals)\n\n\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nNominalsXML\n\n\nIn\n\n\nAn xml document containing the nominals which need to be validated.  This also includes details of the database,  company and user.\n\n\n\n\n\n\nPOXML\n\n\nIn\n\n\nAn xml document containing the entire purchase order to validate.  By default this argument is blank unless the company-wide setting is enabled.\n\n\n\n\n\n\nErrorNominals\n\n\nOut\n\n\nIf the nominals fail validation,  then you should return an xml document listing the failing nominals.\n\n\n\n\n\n\n\n\nReturn Value\n\n\nThe function should return True if all nominals are valid and False if one or more nominals are invalid.\n\n\nNominals XML\n\n\nBelow is an example of the xml passed to the \nNominalsXML\n argument.\n\n\n<grs:NominalCheck xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n    <grs:Database grs:Server=\"Develop07\" grs:DatabaseName=\"PROACTISIII\"/>\n\n    <grs:General grs:UserGUID=\"{02E0D6D9-B655-11D5-91D6-000629864A98}\" grs:CompanyGUID=\"{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}\"/>\n\n    <grs:Nominals>\n    <grs:Nominal grs:Coding=\"1720\" grs:Element1=\"1720\" grs:Element2=\"\" grs:Element3=\"\" grs:Element4=\"\" grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:El\n    ement8=\"\" grs:ValidNominal=\"False\"/>\n\n        <grs:Nominal grs:Coding=\"4744.1100\" grs:Element1=\"4744\" grs:Element2=\"1100\" grs:Element3=\"\" grs:Element4=\"\" grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:Element8=\"\" grs:ValidNominal=\"False\"/>\n    </grs:Nominals>\n</grs:NominalCheck>\n\n\n\n\nPOXML\n\n\n\n\nWarning\n\n\nThe POXML argument is populated with an xml document based on a internal product structure which may change over time from release to release.  It is recommended that you only extract information that you cannot obtain from elsewhere,  and also code defensively. \n\n\n\n\nError Nominals\n\n\nThe xml for the returned invalid nominals takes a similar structure to the NominalsXML argument.  For example:\n\n\n<grs:Nominals xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n   <grs:Nominal grs:Coding=\"1720\" grs:Element1=\"1720\" grs:Element2=\"\" grs:Element3=\"\" grs:Element4=\"\" grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:Element8=\"\" grs:ValidNominal=\"False\"/>\n   <grs:Nominal grs:Coding=\"4744.1100\" grs:Element1=\"4744\" grs:Element2=\"1100\" grs:Element3=\"\" grs:Element4=\"\" grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:Element8=\"\" grs:ValidNominal=\"False\"/>\n</grs:Nominals>\n\n\n\n\n\n\nExample\n\n\nSee the \nexample application\n for a complete implementation.\n\n\n\n\nDeployment\n\n\nYou dll should be complied (and named xyzNominalValidation.dll) and then copied into your \nPROACTIS P2P/Plugins\n  (or \nPlugins/[database-title]\n) folder.",
            "title": "Nominal Validation"
        },
        {
            "location": "/p2p/nominalvalidation/#nominal-validation",
            "text": "",
            "title": "Nominal Validation"
        },
        {
            "location": "/p2p/nominalvalidation/#overview",
            "text": "The core PROACTIS P2P product includes the functionality for complex nominal rules to be defined using the concept of nominal groups.  In some situations there might be a requirement to also validate the nominal coding entered against a purchase order line against an external source,  such as a finance system.  In a lot of cases this can be configured using the  Generic Nominal Validation  snapin directly within the product.  This is the preferred approach as all the configuration is held within the database and the generic nominal validation module automatically provides extra features such as caching.  If  Generic Nominal Validation  is not suitable for your needs then a custom DLL can be implemented providing you with complete control of the process.",
            "title": "Overview"
        },
        {
            "location": "/p2p/nominalvalidation/#implementation-steps",
            "text": "Create a new C# Class Library project called xyzNominalValidation. (  xyz  can be anything)    Add a reference to  Purchasing Server\\bin\\PROACTIS.P2P.grsCustInterfaces.dll    Add a class called  Services  which implements the  grsCustInterfaces.INominals  interface.    Write an implementation of the  grsCustInterfaces.INominals.NominalCheck  method.    bool grsCustInterfaces.INominals.NominalCheck(string NominalsXML, string POXML, ref string ErrorNominals)",
            "title": "Implementation Steps"
        },
        {
            "location": "/p2p/nominalvalidation/#arguments",
            "text": "Argument  Direction  Description      NominalsXML  In  An xml document containing the nominals which need to be validated.  This also includes details of the database,  company and user.    POXML  In  An xml document containing the entire purchase order to validate.  By default this argument is blank unless the company-wide setting is enabled.    ErrorNominals  Out  If the nominals fail validation,  then you should return an xml document listing the failing nominals.",
            "title": "Arguments"
        },
        {
            "location": "/p2p/nominalvalidation/#return-value",
            "text": "The function should return True if all nominals are valid and False if one or more nominals are invalid.",
            "title": "Return Value"
        },
        {
            "location": "/p2p/nominalvalidation/#nominals-xml",
            "text": "Below is an example of the xml passed to the  NominalsXML  argument.  <grs:NominalCheck xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n    <grs:Database grs:Server=\"Develop07\" grs:DatabaseName=\"PROACTISIII\"/>\n\n    <grs:General grs:UserGUID=\"{02E0D6D9-B655-11D5-91D6-000629864A98}\" grs:CompanyGUID=\"{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}\"/>\n\n    <grs:Nominals>\n    <grs:Nominal grs:Coding=\"1720\" grs:Element1=\"1720\" grs:Element2=\"\" grs:Element3=\"\" grs:Element4=\"\" grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:El\n    ement8=\"\" grs:ValidNominal=\"False\"/>\n\n        <grs:Nominal grs:Coding=\"4744.1100\" grs:Element1=\"4744\" grs:Element2=\"1100\" grs:Element3=\"\" grs:Element4=\"\" grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:Element8=\"\" grs:ValidNominal=\"False\"/>\n    </grs:Nominals>\n</grs:NominalCheck>",
            "title": "Nominals XML"
        },
        {
            "location": "/p2p/nominalvalidation/#poxml",
            "text": "Warning  The POXML argument is populated with an xml document based on a internal product structure which may change over time from release to release.  It is recommended that you only extract information that you cannot obtain from elsewhere,  and also code defensively.",
            "title": "POXML"
        },
        {
            "location": "/p2p/nominalvalidation/#error-nominals",
            "text": "The xml for the returned invalid nominals takes a similar structure to the NominalsXML argument.  For example:  <grs:Nominals xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n   <grs:Nominal grs:Coding=\"1720\" grs:Element1=\"1720\" grs:Element2=\"\" grs:Element3=\"\" grs:Element4=\"\" grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:Element8=\"\" grs:ValidNominal=\"False\"/>\n   <grs:Nominal grs:Coding=\"4744.1100\" grs:Element1=\"4744\" grs:Element2=\"1100\" grs:Element3=\"\" grs:Element4=\"\" grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:Element8=\"\" grs:ValidNominal=\"False\"/>\n</grs:Nominals>",
            "title": "Error Nominals"
        },
        {
            "location": "/p2p/nominalvalidation/#example",
            "text": "See the  example application  for a complete implementation.",
            "title": "Example"
        },
        {
            "location": "/p2p/nominalvalidation/#deployment",
            "text": "You dll should be complied (and named xyzNominalValidation.dll) and then copied into your  PROACTIS P2P/Plugins   (or  Plugins/[database-title] ) folder.",
            "title": "Deployment"
        },
        {
            "location": "/p2p/budgetchecking/",
            "text": "Budget Checking\n\n\nOverview\n\n\nPROACTIS P2P allows budgets to be checking against an external source when a purchase order is being submitted.\n\n\nThe preferred method is to configure budget checking using the \nGeneric Budget Checking\n snapin and the module keeps all the settings in the P2P database and automatically provides additional functions such as caching.\n\n\n\n\nCustom DLL\n\n\nTo write a custom budget checking DLL,  the following methods must be implemented.\n\n\n\n\n\n\nCommitmentCheck\n\nGiven a set of nominal lines from a purchase order returns False if at least one line on the order has failed budget checking\n\n\n\n\n\n\nCommitmentReport\n\nGiven a set of nominal lines from a purchase order returns a custom table showing the available funds calculation for each.  For example the table might have columns for Original Budget,  Spend To Date,  Accruals and Remaining Budget.\n\n\n\n\n\n\nGetOverspend\n\nGiven a set of nominal lines from a purchase order returns the total amount that the document exceeds the available budget.   This figure can be used in your authorisation workflow to route an document to the correct approver.\n\n\n\n\n\n\n\n\nNote\n\n\nYou are not required to implement the \nGetOverspend\n method but it is recommended.\n\n\n\n\n\n\nImplementation\n\n\n\n\n\n\nCreate a new C# Class Library project called xyzBudgetChecking. ( \nxyz\n can be anything)\n\n\n\n\n\n\nAdd a reference to \nPurchasing Server\\bin\\PROACTIS.P2P.grsCustInterfaces.dll\n\n\n\n\n\n\nAdd a class called \nServices\n which implements the \ngrsCustInterfaces.IOverSpend\n and \ngrsCustInterfaces.ICustCommit\n interfaces.\n\n\n\n\n\n\nWrite an implementation of the \ngrsCustInterfaces.ICustCommit.CommitmentCheck\n method.\n\n\n\n\n\n\nbool grsCustInterfaces.ICustCommit.CommitmentCheck(string NominalsXML, string POXML)\n\n\n\n\n\n\nWrite an implementation of the \ngrsCustInterfaces.ICustCommit.CommitmentReport\n method.\n\n\n\n\nstring grsCustInterfaces.ICustCommit.CommitmentReport(string NominalsXML, string POXML)\n\n\n\n\n\n\n(Optionally) Write an implementation of the \ngrsCustInterfaces.IOverSpend.GetOverspend\n method.\n\n\n\n\ndecimal grsCustInterfaces.IOverSpend.GetOverspend(string NominalsXML, string POXML)\n\n\n\n\n\n\nICustCommit.CommitmentCheck\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nNominalsXML\n\n\nIn\n\n\nAn xml document containing the nominals which need to be budget checked.  This also includes details of the database,  company and user.\n\n\n\n\n\n\nPOXML\n\n\nIn\n\n\nAn xml document containing the entire purchase order to check.  By default this argument is blank unless the company-wide setting is enabled.\n\n\n\n\n\n\n\n\nReturn Value\n\n\nThe function should return True if all the lines pass budget checking and False if at least one line fails the check.\n\n\nNominals XML\n\n\nBelow is an example of the xml passed to the \nNominalsXML\n argument.\n\n\n<grs:CommitmentLookup xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n<grs:Database grs:Server=\"localhost\" grs:DatabaseName=\"PROACTIS\" />\n<grs:General grs:UserGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" grs:CompanyGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" />\n<grs:Currencies><grs:Currency grs:CurrencyGUID=\"{2E67C438-9012-415B-AED4-8809F0012A78}\" grs:Status=\"H1\" grs:Symbol=\"\u00a3\" grs:DecimalPlaces=\"2\" /></grs:Currencies>\n\n<grs:NominalPeriods>\n    <grs:NominalPeriod grs:Year=\"2017\" grs:Period=\"1\" grs:YearPeriodGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" grs:Value=\"120.12\" \n    grs:Home1Value=\"120.12\" grs:Home2Value=\"120.12\" grs:NonRecoverableTax=\"0\" grs:NonRecoverableTaxHome1=\"0\" grs:NonRecoverableTaxHome2=\"0\">\n        <grs:Nominal grs:Coding=\"SALES.CONF.MARKET\" grs:Element1=\"SALES\" grs:Element2=\"CONF\" grs:Element3=\"MARKET\" grs:Element4=\"\" \n        grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:Element8=\"\"></grs:Nominal>\n    </grs:NominalPeriod>\n</grs:NominalPeriods>\n\n</grs:CommitmentLookup>\n\n\n\n\nThe \nNominalPeriods\n element is repeated for each nominal line on the purchase order.\n\n\n\n\nWarning\n\n\nThe POXML argument is populated with an xml document based on a internal product structure which may change over time from release to release.  It is recommended that you only extract information that you cannot obtain from elsewhere,  and also code defensively. \n\n\n\n\n\n\nICustCommit.CommitmentReport\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nNominalsXML\n\n\nIn\n\n\nAn xml document containing the nominals which need to be budget checked.  This also includes details of the database,  company and user.\n\n\n\n\n\n\nPOXML\n\n\nIn\n\n\nAn xml document containing the entire purchase order to check.  By default this argument is blank unless the company-wide setting is enabled.\n\n\n\n\n\n\n\n\nReturn Value\n\n\nThe function should return a table (in xml format) which describes the budget calculation for each line on the order.\n\n\nNominals XML\n\n\nBelow is an example of the xml passed to the \nNominalsXML\n argument.\n\n\n<grs:CommitmentLookup xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n<grs:Database grs:Server=\"localhost\" grs:DatabaseName=\"PROACTIS\" />\n<grs:General grs:UserGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" grs:CompanyGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" />\n<grs:Currencies><grs:Currency grs:CurrencyGUID=\"{2E67C438-9012-415B-AED4-8809F0012A78}\" grs:Status=\"H1\" grs:Symbol=\"\u00a3\" grs:DecimalPlaces=\"2\" /></grs:Currencies>\n\n<grs:NominalPeriods>\n    <grs:NominalPeriod grs:Year=\"2017\" grs:Period=\"1\" grs:YearPeriodGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" grs:Value=\"120.12\" \n    grs:Home1Value=\"120.12\" grs:Home2Value=\"120.12\" grs:NonRecoverableTax=\"0\" grs:NonRecoverableTaxHome1=\"0\" grs:NonRecoverableTaxHome2=\"0\">\n        <grs:Nominal grs:Coding=\"SALES.CONF.MARKET\" grs:Element1=\"SALES\" grs:Element2=\"CONF\" grs:Element3=\"MARKET\" grs:Element4=\"\" \n        grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:Element8=\"\"></grs:Nominal>\n    </grs:NominalPeriod>\n</grs:NominalPeriods>\n\n</grs:CommitmentLookup>\n\n\n\n\nThe \nNominalPeriods\n element is repeated for each nominal line on the purchase order.\n\n\n\n\nWarning\n\n\nThe POXML argument is populated with an xml document based on a internal product structure which may change over time from release to release.  It is recommended that you only extract information that you cannot obtain from elsewhere,  and also code defensively. \n\n\n\n\nReturned XML\n\n\nThe function needs to return XML with the following structure\n\n\n<grs:HeadedList xmlns:grs='http://www.getrealsystems.com/xml/xml-ns'>\n\n<grs:Headings>\n    <grs:Column grs:Number='1' grs:Type=''          grs:BudgetType=''>Nominal Coding</grs:Column>\n    <grs:Column grs:Number='2' grs:Type='Currency'  grs:BudgetType='Budget'>Budget For Year</grs:Column>\n    <grs:Column grs:Number='3' grs:Type='Currency'  grs:BudgetType='Cost'>Spend To Date</grs:Column>\n    <grs:Column grs:Number='4' grs:Type='Currency'  grs:BudgetType='Cost'>Accruals</grs:Column>\n    <grs:Column grs:Number='5' grs:Type='Currency'  grs:BudgetType='Cost'>This Document</grs:Column>\n    <grs:Column grs:Number='6' grs:Type='Currency'  grs:BudgetType=''>Remaining Budget</grs:Column>\n    <grs:Column grs:Number='7' grs:Type='Highlight' grs:BudgetType=''>Highlight</grs:Column>\n</grs:Headings>\n\n<grs:Items>\n    <grs:Item grs:GUID='{3A8D2AC2-6287-41DF-817A-F77B0551D80D}' >\n        <grs:Column grs:Number='1' grs:Type='Standard'>SALES.CONF.MARKETING</grs:Column>\n        <grs:Column grs:Number='2' grs:CurrencySymbol='\u00a3' grs:DecimalPlaces='0' grs:Type='Currency'>100000</grs:Column>\n        <grs:Column grs:Number='3' grs:CurrencySymbol='\u00a3' grs:DecimalPlaces='0' grs:Type='Currency'>60000</grs:Column>\n        <grs:Column grs:Number='4' grs:CurrencySymbol='\u00a3' grs:DecimalPlaces='0' grs:Type='Currency' Hyperlink='/CommitmentReport.html'>50000</grs:Column>\n        <grs:Column grs:Number='5' grs:CurrencySymbol='\u00a3' grs:DecimalPlaces='0' grs:Type='Currency'>20000</grs:Column>\n        <grs:Column grs:Number='6' grs:CurrencySymbol='\u00a3' grs:DecimalPlaces='0' grs:Type='Currency'>-10000</grs:Column>\n        <grs:Column grs:Number='7' grs:Type='Highlight'>true</grs:Column>\n    </grs:Item>\n</grs:Items>\n\n</grs:HeadedList>\n\n\n\n\n\n\nNote\n\n\n\n\n\n\nYou need to define one \ngrs:Column\n element for each column you wish to appear in the commitment report.\n\n\n\n\nThe grs:Number attribute should sequentially number the columns 1...\n\n\nThe grs:Type attribute can be \"\" (blank),  Currency (for a monetary value) or Highlight (failure indicator)\n\n\nThe grs:BudgetType columns is used by the budget graphic.  It can be \"\" (blank),  Budget or Cost  \n\n\n\n\n\n\n\n\nYou need to add one \ngrs:Item\n for each line that you wish to appear on the report.  Within each \nItem\n element a \nColumn\n element must be added for each column you defined in the \nHeadings\n element.\n\n\n\n\nThe grs:Number attribute should match the number of the column.\n\n\nThe grs:Type attribute can be \"\" (blank),  Currency (for a monetary value) or Highlight (failure indicator)\n\n\nIf the Type is currency,  then the CurrencySymbol and DecimalPlaces attributes should also be provided\n\n\nOptionally a hyperlink attribute can be provided.  The renders the value as an HTML 'a' link.\n\n\n\n\n\n\n\n\n\n\nIOverSpend.GetOverspend\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nNominalsXML\n\n\nIn\n\n\nAn xml document containing the nominals which need to be budget checked.  This also includes details of the database,  company and user.\n\n\n\n\n\n\nPOXML\n\n\nIn\n\n\nAn xml document containing the entire purchase order to check.  By default this argument is blank unless the company-wide setting is enabled.\n\n\n\n\n\n\n\n\nReturn Value\n\n\nThe function should return the total amount (as a decimal) that the lines on the order exceed their budget.  For example if the first line exceeded by \u00a310 and the second by \u00a320 then you should return 30.\n\n\nNominals XML\n\n\nBelow is an example of the xml passed to the \nNominalsXML\n argument.\n\n\n<grs:CommitmentLookup xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n<grs:Database grs:Server=\"localhost\" grs:DatabaseName=\"PROACTIS\" />\n<grs:General grs:UserGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" grs:CompanyGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" />\n<grs:Currencies><grs:Currency grs:CurrencyGUID=\"{2E67C438-9012-415B-AED4-8809F0012A78}\" grs:Status=\"H1\" grs:Symbol=\"\u00a3\" grs:DecimalPlaces=\"2\" /></grs:Currencies>\n\n<grs:NominalPeriods>\n    <grs:NominalPeriod grs:Year=\"2017\" grs:Period=\"1\" grs:YearPeriodGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" grs:Value=\"120.12\" \n    grs:Home1Value=\"120.12\" grs:Home2Value=\"120.12\" grs:NonRecoverableTax=\"0\" grs:NonRecoverableTaxHome1=\"0\" grs:NonRecoverableTaxHome2=\"0\">\n        <grs:Nominal grs:Coding=\"SALES.CONF.MARKET\" grs:Element1=\"SALES\" grs:Element2=\"CONF\" grs:Element3=\"MARKET\" grs:Element4=\"\" \n        grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:Element8=\"\"></grs:Nominal>\n    </grs:NominalPeriod>\n</grs:NominalPeriods>\n\n\n\n\n\n\nWarning\n\n\nThe POXML argument is populated with an xml document based on a internal product structure which may change over time from release to release.  It is recommended that you only extract information that you cannot obtain from elsewhere,  and also code defensively. \n\n\n\n\n\n\nExample\n\n\nSee the \nexample application\n for a complete implementation.\n\n\n\n\nDeployment\n\n\nYou dll should be complied (and named xyzBudgetChecking.dll) and then copied into your \nPROACTIS P2P/Plugins\n  (or \nPlugins/[database-title]\n) folder.",
            "title": "Budget Checking"
        },
        {
            "location": "/p2p/budgetchecking/#budget-checking",
            "text": "",
            "title": "Budget Checking"
        },
        {
            "location": "/p2p/budgetchecking/#overview",
            "text": "PROACTIS P2P allows budgets to be checking against an external source when a purchase order is being submitted.  The preferred method is to configure budget checking using the  Generic Budget Checking  snapin and the module keeps all the settings in the P2P database and automatically provides additional functions such as caching.",
            "title": "Overview"
        },
        {
            "location": "/p2p/budgetchecking/#custom-dll",
            "text": "To write a custom budget checking DLL,  the following methods must be implemented.    CommitmentCheck \nGiven a set of nominal lines from a purchase order returns False if at least one line on the order has failed budget checking    CommitmentReport \nGiven a set of nominal lines from a purchase order returns a custom table showing the available funds calculation for each.  For example the table might have columns for Original Budget,  Spend To Date,  Accruals and Remaining Budget.    GetOverspend \nGiven a set of nominal lines from a purchase order returns the total amount that the document exceeds the available budget.   This figure can be used in your authorisation workflow to route an document to the correct approver.     Note  You are not required to implement the  GetOverspend  method but it is recommended.",
            "title": "Custom DLL"
        },
        {
            "location": "/p2p/budgetchecking/#implementation",
            "text": "Create a new C# Class Library project called xyzBudgetChecking. (  xyz  can be anything)    Add a reference to  Purchasing Server\\bin\\PROACTIS.P2P.grsCustInterfaces.dll    Add a class called  Services  which implements the  grsCustInterfaces.IOverSpend  and  grsCustInterfaces.ICustCommit  interfaces.    Write an implementation of the  grsCustInterfaces.ICustCommit.CommitmentCheck  method.    bool grsCustInterfaces.ICustCommit.CommitmentCheck(string NominalsXML, string POXML)   Write an implementation of the  grsCustInterfaces.ICustCommit.CommitmentReport  method.   string grsCustInterfaces.ICustCommit.CommitmentReport(string NominalsXML, string POXML)   (Optionally) Write an implementation of the  grsCustInterfaces.IOverSpend.GetOverspend  method.   decimal grsCustInterfaces.IOverSpend.GetOverspend(string NominalsXML, string POXML)",
            "title": "Implementation"
        },
        {
            "location": "/p2p/budgetchecking/#icustcommitcommitmentcheck",
            "text": "",
            "title": "ICustCommit.CommitmentCheck"
        },
        {
            "location": "/p2p/budgetchecking/#arguments",
            "text": "Argument  Direction  Description      NominalsXML  In  An xml document containing the nominals which need to be budget checked.  This also includes details of the database,  company and user.    POXML  In  An xml document containing the entire purchase order to check.  By default this argument is blank unless the company-wide setting is enabled.",
            "title": "Arguments"
        },
        {
            "location": "/p2p/budgetchecking/#return-value",
            "text": "The function should return True if all the lines pass budget checking and False if at least one line fails the check.",
            "title": "Return Value"
        },
        {
            "location": "/p2p/budgetchecking/#nominals-xml",
            "text": "Below is an example of the xml passed to the  NominalsXML  argument.  <grs:CommitmentLookup xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n<grs:Database grs:Server=\"localhost\" grs:DatabaseName=\"PROACTIS\" />\n<grs:General grs:UserGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" grs:CompanyGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" />\n<grs:Currencies><grs:Currency grs:CurrencyGUID=\"{2E67C438-9012-415B-AED4-8809F0012A78}\" grs:Status=\"H1\" grs:Symbol=\"\u00a3\" grs:DecimalPlaces=\"2\" /></grs:Currencies>\n\n<grs:NominalPeriods>\n    <grs:NominalPeriod grs:Year=\"2017\" grs:Period=\"1\" grs:YearPeriodGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" grs:Value=\"120.12\" \n    grs:Home1Value=\"120.12\" grs:Home2Value=\"120.12\" grs:NonRecoverableTax=\"0\" grs:NonRecoverableTaxHome1=\"0\" grs:NonRecoverableTaxHome2=\"0\">\n        <grs:Nominal grs:Coding=\"SALES.CONF.MARKET\" grs:Element1=\"SALES\" grs:Element2=\"CONF\" grs:Element3=\"MARKET\" grs:Element4=\"\" \n        grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:Element8=\"\"></grs:Nominal>\n    </grs:NominalPeriod>\n</grs:NominalPeriods>\n\n</grs:CommitmentLookup>  The  NominalPeriods  element is repeated for each nominal line on the purchase order.   Warning  The POXML argument is populated with an xml document based on a internal product structure which may change over time from release to release.  It is recommended that you only extract information that you cannot obtain from elsewhere,  and also code defensively.",
            "title": "Nominals XML"
        },
        {
            "location": "/p2p/budgetchecking/#icustcommitcommitmentreport",
            "text": "",
            "title": "ICustCommit.CommitmentReport"
        },
        {
            "location": "/p2p/budgetchecking/#arguments_1",
            "text": "Argument  Direction  Description      NominalsXML  In  An xml document containing the nominals which need to be budget checked.  This also includes details of the database,  company and user.    POXML  In  An xml document containing the entire purchase order to check.  By default this argument is blank unless the company-wide setting is enabled.",
            "title": "Arguments"
        },
        {
            "location": "/p2p/budgetchecking/#return-value_1",
            "text": "The function should return a table (in xml format) which describes the budget calculation for each line on the order.",
            "title": "Return Value"
        },
        {
            "location": "/p2p/budgetchecking/#nominals-xml_1",
            "text": "Below is an example of the xml passed to the  NominalsXML  argument.  <grs:CommitmentLookup xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n<grs:Database grs:Server=\"localhost\" grs:DatabaseName=\"PROACTIS\" />\n<grs:General grs:UserGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" grs:CompanyGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" />\n<grs:Currencies><grs:Currency grs:CurrencyGUID=\"{2E67C438-9012-415B-AED4-8809F0012A78}\" grs:Status=\"H1\" grs:Symbol=\"\u00a3\" grs:DecimalPlaces=\"2\" /></grs:Currencies>\n\n<grs:NominalPeriods>\n    <grs:NominalPeriod grs:Year=\"2017\" grs:Period=\"1\" grs:YearPeriodGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" grs:Value=\"120.12\" \n    grs:Home1Value=\"120.12\" grs:Home2Value=\"120.12\" grs:NonRecoverableTax=\"0\" grs:NonRecoverableTaxHome1=\"0\" grs:NonRecoverableTaxHome2=\"0\">\n        <grs:Nominal grs:Coding=\"SALES.CONF.MARKET\" grs:Element1=\"SALES\" grs:Element2=\"CONF\" grs:Element3=\"MARKET\" grs:Element4=\"\" \n        grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:Element8=\"\"></grs:Nominal>\n    </grs:NominalPeriod>\n</grs:NominalPeriods>\n\n</grs:CommitmentLookup>  The  NominalPeriods  element is repeated for each nominal line on the purchase order.   Warning  The POXML argument is populated with an xml document based on a internal product structure which may change over time from release to release.  It is recommended that you only extract information that you cannot obtain from elsewhere,  and also code defensively.",
            "title": "Nominals XML"
        },
        {
            "location": "/p2p/budgetchecking/#returned-xml",
            "text": "The function needs to return XML with the following structure  <grs:HeadedList xmlns:grs='http://www.getrealsystems.com/xml/xml-ns'>\n\n<grs:Headings>\n    <grs:Column grs:Number='1' grs:Type=''          grs:BudgetType=''>Nominal Coding</grs:Column>\n    <grs:Column grs:Number='2' grs:Type='Currency'  grs:BudgetType='Budget'>Budget For Year</grs:Column>\n    <grs:Column grs:Number='3' grs:Type='Currency'  grs:BudgetType='Cost'>Spend To Date</grs:Column>\n    <grs:Column grs:Number='4' grs:Type='Currency'  grs:BudgetType='Cost'>Accruals</grs:Column>\n    <grs:Column grs:Number='5' grs:Type='Currency'  grs:BudgetType='Cost'>This Document</grs:Column>\n    <grs:Column grs:Number='6' grs:Type='Currency'  grs:BudgetType=''>Remaining Budget</grs:Column>\n    <grs:Column grs:Number='7' grs:Type='Highlight' grs:BudgetType=''>Highlight</grs:Column>\n</grs:Headings>\n\n<grs:Items>\n    <grs:Item grs:GUID='{3A8D2AC2-6287-41DF-817A-F77B0551D80D}' >\n        <grs:Column grs:Number='1' grs:Type='Standard'>SALES.CONF.MARKETING</grs:Column>\n        <grs:Column grs:Number='2' grs:CurrencySymbol='\u00a3' grs:DecimalPlaces='0' grs:Type='Currency'>100000</grs:Column>\n        <grs:Column grs:Number='3' grs:CurrencySymbol='\u00a3' grs:DecimalPlaces='0' grs:Type='Currency'>60000</grs:Column>\n        <grs:Column grs:Number='4' grs:CurrencySymbol='\u00a3' grs:DecimalPlaces='0' grs:Type='Currency' Hyperlink='/CommitmentReport.html'>50000</grs:Column>\n        <grs:Column grs:Number='5' grs:CurrencySymbol='\u00a3' grs:DecimalPlaces='0' grs:Type='Currency'>20000</grs:Column>\n        <grs:Column grs:Number='6' grs:CurrencySymbol='\u00a3' grs:DecimalPlaces='0' grs:Type='Currency'>-10000</grs:Column>\n        <grs:Column grs:Number='7' grs:Type='Highlight'>true</grs:Column>\n    </grs:Item>\n</grs:Items>\n\n</grs:HeadedList>   Note    You need to define one  grs:Column  element for each column you wish to appear in the commitment report.   The grs:Number attribute should sequentially number the columns 1...  The grs:Type attribute can be \"\" (blank),  Currency (for a monetary value) or Highlight (failure indicator)  The grs:BudgetType columns is used by the budget graphic.  It can be \"\" (blank),  Budget or Cost       You need to add one  grs:Item  for each line that you wish to appear on the report.  Within each  Item  element a  Column  element must be added for each column you defined in the  Headings  element.   The grs:Number attribute should match the number of the column.  The grs:Type attribute can be \"\" (blank),  Currency (for a monetary value) or Highlight (failure indicator)  If the Type is currency,  then the CurrencySymbol and DecimalPlaces attributes should also be provided  Optionally a hyperlink attribute can be provided.  The renders the value as an HTML 'a' link.",
            "title": "Returned XML"
        },
        {
            "location": "/p2p/budgetchecking/#ioverspendgetoverspend",
            "text": "",
            "title": "IOverSpend.GetOverspend"
        },
        {
            "location": "/p2p/budgetchecking/#arguments_2",
            "text": "Argument  Direction  Description      NominalsXML  In  An xml document containing the nominals which need to be budget checked.  This also includes details of the database,  company and user.    POXML  In  An xml document containing the entire purchase order to check.  By default this argument is blank unless the company-wide setting is enabled.",
            "title": "Arguments"
        },
        {
            "location": "/p2p/budgetchecking/#return-value_2",
            "text": "The function should return the total amount (as a decimal) that the lines on the order exceed their budget.  For example if the first line exceeded by \u00a310 and the second by \u00a320 then you should return 30.",
            "title": "Return Value"
        },
        {
            "location": "/p2p/budgetchecking/#nominals-xml_2",
            "text": "Below is an example of the xml passed to the  NominalsXML  argument.  <grs:CommitmentLookup xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n<grs:Database grs:Server=\"localhost\" grs:DatabaseName=\"PROACTIS\" />\n<grs:General grs:UserGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" grs:CompanyGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" />\n<grs:Currencies><grs:Currency grs:CurrencyGUID=\"{2E67C438-9012-415B-AED4-8809F0012A78}\" grs:Status=\"H1\" grs:Symbol=\"\u00a3\" grs:DecimalPlaces=\"2\" /></grs:Currencies>\n\n<grs:NominalPeriods>\n    <grs:NominalPeriod grs:Year=\"2017\" grs:Period=\"1\" grs:YearPeriodGUID=\"{3A8D2AC2-6287-41DF-817A-F77B0551D80D}\" grs:Value=\"120.12\" \n    grs:Home1Value=\"120.12\" grs:Home2Value=\"120.12\" grs:NonRecoverableTax=\"0\" grs:NonRecoverableTaxHome1=\"0\" grs:NonRecoverableTaxHome2=\"0\">\n        <grs:Nominal grs:Coding=\"SALES.CONF.MARKET\" grs:Element1=\"SALES\" grs:Element2=\"CONF\" grs:Element3=\"MARKET\" grs:Element4=\"\" \n        grs:Element5=\"\" grs:Element6=\"\" grs:Element7=\"\" grs:Element8=\"\"></grs:Nominal>\n    </grs:NominalPeriod>\n</grs:NominalPeriods>   Warning  The POXML argument is populated with an xml document based on a internal product structure which may change over time from release to release.  It is recommended that you only extract information that you cannot obtain from elsewhere,  and also code defensively.",
            "title": "Nominals XML"
        },
        {
            "location": "/p2p/budgetchecking/#example",
            "text": "See the  example application  for a complete implementation.",
            "title": "Example"
        },
        {
            "location": "/p2p/budgetchecking/#deployment",
            "text": "You dll should be complied (and named xyzBudgetChecking.dll) and then copied into your  PROACTIS P2P/Plugins   (or  Plugins/[database-title] ) folder.",
            "title": "Deployment"
        },
        {
            "location": "/p2p/customtab/",
            "text": "Custom Tab\n\n\nThe P2P website can be extended by creating additional \"custom\" tabs.  \n\n\n\n\nLicence File\n\n\nIn order to display a custom tab you will first need a licence file which includes the name of the tab.  \n\n\n\n\n\n\nNote\n\n\nPlease contact your account manager for assistance with this.\n\n\n\n\nIn this example the tab will be displayed as  \nManage Resource Bookings\n and will only be visible to users with the \nMAY_BOOK_RESOURCES\n user role.\n\n\n \n\n\n\n\nDevelopment\n\n\nCustom tab are developed as independent websites which are then displayed as part of the core site within an iFrame.\n\n\n\n\nIn the screenshot above,  the blue menu bar comes from the main site,  whilst the remainder of the page (in white) is the custom tab.\n\n\nBy convention the custom sites are placed within the \nWebSite\\Customer\n folder and are mapped as a virtual application with in IIS.   \n\n\n\n\nIn order for P2P to know the URL of the page is displayed it's path needs to be added to the \nApplicationConfig.xml\n file.\n\n\n \n\n\n\n\nWarning\n\n\nAfter changing the application configuration file the caches in the website will need refreshing.   This can be done either by recycling the application pool,  or by performing an IIS reset.\n\n\n\n\n\n\nSession Details\n\n\nAs the custom tab is running in a different website to the main site it is not possible to share the session state within IIS.\n\n\nInstead the following steps must be followed in order to obtain the details of the current user.\n\n\n\n\n\n\nBefore the main site opens your landing page it first generates a unique session token which is stored in the database within the \ndsdba.LoginTokens\n table.  This table also holds who the current user is. \n\n\n\n\n\n\nWhen the landing page is opened,  it is passed the following information as query string parameters\n\n\n\n\nToken  (the unique token)\n\n\nTitle  (the name of the tab)\n\n\nURL    (the url of the tab)\n\n\n\n\nThe token argument is made up of the {Database's Title} @ {The unique generated session token}\n\n\n\n\n\n\nThe custom tab should then connect to the P2P database and call the \nDSDBA.usp_cust_GetSessionDetailsFromToken\n stored procedure supplying the full token.  This stored procedure will return with a single row containing the following columns:\n\n\n\n\nUserGUID\n\n\nLoginID\n\n\nCompanyGUID\n\n\nCompanyCode\n\n\nDepartmentGUID\n\n\nDepartmentCode\n\n\nStoreGUID\n\n\nStoreCode\n\n\nSessionID  (the internal P2P session ID)\n\n\nExpires  (when the login token will expiry)\n\n\n\n\n\n\n\n\n\n\nWarning\n\n\nThe stored procedure will return a row even when the session ID is not valid.  In this case however all the values will be NULL.\n\n\n\n\n\n\nPlease Wait Spinner\n\n\nWhilst your tab is first loading the main site will be displaying the please wait spinner.  In order to remove the spinner the following javascript code should be added to the end of your first page\n\n\n    <script type=\"text/javascript\">\n        //Hide the spinner in the main window.\n        $().ready(function () {\n            parent.hideSpinner();\n        });\n    </script>\n\n\n\n\nIf you wish to re-display the spinner then the following javascript can be used\n\n\n\u00a0\u00a0\u00a0 <script type=\"text/javascript\">\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 window.parent.showSpinner();\n\u00a0\u00a0\u00a0 </script>\n\n\n\n\n\n\nUser Role Security\n\n\nBy default all users have access to the new tab.  If you wish to restrict access to only certain users then the name of a user role (or a custom role) can be specified for the tab within the licence file.\n\n\nIf you wish to create a custom role,  then you will also need to insert an entry into the \nDSDBA.Roles\n table with the same name.\n\n\nINSERT INTO DSDBA.Roles (GUID, Code, Description, Properties, CompanyGUID)\nSELECT newID(), 'MAY_BOOK_RESOURCES', 'Users may use the bookings tab', '', C.GUID\n  FROM DSDBA.Companies C\n\n\n\n\n\n\nExample Application\n\n\nPlease see the \nexample application\n for a complete implementation.\n\n\n\n\nTroubleshooting\n\n\nIf your custom tab does not appear then check the following\n\n\n\n\nYour licence file includes the section for your custom tab.\n\n\nIf the RelatedRole has been specified in the licence file then the user has been granted that role.\n\n\nThe URL of the custom page has been specified in the \nweb.config\n file",
            "title": "Custom Tabs"
        },
        {
            "location": "/p2p/customtab/#custom-tab",
            "text": "The P2P website can be extended by creating additional \"custom\" tabs.",
            "title": "Custom Tab"
        },
        {
            "location": "/p2p/customtab/#licence-file",
            "text": "In order to display a custom tab you will first need a licence file which includes the name of the tab.      Note  Please contact your account manager for assistance with this.   In this example the tab will be displayed as   Manage Resource Bookings  and will only be visible to users with the  MAY_BOOK_RESOURCES  user role.",
            "title": "Licence File"
        },
        {
            "location": "/p2p/customtab/#development",
            "text": "Custom tab are developed as independent websites which are then displayed as part of the core site within an iFrame.   In the screenshot above,  the blue menu bar comes from the main site,  whilst the remainder of the page (in white) is the custom tab.  By convention the custom sites are placed within the  WebSite\\Customer  folder and are mapped as a virtual application with in IIS.      In order for P2P to know the URL of the page is displayed it's path needs to be added to the  ApplicationConfig.xml  file.      Warning  After changing the application configuration file the caches in the website will need refreshing.   This can be done either by recycling the application pool,  or by performing an IIS reset.",
            "title": "Development"
        },
        {
            "location": "/p2p/customtab/#session-details",
            "text": "As the custom tab is running in a different website to the main site it is not possible to share the session state within IIS.  Instead the following steps must be followed in order to obtain the details of the current user.    Before the main site opens your landing page it first generates a unique session token which is stored in the database within the  dsdba.LoginTokens  table.  This table also holds who the current user is.     When the landing page is opened,  it is passed the following information as query string parameters   Token  (the unique token)  Title  (the name of the tab)  URL    (the url of the tab)   The token argument is made up of the {Database's Title} @ {The unique generated session token}    The custom tab should then connect to the P2P database and call the  DSDBA.usp_cust_GetSessionDetailsFromToken  stored procedure supplying the full token.  This stored procedure will return with a single row containing the following columns:   UserGUID  LoginID  CompanyGUID  CompanyCode  DepartmentGUID  DepartmentCode  StoreGUID  StoreCode  SessionID  (the internal P2P session ID)  Expires  (when the login token will expiry)      Warning  The stored procedure will return a row even when the session ID is not valid.  In this case however all the values will be NULL.",
            "title": "Session Details"
        },
        {
            "location": "/p2p/customtab/#please-wait-spinner",
            "text": "Whilst your tab is first loading the main site will be displaying the please wait spinner.  In order to remove the spinner the following javascript code should be added to the end of your first page      <script type=\"text/javascript\">\n        //Hide the spinner in the main window.\n        $().ready(function () {\n            parent.hideSpinner();\n        });\n    </script>  If you wish to re-display the spinner then the following javascript can be used  \u00a0\u00a0\u00a0 <script type=\"text/javascript\">\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 window.parent.showSpinner();\n\u00a0\u00a0\u00a0 </script>",
            "title": "Please Wait Spinner"
        },
        {
            "location": "/p2p/customtab/#user-role-security",
            "text": "By default all users have access to the new tab.  If you wish to restrict access to only certain users then the name of a user role (or a custom role) can be specified for the tab within the licence file.  If you wish to create a custom role,  then you will also need to insert an entry into the  DSDBA.Roles  table with the same name.  INSERT INTO DSDBA.Roles (GUID, Code, Description, Properties, CompanyGUID)\nSELECT newID(), 'MAY_BOOK_RESOURCES', 'Users may use the bookings tab', '', C.GUID\n  FROM DSDBA.Companies C",
            "title": "User Role Security"
        },
        {
            "location": "/p2p/customtab/#example-application",
            "text": "Please see the  example application  for a complete implementation.",
            "title": "Example Application"
        },
        {
            "location": "/p2p/customtab/#troubleshooting",
            "text": "If your custom tab does not appear then check the following   Your licence file includes the section for your custom tab.  If the RelatedRole has been specified in the licence file then the user has been granted that role.  The URL of the custom page has been specified in the  web.config  file",
            "title": "Troubleshooting"
        },
        {
            "location": "/p2p/addins/",
            "text": "Add-ins\n\n\nP2P supports the concept of 'Add-ins' which are additional custom links which can be added to any page within the core website.\n\n\n\n\nSetup\n\n\n\n\n\n\nEnsure that a sub-folder called \nAddins\n exists within the Customer virtual directory in the root of the web site. \n\n\n\n\n\n\nIf the folder doesn't already contain a file called \nAddins.xml\n then create the following file.  If the file does already exist then add your new page to it.\n\n\n\n\n\n\n<AddIns>\n    <Page Name=\"Purchasing/Orders/Plus/MultiLineEntry.asp\">\n        <Link AddInURL=\"SampleOrderAddIn.aspx\" WindowWidth=\"900\" WindowHeight=\"600\" WindowName=\"OrderTaxReset\">Sample Order AddIn</Link>\n    </Page>\n</AddIns>\n\n\n\n\nIn the example above,  a link captioned \nSample Order Addin\n will be added to the \nMultiLineEntry.asp\n page.  When this link is clicked a new window will open (900x600) which will display the URL \nSampleOrderAddIn.aspx\n\n\n\n\n\n\nIn the same folder create your add-in page.   (\nFor example SampleOrderAddIn.aspx\n)\n\n\n\n\n\n\nIf you wish your add-in to interact with the main site,  then please read the following \nJavascript\n section.\n\n\n\n\n\n\n\n\nCSS\n\n\nIn order to pick up some of the styling from the main site (such as the default font-family and font size for the page) the \nCustomSupport/Site.css\n style-sheet should be referenced.\n\n\n<link rel=\"stylesheet\" type=\"text/css\" href=\"../../CustomSupport/Site.css\" />\n\n\n\n\n\n\nJavascript\n\n\nAn add-in page can communicate with the parent P2P application via javaScript calls exposed by the addInClient library.\n\n\nIncludes\n\n\nThe main web site has a \nCustomSupport\n folder that contains the files that need to be included (some optionally) in each add-in page.\n\n\nAddInClient.js\n:\u00a0 mandatory for communication between the add-in page and the owning main P2P page in the client\u2019s browser (which can in turn communicate with the server)\n\n\njquery-xxx.im.js\n: mandatory\u00a0 \n\n\njquery.filerNode.js\n: mandatory if you wish to use the xml services exposed by the AddInClient class, for manipulating order/invoice xml. Otherwise can be left out. \n\n\nkendo.xxx.min.js\n, Notifications.inc, Site.css: mandatory if you wish to use the same notification services and styling as the main web site for info, alert and error messages. Otherwise can be left out. \n\n\n    <script src=\"../../CustomSupport/jquery-2.2.4.min.js\"></script>\n    <script src=\"../../CustomSupport/jquery.filerNode.js\"></script>\n    <script src=\"../../CustomSupport/AddInClient.js\"></script>\n    <script src=\"../../CustomSupport/kendo.core.min.js\"></script>\n    <script src=\"../../CustomSupport/kendo.notification.min.js\"></script>\n    <script src=\"../../CustomSupport/kendo.popup.min.js\"></script>\n\n\n\n\n\n\naddInClient\n\n\nA core deliverable for any javaScript add-in solution, is the recognition that any single add-in page may need to make numerous AJAX calls in order to retrieve all the data it requires in order to function. Since those AJAX calls are asynchronous, the challenge is how to co-ordinate and handle their callbacks.\n\n\nThe addInClient javaScript class solves the callback challenge. Through the use of jQuery Deferred/Promise functionality, it can accept any number of AJAX calls as input, will manage their respective callbacks, combine the data retrieved and make that data available to the caller.\u00a0\n\n\nThe \naddInClient\n class exposes the following AJAX methods. Understand that these calls are asynchronous. The return values described below are not returned directly but rather indirectly via the \nMonitorAjaxCalls\n method. The methods below directly return a jQuery Promise object. \n\u00a0\n\n\nGetSessionID()\n\n\n\n\nReturns the current session-id.\n\n\n\n\nGetSessionParm(keyName)\n\n\n\n\nReturns the session value (as a string) stored against the specified key-name. \n\n\nReturns null if the session value is not present.\n\n\n\n\nGetSessionParms(keyNames)\n\n\nAccepts an array of key-names and returns the corresponding session values (or null values if the session value does not exist) Return value is a JSON array of key/value pairs First entry in return array is always the session-id. \n\n\nGetOrderInEdit()\n\n\n\n\nReturns the full order xml (including all lines) for the order currently in edit in the current session. \n\n\nReturns an error if no order is currently in edit.\n\n\n\n\nGetOrderInEditWithoutLines()\n\n\n\n\nReturns the order xml with an empty LineSet xml node (i.e. order header and footer only). \n\n\nReturns an error if no order is currently in edit \n\n\n\n\nGetInvoiceInEdit()\n\n\n\n\nReturns the full invoice xml (including all lines) for the invoice currently in edit in the current session. \n\n\n\n\nGetInvoiceInEditHeader()\n\n\n\n\nReturns the invoice header xml for the invoice currently in edit in the current session. \n\n\n\n\nGetInvoiceInEditFooter()\n\n\n\n\nReturns the invoice footer xml for the invoice currently in edit in the current session. \n\n\n\n\nMonitorAjaxCalls(ajaxCalls)\n\n\n\n\nAccepts an array of any combination of the above AJAX \u201cGet\u2026\u201d methods. Since each of the above \u201cGet\u2026\u201d methods actually returns a jQuery Promise object, the input to this method is actually an array of those Promise objects to be monitored.\u00a0 \n\n\nReturns a single jQuery Promise object to which resolve/fail events can be attached \n\n\nIf all input \u201cGet\u2026\u201d methods succeed then\u00a0 \n\n\nAll \u201cresolve\u201d events attached to the returned Promise, are triggered (in the order in which they were attached) \n\n\nEach \u201cresolve\u201d event is passed the following parameters \n\n\nResults\n: an array of return values, matching the AJAX calls that were input. The array entries will be simple strings, JSON key/value arrays or xml strings, as per the return types from the above \u201cGet\u2026\u201d methods.\u00a0 \n\n\nAlertMessages\n: an array of all alert messages output by the AJAX \u201cGet\u2026\u201d messages\n\n\nInfoMessages\n: an array of all info messages output by the AJAX \u201cGet\u2026\u201d messages\n\n\n\n\n\n\nIf any of input AJAX \u201cGet\u2026\u201d methods fail then \n\n\nAll \u201cfail\u201d events attached to the returned Promise, are triggered (in the order in which they were attached) \n\n\nEach \u201cfail\u201d event is passed an array of error messages. \n\n\nEven if some of the input AJAX \u201cGet\u2026\u201d events succeed, no \u201cresolve\u201d events are triggered. \n\n\n\n\n\n\n\n\nHandleError(errorMessages)\n\n\nWill test for the presence of notification services and output formal error notifications if possible. Otherwise will issue alerts for each error message. \n\n\n\n\nXMLServices\n\n\nExposes a set of helper methods for working with document xml (i.e. xml with the \u201cgrs\u201d namespace). The following methods are available \n\n\nloadDOM(xml)\n\n\n\n\nAccepts an xml string and returns a jQuery DOM object \n\n\n\n\ngetNode(parentNode, nodeName)\n\n\n\n\nAccepts a parent node (or the DOM) and the name of an immediate child element. \n\n\nReturns the child element \n\n\nnodeName can be an array of element names. Where each name corresponds to an element that is a child of the previous name (element).\u00a0 \n\n\n\n\nattr(node, attributeName)\n\n\n\n\nReturns the given attribute of the given element. \n\n\n\n\ngetNodeAttr(parentNode, nodeName, attributeName)\n\n\n\n\nFinds the specified immediate child element of the parent node and returns the specified attribute value. \n\n\n\n\nfilterNodeAttr(parentNode, nodeName, attributeName, attributeName)\n\n\n\n\nFinds the specified immediate child element of the parent node, which also has an attribute with the specified name and value. \n\n\nReturns the text value of that child element. \n\u00a0\n\n\n\n\n\n\nSample Add-In\n\n\nThere is a sample add-in and xml file available \nhere\n.\n\n\nThe sample is available from the multi-line orders page and shows how order information can be retrieved and displayed.",
            "title": "Addins"
        },
        {
            "location": "/p2p/addins/#add-ins",
            "text": "P2P supports the concept of 'Add-ins' which are additional custom links which can be added to any page within the core website.",
            "title": "Add-ins"
        },
        {
            "location": "/p2p/addins/#setup",
            "text": "Ensure that a sub-folder called  Addins  exists within the Customer virtual directory in the root of the web site.     If the folder doesn't already contain a file called  Addins.xml  then create the following file.  If the file does already exist then add your new page to it.    <AddIns>\n    <Page Name=\"Purchasing/Orders/Plus/MultiLineEntry.asp\">\n        <Link AddInURL=\"SampleOrderAddIn.aspx\" WindowWidth=\"900\" WindowHeight=\"600\" WindowName=\"OrderTaxReset\">Sample Order AddIn</Link>\n    </Page>\n</AddIns>  In the example above,  a link captioned  Sample Order Addin  will be added to the  MultiLineEntry.asp  page.  When this link is clicked a new window will open (900x600) which will display the URL  SampleOrderAddIn.aspx    In the same folder create your add-in page.   ( For example SampleOrderAddIn.aspx )    If you wish your add-in to interact with the main site,  then please read the following  Javascript  section.",
            "title": "Setup"
        },
        {
            "location": "/p2p/addins/#css",
            "text": "In order to pick up some of the styling from the main site (such as the default font-family and font size for the page) the  CustomSupport/Site.css  style-sheet should be referenced.  <link rel=\"stylesheet\" type=\"text/css\" href=\"../../CustomSupport/Site.css\" />",
            "title": "CSS"
        },
        {
            "location": "/p2p/addins/#javascript",
            "text": "An add-in page can communicate with the parent P2P application via javaScript calls exposed by the addInClient library.",
            "title": "Javascript"
        },
        {
            "location": "/p2p/addins/#includes",
            "text": "The main web site has a  CustomSupport  folder that contains the files that need to be included (some optionally) in each add-in page.  AddInClient.js :\u00a0 mandatory for communication between the add-in page and the owning main P2P page in the client\u2019s browser (which can in turn communicate with the server)  jquery-xxx.im.js : mandatory\u00a0   jquery.filerNode.js : mandatory if you wish to use the xml services exposed by the AddInClient class, for manipulating order/invoice xml. Otherwise can be left out.   kendo.xxx.min.js , Notifications.inc, Site.css: mandatory if you wish to use the same notification services and styling as the main web site for info, alert and error messages. Otherwise can be left out.       <script src=\"../../CustomSupport/jquery-2.2.4.min.js\"></script>\n    <script src=\"../../CustomSupport/jquery.filerNode.js\"></script>\n    <script src=\"../../CustomSupport/AddInClient.js\"></script>\n    <script src=\"../../CustomSupport/kendo.core.min.js\"></script>\n    <script src=\"../../CustomSupport/kendo.notification.min.js\"></script>\n    <script src=\"../../CustomSupport/kendo.popup.min.js\"></script>",
            "title": "Includes"
        },
        {
            "location": "/p2p/addins/#addinclient",
            "text": "A core deliverable for any javaScript add-in solution, is the recognition that any single add-in page may need to make numerous AJAX calls in order to retrieve all the data it requires in order to function. Since those AJAX calls are asynchronous, the challenge is how to co-ordinate and handle their callbacks.  The addInClient javaScript class solves the callback challenge. Through the use of jQuery Deferred/Promise functionality, it can accept any number of AJAX calls as input, will manage their respective callbacks, combine the data retrieved and make that data available to the caller.\u00a0  The  addInClient  class exposes the following AJAX methods. Understand that these calls are asynchronous. The return values described below are not returned directly but rather indirectly via the  MonitorAjaxCalls  method. The methods below directly return a jQuery Promise object.",
            "title": "addInClient"
        },
        {
            "location": "/p2p/addins/#getsessionid",
            "text": "Returns the current session-id.",
            "title": "GetSessionID()"
        },
        {
            "location": "/p2p/addins/#getsessionparmkeyname",
            "text": "Returns the session value (as a string) stored against the specified key-name.   Returns null if the session value is not present.",
            "title": "GetSessionParm(keyName)"
        },
        {
            "location": "/p2p/addins/#getsessionparmskeynames",
            "text": "Accepts an array of key-names and returns the corresponding session values (or null values if the session value does not exist) Return value is a JSON array of key/value pairs First entry in return array is always the session-id.",
            "title": "GetSessionParms(keyNames)"
        },
        {
            "location": "/p2p/addins/#getorderinedit",
            "text": "Returns the full order xml (including all lines) for the order currently in edit in the current session.   Returns an error if no order is currently in edit.",
            "title": "GetOrderInEdit()"
        },
        {
            "location": "/p2p/addins/#getorderineditwithoutlines",
            "text": "Returns the order xml with an empty LineSet xml node (i.e. order header and footer only).   Returns an error if no order is currently in edit",
            "title": "GetOrderInEditWithoutLines()"
        },
        {
            "location": "/p2p/addins/#getinvoiceinedit",
            "text": "Returns the full invoice xml (including all lines) for the invoice currently in edit in the current session.",
            "title": "GetInvoiceInEdit()"
        },
        {
            "location": "/p2p/addins/#getinvoiceineditheader",
            "text": "Returns the invoice header xml for the invoice currently in edit in the current session.",
            "title": "GetInvoiceInEditHeader()"
        },
        {
            "location": "/p2p/addins/#getinvoiceineditfooter",
            "text": "Returns the invoice footer xml for the invoice currently in edit in the current session.",
            "title": "GetInvoiceInEditFooter()"
        },
        {
            "location": "/p2p/addins/#monitorajaxcallsajaxcalls",
            "text": "Accepts an array of any combination of the above AJAX \u201cGet\u2026\u201d methods. Since each of the above \u201cGet\u2026\u201d methods actually returns a jQuery Promise object, the input to this method is actually an array of those Promise objects to be monitored.\u00a0   Returns a single jQuery Promise object to which resolve/fail events can be attached   If all input \u201cGet\u2026\u201d methods succeed then\u00a0   All \u201cresolve\u201d events attached to the returned Promise, are triggered (in the order in which they were attached)   Each \u201cresolve\u201d event is passed the following parameters   Results : an array of return values, matching the AJAX calls that were input. The array entries will be simple strings, JSON key/value arrays or xml strings, as per the return types from the above \u201cGet\u2026\u201d methods.\u00a0   AlertMessages : an array of all alert messages output by the AJAX \u201cGet\u2026\u201d messages  InfoMessages : an array of all info messages output by the AJAX \u201cGet\u2026\u201d messages    If any of input AJAX \u201cGet\u2026\u201d methods fail then   All \u201cfail\u201d events attached to the returned Promise, are triggered (in the order in which they were attached)   Each \u201cfail\u201d event is passed an array of error messages.   Even if some of the input AJAX \u201cGet\u2026\u201d events succeed, no \u201cresolve\u201d events are triggered.",
            "title": "MonitorAjaxCalls(ajaxCalls)"
        },
        {
            "location": "/p2p/addins/#handleerrorerrormessages",
            "text": "Will test for the presence of notification services and output formal error notifications if possible. Otherwise will issue alerts for each error message.",
            "title": "HandleError(errorMessages)"
        },
        {
            "location": "/p2p/addins/#xmlservices",
            "text": "Exposes a set of helper methods for working with document xml (i.e. xml with the \u201cgrs\u201d namespace). The following methods are available",
            "title": "XMLServices"
        },
        {
            "location": "/p2p/addins/#loaddomxml",
            "text": "Accepts an xml string and returns a jQuery DOM object",
            "title": "loadDOM(xml)"
        },
        {
            "location": "/p2p/addins/#getnodeparentnode-nodename",
            "text": "Accepts a parent node (or the DOM) and the name of an immediate child element.   Returns the child element   nodeName can be an array of element names. Where each name corresponds to an element that is a child of the previous name (element).",
            "title": "getNode(parentNode, nodeName)"
        },
        {
            "location": "/p2p/addins/#attrnode-attributename",
            "text": "Returns the given attribute of the given element.",
            "title": "attr(node, attributeName)"
        },
        {
            "location": "/p2p/addins/#getnodeattrparentnode-nodename-attributename",
            "text": "Finds the specified immediate child element of the parent node and returns the specified attribute value.",
            "title": "getNodeAttr(parentNode, nodeName, attributeName)"
        },
        {
            "location": "/p2p/addins/#filternodeattrparentnode-nodename-attributename-attributename",
            "text": "Finds the specified immediate child element of the parent node, which also has an attribute with the specified name and value.   Returns the text value of that child element.",
            "title": "filterNodeAttr(parentNode, nodeName, attributeName, attributeName)"
        },
        {
            "location": "/p2p/addins/#sample-add-in",
            "text": "There is a sample add-in and xml file available  here .  The sample is available from the multi-line orders page and shows how order information can be retrieved and displayed.",
            "title": "Sample Add-In"
        },
        {
            "location": "/p2p/genericimaging/",
            "text": "Generic Imaging DLL\n\n\nOverview\n\n\nThe PROACTIS P2P product has been designed so that it can be easily integrated with a number of different Document Management Systems (DMS).\n\n\nA typical PROACTIS imaging solution requires the following integration points:-\n\n\n\n\nThe scanned image needs to be associated with an invoice within PROACTIS.\n\n\nUsers need to be able to see the original scanned image by clicking a link within the PROACTIS web site.\n\n\n\n\nAlthough there are many different possible methods available (as different DMS and customers have different requirements) a generic imaging DLL has been written which meets the majority of customer\u2019s requirements.\nThis document describes how to install and configure this DLL.\n\n\n\n\nInstalling the Generic Imaging DLL\n\n\nWithin your \nPROACTIS P2P/Plugins\n  (or \nPlugins/[database-title]\n) folder create a file called \nPROACTIS.P2P.proGenericImaging.dll\n  This can be an empty text file.\n\n\n\n\nConfiguring the imaging DLL\n\n\nThe \u201cgeneric imaging\u201d DLL supports two different sources for viewing scanned images.  They can be displayed either from an existing image file on the filesystem, or from an external URL.  Different sources can be defined for different document types.  For example, expense claims might exist as .gif files in a file share, whilst scanned images might be held in a document management system accessed via a webpage.\nThe configuration for the generic imaging DLL is carried out via the \u201cImaging Settings\u201d snap in within the PROACTIS Management Console.\n\n\n\n\nExamples\n\n\nIn order to view an image via a URL held in an external DMS, the following settings would be required.\n\n\n\n\n\n\n\n\nSetting Name\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nDefaultImageSource\n\n\nURL \u2013 the image is retrieved from the external system using an URL\n\n\n\n\n\n\nInvoiceImageIdentifier\n\n\nDisplayNumber \u2013 the PROACTIS invoice number is used to identify the image in the DMS.\n\n\n\n\n\n\nDefaultURL\n\n\nThe tag {{ImageID}} will be replaced with the value of the InvoiceImageIdentifier when access the DMS.\n\n\n\n\n\n\n\n\n\n\nAdditional Settings\n\n\nThe other available settings are detailed below:-\n\n\nThe image source\n\n\nThe image source specifies where the image will be found and should have the value of either URL or FILE.\n\n\nThe DLL first checks for the value of {doctype}ImageSource setting.  \n{doctype}\n is one of the following values depending on the type of document being viewed.\n\n\n\n\nInvoice\n\n\nCreditNote\n\n\nExpense\n\n\nAcceptance\n\n\n\n\nIf this setting does not exist, or is blank then the DLL checks for the value of DefaultImageSource\nIf no image source can be found for a document type or the value is not either FILE or URL, then the following error will be raised\n\u201cInvalid image source \u2013\u201c\n\n\nThe image identifier\n\n\nThe DLL then determines how to identify the image.   Images can be identified by their\n- ImageReference (Invoices and Credit Notes only)\n- HeaderReference\n- DisplayNumber\n\n\nThe \u201c{doctype}ImageIdentifier\u201d setting specifies which of these sources will be used for the {doctype} document type.  If the setting is not set for the current document type then the following defaults will be used\n- Invoices and Credit Notes -   ImageReference\n- Expenses and Acceptances  -   HeaderReference\n\n\nIf HeaderReference has been specified for the xxx document type, then the name of the reference field must also be set in either the\n- DefaultImageReference setting\n\nOr\n- {doctype}ImageReference setting.\n\n\nViewing Images from an URL\n\n\nIf the source type is determined to be a URL then the base URL is read from one of the following settings:\n- InvoiceURL\n- CreditNoteURL\n- ExpenseClaimURL\n- AcceptanceURL\n\n\nIf the setting is blank or does not exist, then the value of DefaultURL is used.\n\n\nOnce the URL has been determined, the image identifier is then appended to the end.  For example if the base URL is http://image-server.asp?ImageID=  and the ImageIdentifier is PINV1234 then the following URL will be used http://image-server.asp?ImageID=PINV1234\n\n\nIf the URL contains the markup tag {{ImageID}}  then instead of the ImageIdentifier being appended to the end of the URL it will replace the tag within the URL.\nFor example http://localhost/intranet/DMS/{{ImageID}}.bmp will become http://localhost/intranet/DMS/PINV1234.bmp\n\u2003\n\n\nViewing Images from a FILE\n\n\nIf the source type is determined to be a FILE then the image folder is read from one of the following settings\n- InvoiceFolder\n- CreditNoteFolder\n- ExpenseClaimFolder\n- AcceptanceFolder\nIf the setting is blank or does not exist, then the value of DefaultFolder is used.\n\n\nNext the mime type of the image file is resolved using the following settings\n- InvoiceMIMEType\n- CreditNoteMIMEType\n- ExpenseClaimMIMEType\n- AcceptanceMIMEType\n\n\nIf the setting is blank or does not exist, then the value of DefaultMIMEType is used.\nIf the value for the MIME type is still unknown then the DLL queries the registry for find the mime type registered for the file extensions.  This is held in HKEY_LOCAL_MACHINE\\Software\\Classes{fileext}\\Content Type where {fileext} is the file extension.\nIf a value still can\u2019t be found then it defaults to a mime type of application/octet-stream\nOnce the MIME type and Folder is known, the complete target filename is generated by appending the image identifier to the folder.  For example if the folder is c:\\Images and the ImageIdentifier is PINV1234.gif then the filename c:\\Images\\PINV1234.gif will be displayed.\n\n\n\n\nThe \u201cGeneric Imaging DLL\u201d - Processing\n\n\nDisplay of the Process Images Link\n\n\nTo determine if the \u201cProcess Images\u201d link should be displayed the following setting is queried\n- ProcessInvoice\n- ProcessCreditNote\n- ProcessExpenseClaim\n- ProcessAcceptance\n\n\nIf the setting is missing or blank then the ProcessDefault setting will be used.\nIf it has a value of ALWAYS then the link will always be displayed.  If the setting is NEVER then the link will always be hidden.  Otherwise the link will only be displayed if there are some images to process.\nThis allows the Process scanned image functionality so be available for some document types but not for others.\n\n\nListing Images From the Database\n\n\nIf the image source for the document type is URL (see above) then the list of available images is determined by querying the database.\nThe DLL then selects from the \u201cdsdba.view_cus_UnprocessedDocumentImages\u201d database view.  This view must be customised to select from your images database.\nEach of the columns returned by the view will then be displayed within a table on the website.\nOne of the columns must be designated as a key column,  this means that it uniquely identifies the image.\nThe key column is defined by the following setting\n- InvoiceProcessKey\n- CreditNoteProcessKey\n- ExpenseClaimProcessKey\n- AcceptanceProcessKey\n\n\nIf the setting is missing or blank then the ProcessKeyDefault setting will be used.\n\n\nListing Images From a folder\n\n\nIf the image source for the document type is FILE (see above) then the list of available images is determined by the files in an existing folder.\nThe folder is determined by the following setting\n- InvoiceProcessFolder\n- CreditNoteProcessFolder\n- ExpenseClaimProcessFolder\n- AcceptanceProcessFolder\n\n\nIf the setting is missing or blank then the ProcessFolderDefault setting will be used.\n\n\nThe system can be configured so that each user can have their own folder of images.  If the following setting is set to YES then the users loginID will be appended to the folder name\n- InvoicePostfixLogin\n- CreditNotePostfixLogin\n- ExpenseClaimNotePostfixLogin\n- AcceptancePostfixLogin\n\n\nIf the setting is missing or blank then the DefaultPostfixLogin setting will be used.\nFor example, if the folder is C:\\Images and the post fix login is YES and the username is DAVID then the folder c:\\Image\\David will be used.\n\n\n\n\nProcessing Database Images\n\n\nOnce an image held in the database has been processed then image identifier is then set against the document within PROACTIS.\n\n\nProcessing File Images\n\n\nOnce a file image has been processed then the file is moved into a processed folder.  The folder is determined from the following setting.\n- InvoiceProcessFolder\n- CreditNoteProcessFolder\n- ExpenseClaimProcessFolder\n- AcceptanceProcessFolder\n\n\nIf the setting is missing or blank then the DefaultProcessFolder setting will be used.\nThe file can also be renamed as it\u2019s moved when the following setting is set to YES\n- InvoiceFileRename\n- CreditNoteFileRename\n- AcceptanceFileRename\n- ExpenseClaimFileRename\n\n\nIf the setting is missing or blank then the DefaultFileRename setting will be used.\n\n\n\n\nSummary of Settings\n\n\n\n\n\n\n\n\nSetting Name\n\n\nExample\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nInvoiceImageSource\n\n\nFILE or URL\n\n\nThe source for viewing invoice files\n\n\n\n\n\n\nCreditNoteImageSource\n\n\nFILE or URL\n\n\nThe source for viewing credit note files\n\n\n\n\n\n\nAcceptanceImageSource\n\n\nFILE or URL\n\n\nThe source for viewing acceptance files\n\n\n\n\n\n\nExpenseImageSource\n\n\nFILE or URL\n\n\nThe source for viewing expense claim files\n\n\n\n\n\n\nDefaultImageSource\n\n\nFILE or URL\n\n\nSource used when the above setting is blank or missing\n\n\n\n\n\n\nExpenseClaimImageReference\n\n\nIMAGE\n\n\nThe code of the reference field on an expense claim which holds the identifier of the image.\n\n\n\n\n\n\nAcceptanceImageReference\n\n\nBARCODE\n\n\nThe code of the reference field on an acceptance document which holds the identifier of the image.\n\n\n\n\n\n\nDefaultImageReference\n\n\nID\n\n\nThe reference field used when the above settings are blank or missing\n\n\n\n\n\n\nInvoiceURL\n\n\nhttp://images?ID=\n\n\nThe prefix for the URL used for displaying invoices.\n\n\n\n\n\n\nCreditNoteURL\n\n\nhttps://images?Doc=\n\n\nThe prefix for the URL used for displaying credit notes.\n\n\n\n\n\n\nExpenseClaimURL\n\n\nhttp://127.0.0.1/?BarCode=\n\n\nThe prefix for the URL used for displaying expense claims.\n\n\n\n\n\n\nAcceptanceURL\n\n\nhttp://www.images.com?ID\n\n\nThe prefix for the URL used for displaying acceptance documents.\n\n\n\n\n\n\nDefaultURL\n\n\nhttp://img-server?type=PROACTIS&ID=\n\n\nThe URL used when the above settings are blank or missing\n\n\n\n\n\n\nInvoiceFolder\n\n\nC:\\Images\n\n\nThe folder containing the invoice images\n\n\n\n\n\n\nCreditNoteFolder\n\n\n\\file-server\\Images\n\n\nThe folder containing the credit note images\n\n\n\n\n\n\nExpenseClaimFolder\n\n\n\\127.0.0.1\\Images\n\n\nThe folder containing the expense claim images\n\n\n\n\n\n\nAcceptanceFolder\n\n\nC:\\Images\n\n\nThe folder containing the acceptance document images\n\n\n\n\n\n\nDefaultFolder\n\n\n\n\nThe Folder used when the above settings are blank or missing\n\n\n\n\n\n\n\n\n\n\nBeyond the Imaging DLL\n\n\nIf the \u201cGeneric Imaging DLL\u201d does not meet your requirements,  then a custom DLL can written which implements the \ngrsImageIface.IImaging\n and \ngrsImageIface.IProcess\n interfaces.  The application server can then be configured to call this DLL when a user wishes to \u201cprocess a new invoice\u201d or view an existing scanned image.\nThe development of a custom DLL is not described within this page.",
            "title": "Generic Imaging"
        },
        {
            "location": "/p2p/genericimaging/#generic-imaging-dll",
            "text": "",
            "title": "Generic Imaging DLL"
        },
        {
            "location": "/p2p/genericimaging/#overview",
            "text": "The PROACTIS P2P product has been designed so that it can be easily integrated with a number of different Document Management Systems (DMS).  A typical PROACTIS imaging solution requires the following integration points:-   The scanned image needs to be associated with an invoice within PROACTIS.  Users need to be able to see the original scanned image by clicking a link within the PROACTIS web site.   Although there are many different possible methods available (as different DMS and customers have different requirements) a generic imaging DLL has been written which meets the majority of customer\u2019s requirements.\nThis document describes how to install and configure this DLL.",
            "title": "Overview"
        },
        {
            "location": "/p2p/genericimaging/#installing-the-generic-imaging-dll",
            "text": "Within your  PROACTIS P2P/Plugins   (or  Plugins/[database-title] ) folder create a file called  PROACTIS.P2P.proGenericImaging.dll   This can be an empty text file.",
            "title": "Installing the Generic Imaging DLL"
        },
        {
            "location": "/p2p/genericimaging/#configuring-the-imaging-dll",
            "text": "The \u201cgeneric imaging\u201d DLL supports two different sources for viewing scanned images.  They can be displayed either from an existing image file on the filesystem, or from an external URL.  Different sources can be defined for different document types.  For example, expense claims might exist as .gif files in a file share, whilst scanned images might be held in a document management system accessed via a webpage.\nThe configuration for the generic imaging DLL is carried out via the \u201cImaging Settings\u201d snap in within the PROACTIS Management Console.",
            "title": "Configuring the imaging DLL"
        },
        {
            "location": "/p2p/genericimaging/#examples",
            "text": "In order to view an image via a URL held in an external DMS, the following settings would be required.     Setting Name  Description      DefaultImageSource  URL \u2013 the image is retrieved from the external system using an URL    InvoiceImageIdentifier  DisplayNumber \u2013 the PROACTIS invoice number is used to identify the image in the DMS.    DefaultURL  The tag {{ImageID}} will be replaced with the value of the InvoiceImageIdentifier when access the DMS.",
            "title": "Examples"
        },
        {
            "location": "/p2p/genericimaging/#additional-settings",
            "text": "The other available settings are detailed below:-",
            "title": "Additional Settings"
        },
        {
            "location": "/p2p/genericimaging/#the-image-source",
            "text": "The image source specifies where the image will be found and should have the value of either URL or FILE.  The DLL first checks for the value of {doctype}ImageSource setting.   {doctype}  is one of the following values depending on the type of document being viewed.   Invoice  CreditNote  Expense  Acceptance   If this setting does not exist, or is blank then the DLL checks for the value of DefaultImageSource\nIf no image source can be found for a document type or the value is not either FILE or URL, then the following error will be raised\n\u201cInvalid image source \u2013\u201c",
            "title": "The image source"
        },
        {
            "location": "/p2p/genericimaging/#the-image-identifier",
            "text": "The DLL then determines how to identify the image.   Images can be identified by their\n- ImageReference (Invoices and Credit Notes only)\n- HeaderReference\n- DisplayNumber  The \u201c{doctype}ImageIdentifier\u201d setting specifies which of these sources will be used for the {doctype} document type.  If the setting is not set for the current document type then the following defaults will be used\n- Invoices and Credit Notes -   ImageReference\n- Expenses and Acceptances  -   HeaderReference  If HeaderReference has been specified for the xxx document type, then the name of the reference field must also be set in either the\n- DefaultImageReference setting \nOr\n- {doctype}ImageReference setting.",
            "title": "The image identifier"
        },
        {
            "location": "/p2p/genericimaging/#viewing-images-from-an-url",
            "text": "If the source type is determined to be a URL then the base URL is read from one of the following settings:\n- InvoiceURL\n- CreditNoteURL\n- ExpenseClaimURL\n- AcceptanceURL  If the setting is blank or does not exist, then the value of DefaultURL is used.  Once the URL has been determined, the image identifier is then appended to the end.  For example if the base URL is http://image-server.asp?ImageID=  and the ImageIdentifier is PINV1234 then the following URL will be used http://image-server.asp?ImageID=PINV1234  If the URL contains the markup tag {{ImageID}}  then instead of the ImageIdentifier being appended to the end of the URL it will replace the tag within the URL.\nFor example http://localhost/intranet/DMS/{{ImageID}}.bmp will become http://localhost/intranet/DMS/PINV1234.bmp",
            "title": "Viewing Images from an URL"
        },
        {
            "location": "/p2p/genericimaging/#viewing-images-from-a-file",
            "text": "If the source type is determined to be a FILE then the image folder is read from one of the following settings\n- InvoiceFolder\n- CreditNoteFolder\n- ExpenseClaimFolder\n- AcceptanceFolder\nIf the setting is blank or does not exist, then the value of DefaultFolder is used.  Next the mime type of the image file is resolved using the following settings\n- InvoiceMIMEType\n- CreditNoteMIMEType\n- ExpenseClaimMIMEType\n- AcceptanceMIMEType  If the setting is blank or does not exist, then the value of DefaultMIMEType is used.\nIf the value for the MIME type is still unknown then the DLL queries the registry for find the mime type registered for the file extensions.  This is held in HKEY_LOCAL_MACHINE\\Software\\Classes{fileext}\\Content Type where {fileext} is the file extension.\nIf a value still can\u2019t be found then it defaults to a mime type of application/octet-stream\nOnce the MIME type and Folder is known, the complete target filename is generated by appending the image identifier to the folder.  For example if the folder is c:\\Images and the ImageIdentifier is PINV1234.gif then the filename c:\\Images\\PINV1234.gif will be displayed.",
            "title": "Viewing Images from a FILE"
        },
        {
            "location": "/p2p/genericimaging/#the-generic-imaging-dll-processing",
            "text": "",
            "title": "The \u201cGeneric Imaging DLL\u201d - Processing"
        },
        {
            "location": "/p2p/genericimaging/#display-of-the-process-images-link",
            "text": "To determine if the \u201cProcess Images\u201d link should be displayed the following setting is queried\n- ProcessInvoice\n- ProcessCreditNote\n- ProcessExpenseClaim\n- ProcessAcceptance  If the setting is missing or blank then the ProcessDefault setting will be used.\nIf it has a value of ALWAYS then the link will always be displayed.  If the setting is NEVER then the link will always be hidden.  Otherwise the link will only be displayed if there are some images to process.\nThis allows the Process scanned image functionality so be available for some document types but not for others.",
            "title": "Display of the Process Images Link"
        },
        {
            "location": "/p2p/genericimaging/#listing-images-from-the-database",
            "text": "If the image source for the document type is URL (see above) then the list of available images is determined by querying the database.\nThe DLL then selects from the \u201cdsdba.view_cus_UnprocessedDocumentImages\u201d database view.  This view must be customised to select from your images database.\nEach of the columns returned by the view will then be displayed within a table on the website.\nOne of the columns must be designated as a key column,  this means that it uniquely identifies the image.\nThe key column is defined by the following setting\n- InvoiceProcessKey\n- CreditNoteProcessKey\n- ExpenseClaimProcessKey\n- AcceptanceProcessKey  If the setting is missing or blank then the ProcessKeyDefault setting will be used.",
            "title": "Listing Images From the Database"
        },
        {
            "location": "/p2p/genericimaging/#listing-images-from-a-folder",
            "text": "If the image source for the document type is FILE (see above) then the list of available images is determined by the files in an existing folder.\nThe folder is determined by the following setting\n- InvoiceProcessFolder\n- CreditNoteProcessFolder\n- ExpenseClaimProcessFolder\n- AcceptanceProcessFolder  If the setting is missing or blank then the ProcessFolderDefault setting will be used.  The system can be configured so that each user can have their own folder of images.  If the following setting is set to YES then the users loginID will be appended to the folder name\n- InvoicePostfixLogin\n- CreditNotePostfixLogin\n- ExpenseClaimNotePostfixLogin\n- AcceptancePostfixLogin  If the setting is missing or blank then the DefaultPostfixLogin setting will be used.\nFor example, if the folder is C:\\Images and the post fix login is YES and the username is DAVID then the folder c:\\Image\\David will be used.",
            "title": "Listing Images From a folder"
        },
        {
            "location": "/p2p/genericimaging/#processing-database-images",
            "text": "Once an image held in the database has been processed then image identifier is then set against the document within PROACTIS.",
            "title": "Processing Database Images"
        },
        {
            "location": "/p2p/genericimaging/#processing-file-images",
            "text": "Once a file image has been processed then the file is moved into a processed folder.  The folder is determined from the following setting.\n- InvoiceProcessFolder\n- CreditNoteProcessFolder\n- ExpenseClaimProcessFolder\n- AcceptanceProcessFolder  If the setting is missing or blank then the DefaultProcessFolder setting will be used.\nThe file can also be renamed as it\u2019s moved when the following setting is set to YES\n- InvoiceFileRename\n- CreditNoteFileRename\n- AcceptanceFileRename\n- ExpenseClaimFileRename  If the setting is missing or blank then the DefaultFileRename setting will be used.",
            "title": "Processing File Images"
        },
        {
            "location": "/p2p/genericimaging/#summary-of-settings",
            "text": "Setting Name  Example  Description      InvoiceImageSource  FILE or URL  The source for viewing invoice files    CreditNoteImageSource  FILE or URL  The source for viewing credit note files    AcceptanceImageSource  FILE or URL  The source for viewing acceptance files    ExpenseImageSource  FILE or URL  The source for viewing expense claim files    DefaultImageSource  FILE or URL  Source used when the above setting is blank or missing    ExpenseClaimImageReference  IMAGE  The code of the reference field on an expense claim which holds the identifier of the image.    AcceptanceImageReference  BARCODE  The code of the reference field on an acceptance document which holds the identifier of the image.    DefaultImageReference  ID  The reference field used when the above settings are blank or missing    InvoiceURL  http://images?ID=  The prefix for the URL used for displaying invoices.    CreditNoteURL  https://images?Doc=  The prefix for the URL used for displaying credit notes.    ExpenseClaimURL  http://127.0.0.1/?BarCode=  The prefix for the URL used for displaying expense claims.    AcceptanceURL  http://www.images.com?ID  The prefix for the URL used for displaying acceptance documents.    DefaultURL  http://img-server?type=PROACTIS&ID=  The URL used when the above settings are blank or missing    InvoiceFolder  C:\\Images  The folder containing the invoice images    CreditNoteFolder  \\file-server\\Images  The folder containing the credit note images    ExpenseClaimFolder  \\127.0.0.1\\Images  The folder containing the expense claim images    AcceptanceFolder  C:\\Images  The folder containing the acceptance document images    DefaultFolder   The Folder used when the above settings are blank or missing",
            "title": "Summary of Settings"
        },
        {
            "location": "/p2p/genericimaging/#beyond-the-imaging-dll",
            "text": "If the \u201cGeneric Imaging DLL\u201d does not meet your requirements,  then a custom DLL can written which implements the  grsImageIface.IImaging  and  grsImageIface.IProcess  interfaces.  The application server can then be configured to call this DLL when a user wishes to \u201cprocess a new invoice\u201d or view an existing scanned image.\nThe development of a custom DLL is not described within this page.",
            "title": "Beyond the Imaging DLL"
        },
        {
            "location": "/p2p/customimaging/",
            "text": "Custom Imaging DLLs\n\n\nOverview\n\n\nThe PROACTIS P2P product has been designed so that it can be easily integrated with a number of different Document Management Systems (DMS).\n\n\nA typical PROACTIS imaging solution requires the following integration points:-\n\n\n\n\nThe scanned image needs to be associated with an invoice within PROACTIS.\n\n\nUsers need to be able to see the original scanned image by clicking a link within the PROACTIS web site.\n\n\n\n\nAlthough there are many different possible methods available (as different DMS and customers have different requirements) a generic imaging DLL has been written which meets the majority of customer\u2019s requirements.\n\n\nFor the cases where neither the built-in PROACTIS imaging solution or the Generic Imaging DLLs meet your requirements a completely custom DLL can be written.\n\n\n\n\nViewing Images\n\n\n\n\n\n\nCreate a new C# Class Library project called xyzImaging. ( \nxyz\n can be anything)\n\n\n\n\n\n\nAdd a reference to \nPurchasing Server\\bin\\PROACTIS.P2P.grsImagingIface.dll\n\n\n\n\n\n\nAdd a public class called \nImaging\n which implements the \ngrsImageIface.IImaging\n interface.\n\n\n\n\n\n\nWrite an implementation of the following methods.\n\n\n\n\nGetImage\n\n\nGetImageInfo\n\n\nHasImage\n\n\n\n\n\n\n\n\n\n\nHasImage\n\n\nControls if the View Image link is available when looking at a transaction within P2P\n\n\nbool IImaging.HasImage(string DocumentDetailsXML)\n\n\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nDocumentDetailsXML\n\n\nIn\n\n\nAn xml document containing the details of the document currently being displayed.\n\n\n\n\n\n\n\n\nReturn Value\n\n\nThe function should return True if an image is available.\n\n\n\n\nGetImageInfo\n\n\nReturns basic information (MimeType and NumberOfPages) for an image held against a document.\n\n\nint IImaging.GetImageInfo(string DocumentDetailsXML, ref string MIMEType)\n\n\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nDocumentDetailsXML\n\n\nIn\n\n\nAn xml document containing the details of the document currently being displayed.\n\n\n\n\n\n\nMIMEType\n\n\nOut\n\n\nMime type of the document\n\n\n\n\n\n\n\n\nMIMEType\n\n\nThis should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.\n\n\nReturn Value\n\n\nThe function should return the name of pages within the document.  Normally 1\n\n\n\n\nGetImage\n\n\nUsed to return either the bytes which make up the image of the URL for the image if it's in a DMS.\n\n\nbool IImaging.GetImage(string DocumentDetailsXML, ref string MIMEType, ref byte[] Image, ref string URL)\n\n\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nDocumentDetailsXML\n\n\nIn\n\n\nAn xml document containing the details of the document currently being displayed.\n\n\n\n\n\n\nMIMEType\n\n\nOut\n\n\nThe type of image\n\n\n\n\n\n\nImage\n\n\nOut\n\n\nByte[] containing the image\n\n\n\n\n\n\nURL\n\n\nOut\n\n\nURL to the image\n\n\n\n\n\n\n\n\nMIMEType\n\n\nThis should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.\n\n\nImage\n\n\nThe image file as an array of bytes.  This will be steamed to the client's browser\n\n\nURL\n\n\nThe URL of image in a DMS.\n\n\n\n\nNotes\n\n\nEither the Image \nor\n URL argument should be used.\n\n\n\n\n\n\nDocumentDetailsXML\n\n\nThe xml in the DocumentDetailsXML argument is made up from some context specific details based on the document being display and the settings you have defined in the imaging settings table.\n\n\n<?xml version='1.0'?><grs:ImagingSettings xmlns:grs='http://www.getrealsystems.com/xml/xml-ns'>\n<grs:SessionID>eb89c444-0270-4f06-b8b6-ec0303b00117#dbserver2008r2\\qa#DavidB_94#en-gb</grs:SessionID>\n<grs:DocumentType>I</grs:DocumentType>\n<grs:DocumentGUID>{D79D1EE8-4B87-414B-8512-92590DFBE2E8}</grs:DocumentGUID>\n<grs:ImageNumber>0</grs:ImageNumber>\n<grs:CompanyGUID>{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}</grs:CompanyGUID>\n\n<grs:InvoiceImageIdentifier>DisplayNumber</grs:InvoiceImageIdentifier>\n<grs:DefaultImageSource>URL</grs:DefaultImageSource>\n<grs:DefaultURL>https://sp-db01/imaging/{{ImageID}}.bmp</grs:DefaultURL></grs:ImagingSettings>\n\n\n\n\nThe standard fields which are always supplied as:-\n\n\n\n\nSessionID - in the format {uniqueID} # {database server} # {database name} # {user's language}\n\n\nDocumentType - 'I' for Invoice,  'C' for Credit note',  'E' for Expense Claim and 'A' For Acceptance \n\n\nDocumentGUID - GUID to identify the document being displayed\n\n\nImageNumber\n\n\nCompanyGUID - GUID of the company in which the document belongs\n\n\n\n\nIn the above example the remaining fields (below) are from the \nDSDBA.ImagingSettings\n table.\n\n\n\n\nInvoiceImageIdentifier\n\n\nDefaultImageSource\n\n\nDefaultURL\n\n\n\n\n\n\nProcessing Images\n\n\n\n\n\n\nCreate a new C# Class Library project called xyzImaging. ( \nxyz\n can be anything)\n\n\n\n\n\n\nAdd a reference to \nPurchasing Server\\bin\\PROACTIS.P2P.grsImagingIface.dll\n\n\n\n\n\n\nAdd a public class called \nProcess\n which implements the \nP2P.grsImageIface.IProcess\n interface.\n\n\n\n\n\n\nWrite an implementation of the following methods.\n\n\n\n\nGetImage\n\n\nGetImageInfo\n\n\nGetListOfUnprocessedImages\n\n\nHasUnprocessedImages\n\n\nProcessImage\n\n\n\n\n\n\n\n\n\n\nHasUnprocessedImages\n\n\nControls if the \"Process An Image\" link is available from Invoicing home page.\n\n\nbool IProcess.HasUnprocessedImages(string DetailsXML)\n\n\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nDetailsXML\n\n\nIn\n\n\nAn xml document containing the details of the document type, database and company\n\n\n\n\n\n\n\n\nReturn Value\n\n\nThe function should return True if one or more images are available for linking to invoices.\n\n\n\n\nGetListOfUnprocessedImages\n\n\nReturns an XML table showing the list of invoices available for linking\n\n\nstring IProcess.GetListOfUnprocessedImages(string DetailsXML)\n\n\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nDetailsXML\n\n\nIn\n\n\nAn xml document containing the details of the document type, database and company\n\n\n\n\n\n\n\n\nReturn Value\n\n\nThe function should return XML in the following format\n\n\n<?xml version='1.0'?>\n<grs:Images xmlns:grs='http://www.getrealsystems.com/xml/xml-ns'>\n    <grs:Image grs:Identifier='PINV123.xml'>\n        <grs:Fields>\n            <grs:Field grs:Name='Column1' grs:Value='Value in column 1' />\n            <grs:Field grs:Name='Column2' grs:Value='Value in column 2' />\n        </grs:Fields>\n    </grs:Image>\n</grs:Images>\n\n\n\n\nThe above table would generate the following table:\n\n\n\n\n\n\nThere should be 1 grs:Image per scanned image.\n\n\nThe grs:Identifier attribute uniquely identities the image\n\n\nEach column required in the table should be added as a grs:Field element\n\n\ngrs:Name provides the caption for the column and grs:Value it's contents.\n\n\n\n\n\n\nGetImageInfo\n\n\nReturns basic information (MimeType and NumberOfPages) for an image held against a document.\n\n\nint IProcess.GetImageInfo(string DetailsXML, ref string MIMEType)\n\n\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nDetailsXML\n\n\nIn\n\n\nAn xml document containing the details of the document currently being displayed.\n\n\n\n\n\n\nMIMEType\n\n\nOut\n\n\nMime type of the document\n\n\n\n\n\n\n\n\nMIMEType\n\n\nThis should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.\n\n\nReturn Value\n\n\nThe function should return the name of pages within the document.  Normally 1\n\n\n\n\nGetImage\n\n\nUsed to return either the bytes which make up the image of the URL for the image if it's in a DMS.\n\n\nbool IProcess.GetImage(string DetailsXML, ref string MIMEType, ref byte[] Image, ref string URL)\n\n\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nDetailsXML\n\n\nIn\n\n\nAn xml document containing the details of the document currently being displayed.\n\n\n\n\n\n\nMIMEType\n\n\nOut\n\n\nThe type of image\n\n\n\n\n\n\nImage\n\n\nOut\n\n\nByte[] containing the image\n\n\n\n\n\n\nURL\n\n\nOut\n\n\nURL to the image\n\n\n\n\n\n\n\n\nMIMEType\n\n\nThis should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.\n\n\nImage\n\n\nThe image file as an array of bytes.  This will be steamed to the client's browser\n\n\nURL\n\n\nThe URL of image in a DMS.\n\n\n\n\nNotes\n\n\nEither the Image \nor\n URL argument should be used.\n\n\n\n\n\n\nProcessImage\n\n\nUsed to associate the image with a document.\n\n\nbool IProcess.ProcessImage(string DetailsXML, string DocumentXML, ref string UserMessages)\n\n\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nDetailsXML\n\n\nIn\n\n\nAn xml document containing the details of the document currently being displayed.\n\n\n\n\n\n\nDocumentXML\n\n\nIn\n\n\nThe full P2P document which is being linked to the image\n\n\n\n\n\n\nUserMessages\n\n\nOut\n\n\nMessages to feed back to the user\n\n\n\n\n\n\n\n\nDetailsXML\n\n\nThe DocumentGUID will contain the unique identifier for the selected image.\n\n\nDocumentXML\n\n\nThe full internal XML for the document this image is being linked with.  The format varies depending on the type of document.\n\n\n\n\nWarning\n\n\nAs the internal xml format us undocumented and subject to change it is recommended that you extract as little information as possible and program defensively.\n\n\n\n\nUserMessages\n\n\nAllows user message to be returned to the PROACTIS website.  Not normally required.\n\n\n\n\nNotes\n\n\nThis method is responsible for storing the link between the scanned image and the P2P document.  For example the unique ID might be written to the \nImageReference\n column in the \ndsdba.Invoices\n table.\n\n\n\n\n\n\nDetailsXML\n\n\nThe xml in the DetailsXML argument is made up from some context specific details based on the document being display and the settings you have defined in the imaging settings table.\n\n\n<?xml version=\"1.0\"?>\n<grs:ImagingSettings xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n<grs:SessionID>789e432f-6515-435c-8748-d88665d57119#dbserver2008r2\\qa#DavidB_94#en-gb</grs:SessionID>\n<grs:DocumentType>C</grs:DocumentType>\n<grs:DocumentGUID></grs:DocumentGUID>\n<grs:ImageNumber>0</grs:ImageNumber>\n<grs:CompanyGUID>{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}</grs:CompanyGUID>\n\n<grs:InvoiceImageIdentifier>DisplayNumber</grs:InvoiceImageIdentifier>\n<grs:DefaultImageSource>URL</grs:DefaultImageSource>\n<grs:DefaultURL>https://sp-db01/imaging/{{ImageID}}.bmp</grs:DefaultURL>\n</grs:ImagingSettings>\n\n\n\n\nThe standard fields which are always supplied as:-\n\n\n\n\nSessionID - in the format {uniqueID} # {database server} # {database name} # {user's language}\n\n\nDocumentType - 'I' for Invoice,  'C' for Credit note',  'E' for Expense Claim and 'A' For Acceptance \n\n\nDocumentGUID - GUID to identify the document being displayed\n\n\nImageNumber\n\n\nCompanyGUID - GUID of the company in which the document belongs\n\n\n\n\nIn the above example the remaining fields (below) are from the \nDSDBA.ImagingSettings\n table.\n\n\n\n\nInvoiceImageIdentifier\n\n\nDefaultImageSource\n\n\nDefaultURL\n\n\n\n\n\n\nSearching for unprocessed images\n\n\n\n\n\n\nCreate a new C# Class Library project called xyzImaging. ( \nxyz\n can be anything)\n\n\n\n\n\n\nAdd a reference to \nPurchasing Server\\bin\\PROACTIS.P2P.grsImagingIface.dll\n\n\n\n\n\n\nAdd a public class called \nSearch\n which implements the \ngrsImageIface.ISearch\n interface.\n\n\n\n\n\n\nWrite an implementation of the following methods.\n\n\n\n\nSearchForUnprocessedImages\n\n\n\n\n\n\n\n\n\n\nSearchForUnprocessedImages\n\n\nReturns a list of unprocessed images based on the search criteria entered by the user.\n\n\n\n\nSignature\n\n\nstring ISearch.SearchForUnprocessedImages(string DetailsXML)\n\n\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nDetailsXML\n\n\nIn\n\n\nAn xml document containing the search criteria .\n\n\n\n\n\n\n\n\nDetailsXML\n\n\n<?xml version=\"1.0\"?>\n<grs:ImagingSettings xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n    <grs:SessionID>fd2ae334-dd29-42d3-9706-ea4883b7bedc#dbserver2008r2\\qa#DavidB_94#en-gb</grs:SessionID>\n    <grs:DocumentType>I</grs:DocumentType>\n    <grs:DocumentGUID></grs:DocumentGUID>\n    <grs:ImageNumber>0</grs:ImageNumber>\n    <grs:CompanyGUID>{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}</grs:CompanyGUID>\n    <grs:MaxReturnRows>100</grs:MaxReturnRows>\n    <grs:PrimarySortColumn>DocumentDate</grs:PrimarySortColumn>\n    <grs:PrimarySortAscending>False</grs:PrimarySortAscending>\n    <grs:SupplierReference></grs:SupplierReference>\n    <grs:DateFrom></grs:DateFrom>\n    <grs:DateTo></grs:DateTo>\n    <grs:FromAddress></grs:FromAddress>\n    <grs:ToAddress></grs:ToAddress>\n    <grs:Subject></grs:Subject>\n    <grs:RuleName></grs:RuleName>\n    <grs:DateEmailedFrom></grs:DateEmailedFrom>\n    <grs:DateEmailedTo></grs:DateEmailedTo>\n\n    <grs:DefaultImageSource>URL</grs:DefaultImageSource>\n    <grs:DefaultURL>https://sp-db01/imaging/{{ImageID}}.bmp</grs:DefaultURL>\n</grs:ImagingSettings>\n\n\n\n\nThe following fields can be ignored as they aren't applicable to this function\n\n\n\n\nDocumentGUID\n\n\nImageNumber\n\n\n\n\nIn the above example the following fields come from the \ndsdba.ImagingSettings\n table\n\n\n\n\nInvoiceImageIdentifier\n\n\nDefaultImageSource\n\n\nDefaultURL\n\n\n\n\nReturn Value\n\n\nThe function should return xml table in the following format containing the list of available (unprocessed) images.\n\n\n<SearchResults>\n    <Row GUID='...' \n        SupplierReference='sup' \n        DocumentDate='2016-1-1' \n        DocumentImportRule = ''\n        EmailDate='2016-1-1'\n        FromAddress='david@proactis.com'\n        FromName='David Betteridge'\n        Subject='An Email'\n        ToAddress='david@proactis.com' />\n</SearchResults>\n\n\n\n\n\n\nOne row should be added for each unprocessed image\n\n\nAll the attributes listed above must be supplied\n\n\n\n\n\n\n\n\nUploading Images\n\n\n\n\n\n\nCreate a new C# Class Library project called xyzImaging. ( \nxyz\n can be anything)\n\n\n\n\n\n\nAdd a reference to \nPurchasing Server\\bin\\PROACTIS.P2P.grsImagingIface.dll\n\n\n\n\n\n\nAdd a public class called \nUpload\n which implements the __grsImageIface.IUpload interface.\n\n\n\n\n\n\nWrite an implementation of the following methods.\n\n\n\n\nStoreNewImage\n\n\n\n\n\n\n\n\n\n\nStoreNewImage\n\n\nStores an image uploaded by the user on the server\n\n\n\n\nSignature\n\n\nbool IUpload.StoreNewImage(string DetailsXML, byte[] FileContents)\n\n\n\n\nArguments\n\n\n\n\n\n\n\n\nArgument\n\n\nDirection\n\n\nDescription\n\n\n\n\n\n\n\n\n\n\nDetailsXML\n\n\nIn\n\n\nAn xml document containing the image metadata.\n\n\n\n\n\n\nFileContents\n\n\nIn\n\n\nContents of the image\n\n\n\n\n\n\n\n\nDetailsXML\n\n\n<?xml version=\"1.0\"?>\n<grs:ImagingSettings xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n    <grs:DocumentGUID>{7451C54A-52F0-4794-87FB-A6093AAD65AF}</grs:DocumentGUID>\n    <grs:ImageNumber>1</grs:ImageNumber>\n\n    <grs:SessionID>bd860b98-c82b-47fa-9522-a4f27f154cd6#dbserver2008r2\\qa#DavidB_94#en-gb</grs:SessionID>\n    <grs:DocumentType>I</grs:DocumentType>\n    <grs:CompanyGUID>{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}</grs:CompanyGUID>\n    <grs:Reference>heading.JPG</grs:Reference>\n    <grs:FileType>JPG</grs:FileType>\n\n    <grs:InvoiceImageIdentifier>DisplayNumber</grs:InvoiceImageIdentifier>\n    <grs:DefaultImageSource>URL</grs:DefaultImageSource>\n    <grs:DefaultURL>https://sp-db01/imaging/{{ImageID}}.bmp</grs:DefaultURL>\n</grs:ImagingSettings>\n\n\n\n\n\n\nThe DocumentGUID is a unique ID generated for this file\n\n\nImageNumber will always be 1\n\n\nReference is the name of the uploaded file\n\n\nDocumentType is I for Invoice and C for Credit Note\n\n\n\n\nIn the above example the following fields come from the \ndsdba.ImagingSettings\n table\n\n\n\n\nInvoiceImageIdentifier\n\n\nDefaultImageSource\n\n\nDefaultURL\n\n\n\n\nReturn Value\n\n\nReturn TRUE for success\n\n\n\n\nExample\n\n\nSee the \nexample application\n for a complete implementation.\n\n\n\n\nDeployment\n\n\nYou dll should be complied (and named xyzImaging.dll) and then copied into your \nPROACTIS P2P/Plugins\n  (or \nPlugins/[database-title]\n) folder.",
            "title": "Custom Imaging"
        },
        {
            "location": "/p2p/customimaging/#custom-imaging-dlls",
            "text": "",
            "title": "Custom Imaging DLLs"
        },
        {
            "location": "/p2p/customimaging/#overview",
            "text": "The PROACTIS P2P product has been designed so that it can be easily integrated with a number of different Document Management Systems (DMS).  A typical PROACTIS imaging solution requires the following integration points:-   The scanned image needs to be associated with an invoice within PROACTIS.  Users need to be able to see the original scanned image by clicking a link within the PROACTIS web site.   Although there are many different possible methods available (as different DMS and customers have different requirements) a generic imaging DLL has been written which meets the majority of customer\u2019s requirements.  For the cases where neither the built-in PROACTIS imaging solution or the Generic Imaging DLLs meet your requirements a completely custom DLL can be written.",
            "title": "Overview"
        },
        {
            "location": "/p2p/customimaging/#viewing-images",
            "text": "Create a new C# Class Library project called xyzImaging. (  xyz  can be anything)    Add a reference to  Purchasing Server\\bin\\PROACTIS.P2P.grsImagingIface.dll    Add a public class called  Imaging  which implements the  grsImageIface.IImaging  interface.    Write an implementation of the following methods.   GetImage  GetImageInfo  HasImage",
            "title": "Viewing Images"
        },
        {
            "location": "/p2p/customimaging/#hasimage",
            "text": "Controls if the View Image link is available when looking at a transaction within P2P  bool IImaging.HasImage(string DocumentDetailsXML)",
            "title": "HasImage"
        },
        {
            "location": "/p2p/customimaging/#arguments",
            "text": "Argument  Direction  Description      DocumentDetailsXML  In  An xml document containing the details of the document currently being displayed.",
            "title": "Arguments"
        },
        {
            "location": "/p2p/customimaging/#return-value",
            "text": "The function should return True if an image is available.",
            "title": "Return Value"
        },
        {
            "location": "/p2p/customimaging/#getimageinfo",
            "text": "Returns basic information (MimeType and NumberOfPages) for an image held against a document.  int IImaging.GetImageInfo(string DocumentDetailsXML, ref string MIMEType)",
            "title": "GetImageInfo"
        },
        {
            "location": "/p2p/customimaging/#arguments_1",
            "text": "Argument  Direction  Description      DocumentDetailsXML  In  An xml document containing the details of the document currently being displayed.    MIMEType  Out  Mime type of the document",
            "title": "Arguments"
        },
        {
            "location": "/p2p/customimaging/#mimetype",
            "text": "This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.",
            "title": "MIMEType"
        },
        {
            "location": "/p2p/customimaging/#return-value_1",
            "text": "The function should return the name of pages within the document.  Normally 1",
            "title": "Return Value"
        },
        {
            "location": "/p2p/customimaging/#getimage",
            "text": "Used to return either the bytes which make up the image of the URL for the image if it's in a DMS.  bool IImaging.GetImage(string DocumentDetailsXML, ref string MIMEType, ref byte[] Image, ref string URL)",
            "title": "GetImage"
        },
        {
            "location": "/p2p/customimaging/#arguments_2",
            "text": "Argument  Direction  Description      DocumentDetailsXML  In  An xml document containing the details of the document currently being displayed.    MIMEType  Out  The type of image    Image  Out  Byte[] containing the image    URL  Out  URL to the image",
            "title": "Arguments"
        },
        {
            "location": "/p2p/customimaging/#mimetype_1",
            "text": "This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.",
            "title": "MIMEType"
        },
        {
            "location": "/p2p/customimaging/#image",
            "text": "The image file as an array of bytes.  This will be steamed to the client's browser",
            "title": "Image"
        },
        {
            "location": "/p2p/customimaging/#url",
            "text": "The URL of image in a DMS.   Notes  Either the Image  or  URL argument should be used.",
            "title": "URL"
        },
        {
            "location": "/p2p/customimaging/#documentdetailsxml",
            "text": "The xml in the DocumentDetailsXML argument is made up from some context specific details based on the document being display and the settings you have defined in the imaging settings table.  <?xml version='1.0'?><grs:ImagingSettings xmlns:grs='http://www.getrealsystems.com/xml/xml-ns'>\n<grs:SessionID>eb89c444-0270-4f06-b8b6-ec0303b00117#dbserver2008r2\\qa#DavidB_94#en-gb</grs:SessionID>\n<grs:DocumentType>I</grs:DocumentType>\n<grs:DocumentGUID>{D79D1EE8-4B87-414B-8512-92590DFBE2E8}</grs:DocumentGUID>\n<grs:ImageNumber>0</grs:ImageNumber>\n<grs:CompanyGUID>{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}</grs:CompanyGUID>\n\n<grs:InvoiceImageIdentifier>DisplayNumber</grs:InvoiceImageIdentifier>\n<grs:DefaultImageSource>URL</grs:DefaultImageSource>\n<grs:DefaultURL>https://sp-db01/imaging/{{ImageID}}.bmp</grs:DefaultURL></grs:ImagingSettings>  The standard fields which are always supplied as:-   SessionID - in the format {uniqueID} # {database server} # {database name} # {user's language}  DocumentType - 'I' for Invoice,  'C' for Credit note',  'E' for Expense Claim and 'A' For Acceptance   DocumentGUID - GUID to identify the document being displayed  ImageNumber  CompanyGUID - GUID of the company in which the document belongs   In the above example the remaining fields (below) are from the  DSDBA.ImagingSettings  table.   InvoiceImageIdentifier  DefaultImageSource  DefaultURL",
            "title": "DocumentDetailsXML"
        },
        {
            "location": "/p2p/customimaging/#processing-images",
            "text": "Create a new C# Class Library project called xyzImaging. (  xyz  can be anything)    Add a reference to  Purchasing Server\\bin\\PROACTIS.P2P.grsImagingIface.dll    Add a public class called  Process  which implements the  P2P.grsImageIface.IProcess  interface.    Write an implementation of the following methods.   GetImage  GetImageInfo  GetListOfUnprocessedImages  HasUnprocessedImages  ProcessImage",
            "title": "Processing Images"
        },
        {
            "location": "/p2p/customimaging/#hasunprocessedimages",
            "text": "Controls if the \"Process An Image\" link is available from Invoicing home page.  bool IProcess.HasUnprocessedImages(string DetailsXML)",
            "title": "HasUnprocessedImages"
        },
        {
            "location": "/p2p/customimaging/#arguments_3",
            "text": "Argument  Direction  Description      DetailsXML  In  An xml document containing the details of the document type, database and company",
            "title": "Arguments"
        },
        {
            "location": "/p2p/customimaging/#return-value_2",
            "text": "The function should return True if one or more images are available for linking to invoices.",
            "title": "Return Value"
        },
        {
            "location": "/p2p/customimaging/#getlistofunprocessedimages",
            "text": "Returns an XML table showing the list of invoices available for linking  string IProcess.GetListOfUnprocessedImages(string DetailsXML)",
            "title": "GetListOfUnprocessedImages"
        },
        {
            "location": "/p2p/customimaging/#arguments_4",
            "text": "Argument  Direction  Description      DetailsXML  In  An xml document containing the details of the document type, database and company",
            "title": "Arguments"
        },
        {
            "location": "/p2p/customimaging/#return-value_3",
            "text": "The function should return XML in the following format  <?xml version='1.0'?>\n<grs:Images xmlns:grs='http://www.getrealsystems.com/xml/xml-ns'>\n    <grs:Image grs:Identifier='PINV123.xml'>\n        <grs:Fields>\n            <grs:Field grs:Name='Column1' grs:Value='Value in column 1' />\n            <grs:Field grs:Name='Column2' grs:Value='Value in column 2' />\n        </grs:Fields>\n    </grs:Image>\n</grs:Images>  The above table would generate the following table:    There should be 1 grs:Image per scanned image.  The grs:Identifier attribute uniquely identities the image  Each column required in the table should be added as a grs:Field element  grs:Name provides the caption for the column and grs:Value it's contents.",
            "title": "Return Value"
        },
        {
            "location": "/p2p/customimaging/#getimageinfo_1",
            "text": "Returns basic information (MimeType and NumberOfPages) for an image held against a document.  int IProcess.GetImageInfo(string DetailsXML, ref string MIMEType)",
            "title": "GetImageInfo"
        },
        {
            "location": "/p2p/customimaging/#arguments_5",
            "text": "Argument  Direction  Description      DetailsXML  In  An xml document containing the details of the document currently being displayed.    MIMEType  Out  Mime type of the document",
            "title": "Arguments"
        },
        {
            "location": "/p2p/customimaging/#mimetype_2",
            "text": "This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.",
            "title": "MIMEType"
        },
        {
            "location": "/p2p/customimaging/#return-value_4",
            "text": "The function should return the name of pages within the document.  Normally 1",
            "title": "Return Value"
        },
        {
            "location": "/p2p/customimaging/#getimage_1",
            "text": "Used to return either the bytes which make up the image of the URL for the image if it's in a DMS.  bool IProcess.GetImage(string DetailsXML, ref string MIMEType, ref byte[] Image, ref string URL)",
            "title": "GetImage"
        },
        {
            "location": "/p2p/customimaging/#arguments_6",
            "text": "Argument  Direction  Description      DetailsXML  In  An xml document containing the details of the document currently being displayed.    MIMEType  Out  The type of image    Image  Out  Byte[] containing the image    URL  Out  URL to the image",
            "title": "Arguments"
        },
        {
            "location": "/p2p/customimaging/#mimetype_3",
            "text": "This should be set to the MIME type of the image.    If image will be display via an URL to another system this must be set to text/url.",
            "title": "MIMEType"
        },
        {
            "location": "/p2p/customimaging/#image_1",
            "text": "The image file as an array of bytes.  This will be steamed to the client's browser",
            "title": "Image"
        },
        {
            "location": "/p2p/customimaging/#url_1",
            "text": "The URL of image in a DMS.   Notes  Either the Image  or  URL argument should be used.",
            "title": "URL"
        },
        {
            "location": "/p2p/customimaging/#processimage",
            "text": "Used to associate the image with a document.  bool IProcess.ProcessImage(string DetailsXML, string DocumentXML, ref string UserMessages)",
            "title": "ProcessImage"
        },
        {
            "location": "/p2p/customimaging/#arguments_7",
            "text": "Argument  Direction  Description      DetailsXML  In  An xml document containing the details of the document currently being displayed.    DocumentXML  In  The full P2P document which is being linked to the image    UserMessages  Out  Messages to feed back to the user",
            "title": "Arguments"
        },
        {
            "location": "/p2p/customimaging/#detailsxml",
            "text": "The DocumentGUID will contain the unique identifier for the selected image.",
            "title": "DetailsXML"
        },
        {
            "location": "/p2p/customimaging/#documentxml",
            "text": "The full internal XML for the document this image is being linked with.  The format varies depending on the type of document.   Warning  As the internal xml format us undocumented and subject to change it is recommended that you extract as little information as possible and program defensively.",
            "title": "DocumentXML"
        },
        {
            "location": "/p2p/customimaging/#usermessages",
            "text": "Allows user message to be returned to the PROACTIS website.  Not normally required.   Notes  This method is responsible for storing the link between the scanned image and the P2P document.  For example the unique ID might be written to the  ImageReference  column in the  dsdba.Invoices  table.",
            "title": "UserMessages"
        },
        {
            "location": "/p2p/customimaging/#detailsxml_1",
            "text": "The xml in the DetailsXML argument is made up from some context specific details based on the document being display and the settings you have defined in the imaging settings table.  <?xml version=\"1.0\"?>\n<grs:ImagingSettings xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n<grs:SessionID>789e432f-6515-435c-8748-d88665d57119#dbserver2008r2\\qa#DavidB_94#en-gb</grs:SessionID>\n<grs:DocumentType>C</grs:DocumentType>\n<grs:DocumentGUID></grs:DocumentGUID>\n<grs:ImageNumber>0</grs:ImageNumber>\n<grs:CompanyGUID>{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}</grs:CompanyGUID>\n\n<grs:InvoiceImageIdentifier>DisplayNumber</grs:InvoiceImageIdentifier>\n<grs:DefaultImageSource>URL</grs:DefaultImageSource>\n<grs:DefaultURL>https://sp-db01/imaging/{{ImageID}}.bmp</grs:DefaultURL>\n</grs:ImagingSettings>  The standard fields which are always supplied as:-   SessionID - in the format {uniqueID} # {database server} # {database name} # {user's language}  DocumentType - 'I' for Invoice,  'C' for Credit note',  'E' for Expense Claim and 'A' For Acceptance   DocumentGUID - GUID to identify the document being displayed  ImageNumber  CompanyGUID - GUID of the company in which the document belongs   In the above example the remaining fields (below) are from the  DSDBA.ImagingSettings  table.   InvoiceImageIdentifier  DefaultImageSource  DefaultURL",
            "title": "DetailsXML"
        },
        {
            "location": "/p2p/customimaging/#searching-for-unprocessed-images",
            "text": "Create a new C# Class Library project called xyzImaging. (  xyz  can be anything)    Add a reference to  Purchasing Server\\bin\\PROACTIS.P2P.grsImagingIface.dll    Add a public class called  Search  which implements the  grsImageIface.ISearch  interface.    Write an implementation of the following methods.   SearchForUnprocessedImages",
            "title": "Searching for unprocessed images"
        },
        {
            "location": "/p2p/customimaging/#searchforunprocessedimages",
            "text": "Returns a list of unprocessed images based on the search criteria entered by the user.",
            "title": "SearchForUnprocessedImages"
        },
        {
            "location": "/p2p/customimaging/#signature",
            "text": "string ISearch.SearchForUnprocessedImages(string DetailsXML)",
            "title": "Signature"
        },
        {
            "location": "/p2p/customimaging/#arguments_8",
            "text": "Argument  Direction  Description      DetailsXML  In  An xml document containing the search criteria .",
            "title": "Arguments"
        },
        {
            "location": "/p2p/customimaging/#detailsxml_2",
            "text": "<?xml version=\"1.0\"?>\n<grs:ImagingSettings xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n    <grs:SessionID>fd2ae334-dd29-42d3-9706-ea4883b7bedc#dbserver2008r2\\qa#DavidB_94#en-gb</grs:SessionID>\n    <grs:DocumentType>I</grs:DocumentType>\n    <grs:DocumentGUID></grs:DocumentGUID>\n    <grs:ImageNumber>0</grs:ImageNumber>\n    <grs:CompanyGUID>{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}</grs:CompanyGUID>\n    <grs:MaxReturnRows>100</grs:MaxReturnRows>\n    <grs:PrimarySortColumn>DocumentDate</grs:PrimarySortColumn>\n    <grs:PrimarySortAscending>False</grs:PrimarySortAscending>\n    <grs:SupplierReference></grs:SupplierReference>\n    <grs:DateFrom></grs:DateFrom>\n    <grs:DateTo></grs:DateTo>\n    <grs:FromAddress></grs:FromAddress>\n    <grs:ToAddress></grs:ToAddress>\n    <grs:Subject></grs:Subject>\n    <grs:RuleName></grs:RuleName>\n    <grs:DateEmailedFrom></grs:DateEmailedFrom>\n    <grs:DateEmailedTo></grs:DateEmailedTo>\n\n    <grs:DefaultImageSource>URL</grs:DefaultImageSource>\n    <grs:DefaultURL>https://sp-db01/imaging/{{ImageID}}.bmp</grs:DefaultURL>\n</grs:ImagingSettings>  The following fields can be ignored as they aren't applicable to this function   DocumentGUID  ImageNumber   In the above example the following fields come from the  dsdba.ImagingSettings  table   InvoiceImageIdentifier  DefaultImageSource  DefaultURL",
            "title": "DetailsXML"
        },
        {
            "location": "/p2p/customimaging/#return-value_5",
            "text": "The function should return xml table in the following format containing the list of available (unprocessed) images.  <SearchResults>\n    <Row GUID='...' \n        SupplierReference='sup' \n        DocumentDate='2016-1-1' \n        DocumentImportRule = ''\n        EmailDate='2016-1-1'\n        FromAddress='david@proactis.com'\n        FromName='David Betteridge'\n        Subject='An Email'\n        ToAddress='david@proactis.com' />\n</SearchResults>   One row should be added for each unprocessed image  All the attributes listed above must be supplied",
            "title": "Return Value"
        },
        {
            "location": "/p2p/customimaging/#uploading-images",
            "text": "Create a new C# Class Library project called xyzImaging. (  xyz  can be anything)    Add a reference to  Purchasing Server\\bin\\PROACTIS.P2P.grsImagingIface.dll    Add a public class called  Upload  which implements the __grsImageIface.IUpload interface.    Write an implementation of the following methods.   StoreNewImage",
            "title": "Uploading Images"
        },
        {
            "location": "/p2p/customimaging/#storenewimage",
            "text": "Stores an image uploaded by the user on the server",
            "title": "StoreNewImage"
        },
        {
            "location": "/p2p/customimaging/#signature_1",
            "text": "bool IUpload.StoreNewImage(string DetailsXML, byte[] FileContents)",
            "title": "Signature"
        },
        {
            "location": "/p2p/customimaging/#arguments_9",
            "text": "Argument  Direction  Description      DetailsXML  In  An xml document containing the image metadata.    FileContents  In  Contents of the image",
            "title": "Arguments"
        },
        {
            "location": "/p2p/customimaging/#detailsxml_3",
            "text": "<?xml version=\"1.0\"?>\n<grs:ImagingSettings xmlns:grs=\"http://www.getrealsystems.com/xml/xml-ns\">\n    <grs:DocumentGUID>{7451C54A-52F0-4794-87FB-A6093AAD65AF}</grs:DocumentGUID>\n    <grs:ImageNumber>1</grs:ImageNumber>\n\n    <grs:SessionID>bd860b98-c82b-47fa-9522-a4f27f154cd6#dbserver2008r2\\qa#DavidB_94#en-gb</grs:SessionID>\n    <grs:DocumentType>I</grs:DocumentType>\n    <grs:CompanyGUID>{A2FEEDC5-978F-11D5-8C5E-0001021ABF9B}</grs:CompanyGUID>\n    <grs:Reference>heading.JPG</grs:Reference>\n    <grs:FileType>JPG</grs:FileType>\n\n    <grs:InvoiceImageIdentifier>DisplayNumber</grs:InvoiceImageIdentifier>\n    <grs:DefaultImageSource>URL</grs:DefaultImageSource>\n    <grs:DefaultURL>https://sp-db01/imaging/{{ImageID}}.bmp</grs:DefaultURL>\n</grs:ImagingSettings>   The DocumentGUID is a unique ID generated for this file  ImageNumber will always be 1  Reference is the name of the uploaded file  DocumentType is I for Invoice and C for Credit Note   In the above example the following fields come from the  dsdba.ImagingSettings  table   InvoiceImageIdentifier  DefaultImageSource  DefaultURL",
            "title": "DetailsXML"
        },
        {
            "location": "/p2p/customimaging/#return-value_6",
            "text": "Return TRUE for success",
            "title": "Return Value"
        },
        {
            "location": "/p2p/customimaging/#example",
            "text": "See the  example application  for a complete implementation.",
            "title": "Example"
        },
        {
            "location": "/p2p/customimaging/#deployment",
            "text": "You dll should be complied (and named xyzImaging.dll) and then copied into your  PROACTIS P2P/Plugins   (or  Plugins/[database-title] ) folder.",
            "title": "Deployment"
        },
        {
            "location": "/placeholder/",
            "text": "Please contact your account manager for information on integrating with this product.",
            "title": "Spend Analytics"
        },
        {
            "location": "/placeholder/",
            "text": "Please contact your account manager for information on integrating with this product.",
            "title": "APF"
        },
        {
            "location": "/placeholder/",
            "text": "Please contact your account manager for information on integrating with this product.",
            "title": "S2C"
        },
        {
            "location": "/placeholder/",
            "text": "Please contact your account manager for information on integrating with this product.",
            "title": "DueNorth"
        },
        {
            "location": "/placeholder/",
            "text": "Please contact your account manager for information on integrating with this product.",
            "title": "System4"
        }
    ]
}